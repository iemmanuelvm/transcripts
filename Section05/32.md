In the previous several videos I've discussed, non stationary signal, non stationary is what they

mean, how they manifest and I showed you that signal non stationary.

These can make the results of the Fourier transform difficult to interpret visually.

So one of the solutions for dealing with signal non stationary, these is something called Welches method.

This helps with non stationary and also gives a smoother result.

So the results of the 48 transform will be a bit smoother and therefore easier to interpret with Welches

method.

This is named after the mathematician Welch, and I believe this method was first published in the 1950s.

So it's actually a pretty straightforward concept, as you will see in the next slide.

And then I'll also discuss some of the parameters that you can pick.

And I will talk about the difference between what I'll call here the full FFE and the Welches method.

OK, so what is the full F.T..

Well, that's basically just doing one Fourier transform over the entire duration of the signal.

So, for example, here we have our time domain signal and we do one FFE one Fourier transform on the

entire signal and that gives us a power spectrum that might look like this so totally fine.

There's nothing wrong with this procedure.

I'm calling this the full FFE method, but you can see there are a lot of non-state personalities and

temporal dynamics in this time domain signal.

So for example, here you see when you look at the power spectrum, you see very clearly that there

is a peak at this frequency range.

And, you know, I don't have the labels in here, but this is somewhere around 40 to 50 hertz.

So you see that there is a peak in the gamma frequency range here.

However, just from looking at this Fourier transform result, you have no idea where this signal appears,

where this feature of the data appears in time.

Is there a continuous gamma oscillation in the signal or are there occasional bursts in the time domain

or is it all concentrated in one time period, which is actually the case now?

Of course, you can see that in the time domain signal, but the point is you don't know about the temporal

dynamics and the non stationary is just from looking at this frequency domain signal.

OK, so this is what I will call the full F.T. Method.

And now let's talk about Welches method.

So the idea of Welches method is that instead of doing the four transform on the entire time window,

you just isolate a little piece of the data.

So let's say you take this much data, maybe this is, I don't know, two hundred milliseconds.

This is one of the parameters of the of Welches method.

Do you have to decide how wide to make this time window here?

So you take these data, you kind of cut out this snippet, you isolate this snippet, ignore the rest

of this time series.

So that looks like this.

You also have to taper these data.

I will talk about tapering in a few slides, but essentially it's like pinching the ends of the signal

so that the beginning and the end are going to zero.

And then with this little snippet, we take the 48 transform and we compute the power spectrum and that

looks like this.

So this is the power spectrum, not of the entire signal, but just of this little snippet, this little

piece of the signal.

OK, and then what we do, you've probably already guessed we take another little snippet of the signal.

So you can see in this case, the window is the same size.

So if this is two hundred milliseconds and this is also, let's say, 200 milliseconds, and here's

another parameter of Welches method, which is whether and how much to overlap these two windows.

So what you see is now I'm overlapping by 50 percent.

So 50 percent of the so the second window starts at 50 percent of the way through the first time window.

OK, so then we take out this little snippet of data here.

Again, apply a taper, which means, you know, sort of pinching off the start, starting the endpoints

and then take the Fourier transform of this snippet.

So now we see that the power spectrum here looks a little bit different from how it looked here and

so on and so on and so on.

And then here I'm just drawing another snippet over here and then it's power spectrum.

Look, something like this.

And then what do we do?

You guessed it.

We average all of these power spectra together.

So notice that we are still ending up with the spectral character.

Six of the entire signal, however, we are putting that spectrum together one piece at a time here

you see a comparison of Welch's method and the full F.T..

So, again, this cyan line here, this greenish line, this is the power spectrum resulting from one

Fourier transform over the entire signal that looks like this.

And then what you see in blue here is the result of Welch's method.

And you can see that they're overall quite similar.

Welch's method is much smoother.

It gives a much smoother spectrum and that is generally the result of Welch's method.

It's going to smooth out the power spectrum quite a bit.

Now, I'm going to talk briefly about tapering.

So here in blue, in dark blue is the original signal.

This is the data snip.

So this would be, you know, 200 milliseconds or whatever from the longer time series.

And then here in Si√¢n, we have a taper.

This particular one is called a taper.

You can see it looks a little bit like a Gaussian.

It's fairly close to a Gaussian.

In fact, it's defined as a cosine wave.

So it's half of a cosine wave.

There's a bunch of different tapers.

There's Hohn and Heming and Cayzer and RES Cosine and Gaussian.

And I'm sure I'm missing another couple more.

But anyway, all of these tapers generally look quite similar.

And then what you do is taper the signal and you end up with this orange signal so you can see that

it's pinching off towards zero at the beginning and at the end, and it is full amplitude in the middle.

Now, the reason for the taper is that you have edges here and edges here.

So these edges are going to cause artifacts in the foyer transform.

These are edge effects, essentially.

These are strong nonstate personalities that take a lot of energy and a lot of frequencies for the 48

transform to represent.

So we taper the data to minimize the amount of EDG effects contaminating the power spectrum.

Now, you can also see that we are getting rid of a lot of valid data.

So there's nothing wrong with the data here in the blue signal.

And yet we are tapering this down.

So we are attenuating valid signal.

That is one of the motivations for having these windows overlap.

So this part of the signal here is attenuated by the taper in this window.

But in this window, we actually get this tapered piece to be at full amplitude.

So that's why having some overlap is generally a good idea.

OK, so now I've introduced you to Welches method and you already know about the full FFE method.

And now I'm just going to talk a little bit about comparing the these two methods.

So the full FFE method is a bit sensitive to noise and it's more sensitive to non-state personalities

and Welches method smoothed over non systematic noise and it's robust to some kinds of non stationary.

So why is this the case?

Let me go back to this slide.

Now, imagine we have imagined this was like an artifact here.

There was an edge.

There's some spike in the data in the full FFE.

This is getting into the FFE.

But when using Welches method, this artifact here, I mean, I don't think this is an actual artifact,

but let's imagine there was a little noise spike in the data here.

Then this little artifact is actually only going to affect, you know, two or three of these little

data snippets out of a total of, you know, let's say there's 30 data snippets in total and only two

of them are affected by this noise spike.

So now this noise spike gets averaged out.

It's getting smoothed out.

On the other hand, the full FFE method has maximal spectral precision and the Welches method has reduced

as lower spectral precision, lower frequency precision.

Why is that the case?

Right.

That's the case because remember that the frequency resolution in the 48 transform is determined entirely

by the number of time points.

Well, for a fixed sampling rate, the frequency resolution is determined by the number of time points

in the signal.

And so for the full FFE, we have as many points as possible.

We have lots and lots of data points.

And with Welches method, we are taking only small snippets of the data and so therefore the number

of time points is reduced even though the sampling rate is the same.

So the spectral resolution is actually much lower.

Now, whether that's really a bad thing or a neutral thing depends on the frequencies at which the dynamics

in your signal are happening.

But you know, something to keep in mind and a disadvantage of both of these methods is that they still

do not allow us to visualize the temporal dynamics in the signal.

Now, you can probably already guess what would be the way to adapt Welches method to uncovering or

preserving the temporal dynamics.

And that would be instead of averaging all the spectra together, you look at each spectra separately

and you plot them, you know, along the X axis to preserve the changes in dynamics over time.

Now, technically, that is not Welches method.

That's called a spectrogram or the short time for a transform.

I'm going to talk more about that in the next section on time frequency analysis so you can already

guess where we are going to be going with this.

But formerly Welches method still results in one spectrum that looks like this.

It is a smoothed version of the full F.T. Spectrum.

