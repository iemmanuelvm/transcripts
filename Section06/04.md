 In this video, you're going to get to see some stationary and non stationary signals and you'll see the Fourier transform of those different kinds of signals. This is a great introduction to spectral analysis for non stationary time series. And it's really going to set us up for Segway into the next section of this course on time frequency analysis. So let's dive right in here. I specify a sampling rate of 1000 hertz or kilohertz. Four thousand time points and the time vector T is just going to go from zero to NP minus one divided by the sampling rate, which means basically zero to four seconds. Then here I create my two signals. This is a linear chirp signal. One is the linear chirp. Now I have presented to you previously in this course a slightly different formula for creating arbitrary, instantaneous frequency signals. This formula, it turns out, is actually just a simplification of that more complicated formula. So this is a simplification because it works only for a linear chirp in between two frequencies. So to use this formula, you specify two frequencies the frequency of the sine wave at the beginning of the Times series and the frequency at the end of the Time series. And then the frequency vector is linearly spaced numbers from the first element to the average of the two. It seems a little weird, but that's just how the formula shakes out to be. And then you put that vector of frequencies inside the sine function. So it's nine to five times, 10 times this frequencies vector and this one is a stationary signal. OK, and then I take the foyer transforms, I use the FFE function to get the foyer spectrum of signal one and signal two here I generate the vector of frequencies so we go from zero to the nyqvist frequencies or half the sampling rate in and over to this actually should be an over two plus one steps. Once we get the complex four coefficients, we can extract their magnitudes using the ABS function for absolute value and then to accurately, fully, accurately reconstruct the amplitude of the signal we need to normalization factors. One is dividing the four year coefficients by N, which I do up here, and a second one is multiplying the positive frequencies by two, not including so excluding the DC and the Nykvist frequency. That's why I specify that the amplitude should go from two to and minus one and minus one ends up being the Nyquist frequency. If you're confused about why I'm applying these to normalization factors, I explain this in more detail in my course on the four year transform. But the details don't actually matter. The important point is that we are going to get a shape and amplitude spectrum and here in this course, we are really only interpreting the shape of the amplitude spectrum, not the actual values. So that's the important thing. OK, and then here is some plotting. So let's run this cell, see what it looks like. So here you see two lines, a blue line and a red line. The blue line was signal one. That's the non stationary signal. So this linear chirp and the red line is a stationary signal. Here you see the amplitude spectra of these two signals. So, not surprisingly, we generated a pure sine wave at six hertz and now we see that the amplitude spectrum is all zeros everywhere except for exactly six hertz. And the non stationary signal has a kind of a plateau's like a rising plateau shape. And you can see that it goes from two hertz up to 10 hertz with a little bit of further decay on either side due to the non stationary. So here's the thing about the full spectrum or spectral analysis of non stationary signals. That's the result of the four you transform. Is one hundred percent valid. There's nothing wrong with this, but it's difficult to interpret the amplitude spectrum of the non stationary time series. In other words, if I just showed you this amplitude spectrum, the blue amplitude spectrum, you wouldn't be able to conceptualize what the signal looks like in the time domain. Whereas if I showed you this red spectrum, you would know exactly what the signal looks like in the time domain. Maybe you wouldn't know the exact phase because the phase isn't shown here, but you would know what the signal looks like. OK, so it turns out you can even get non-state personalities in here just by having a non integer number of cycles contained in a discrete window of time. So this is a perfect spike here because it's six hertz with a thousand kilohertz and four thousand samples. So six hertz fits in really well. However, if I would change this to, let's say, I don't know, three, seven, four or six, how about that? So now there is not an integer number of frequency cycles at this frequency that fit into three thousand seven hundred and forty six time points. And you can see that this the red line here, the red curve doesn't go all the way down to zero. So that means that although this is a pure sine wave at one frequency because of this little non stationary, that it doesn't go all the way down to zero. It doesn't make a complete cycle. We need a lot of energy at extra frequencies, additional non six hertz frequencies in order to reconstruct this edge here. And that is reflected in this plot. So you can see it definitely has a peak at six hertz. Actually, it's not even exactly six hertz because we don't happen to get exactly six hertz with this many points in this sampling rate. But there is a peak at six hertz, but there's also a lot of energy at surrounding frequencies. So that's already interesting to know. And this is sometimes a bit surprising for people who have learned about the Fourier transform only from, you know, let's say a more theoretical approach and a mathematics or physics course. OK, now let's go on to the amplitude non stationary. So what I'm going to do here is generate two signals. Again, one is going to be a pure sine wave that doesn't need to be mean. And that's just one number here. One so. Signal two is again, a pure sine wave and signal one is a pure sine wave that's amplitude modulated by this vector here amp mud. And you can see this is linearly interpolated numbers between zero and one. So there's 10 numbers, but they range between zero and one. And here I scale them up to be between zero and two. And this third optional input for Interop one defines the shape of the interpolation. So let me run this just to give you a sense of what that's going to look like so I can say plot and mode, so you can see that it's smooth this time series now smoothly going over time. If I were to, let's see, get rid of this chip thing and then the default parameter is linear. So this is what linear interpolation is. It's one, two, three for these discrete points and then a straight line that goes between them. OK, so that amplitude modulator gets multiplied by a otherwise pure sine wave. And then the rest of this code is basically the same as in the previous cell. So run this. And here you see for the stationary signal, of course, it's just a line again, one impulse in the frequency domain. And now the blue line up here, the non stationary time series, you can see that the frequency never changes. So it's frequency stationary, but the amplitude is going up and down and that requires that amplitude. Non stationary requires energy at neighboring frequency. So in that sense, it's a little bit like this example here. So this is really important to understand that amplitude, non stationary or any kind of non stationary. But even if the frequency is exactly the same, but there are amplitude non stationary D you need to apply a relatively wide filter in order to capture these non stationary. And that's important because usually in neuroscience or other time series data, particularly in biology, these stationary features of the signal might not be the most interesting aspects of the signal. The most interesting and important features of the signal might be these non stationary. So if you would apply a really, really narrowband filter, you might actually be removing the very features of the signal that are most important. OK, so I want to show you a little bit more about how this works with these neighboring frequencies. These are sometimes called the side lobes, these this blue energy at these neighboring frequencies, the side lobes. So let me try and run this. Oh, yeah. This is a good example. So here you see, it doesn't look very random. It looks like there's a peak here in here on both sides. It looks a bit symmetric. Now, if we were to count these non stationary things here so you can see that it's kind of the beat pattern, it almost looks like there is a sine wave modulation on the amplitude that's really just random. It just happened to come out that way in this simulation. But if we were to count these, you would see that there's one, two, three and maybe into four. So let's say around three of these cycles over four seconds, which is a little bit less than one hertz. And if you look at this peak here, that is around five point something actually that I can see exactly what it is, data cursor mode. So this peak here is around five point two and over here it's going to be seven point thirty six point seven. So basically, these peaks are a little bit under one hertz away from the center frequency. And that is the the rhythm of this beat pattern in here. So in the engineering world, they might call this a carrier wave and this would be the modulator frequencies. I can make this even more explicit. So I'm going to change this amp mod variable. Instead of letting it be random. I'm going to specify that it should be a sine wave. So it's the two PI times T and now the time. Let's just leave this at one for now. So this is going to have negative and positive values, but I want to change this so that it ranges from zero to one. So I'm going to say one plus this sine wave. So now that gives me values that range from one to two, right? Because the original sine wave varies from zero sorry, minus one to plus one. So I add one and now it goes from zero to two. And then I'm going to divide all of this by two. So now you see the non stationary eddies have a beat pattern of exactly one hertz and the side load energy is exactly one hertz. Now, maybe you think that this is just chance or I'm fooling you somehow. So let me try changing this a little bit. I'll say times two. So now it's going to be a. Two hertz modulation of this six hertz sine wave, and then you see that the side lobes here have energy exclusively at two hertz around the center frequency. So the big Take-Home message from this video is that non stationary signals have relatively broader frequency spectra, although you can generally always find the or identify the peak in the power spectrum. On a practical note, this means that if you were interested in the non stationary me, get rid of this and go back to this. If you are interested in the non stationary of a signal, it's generally not a good idea to apply a really narrow band filter to the signal because then you are going to be removing all of the silo's, which is where all the non stationary cities are represented.