Sometimes just looking at a power spectrum is enough because maybe you just want to do a qualitative

inspection of the patterns of the data.

However, very often you need to quantify some features of the power spectrum and in particular, you

are often going to be interested in knowing exactly how much power is contained within some frequency

range.

So that's the goal of this video.

I'll show you how to extract average power from a frequency band.

So most of the code here is the same as the code in the previous video that was on F.T. and Welches

method on egressing state data.

The main difference up to here is that in that video I just called P Welch on its own like this, and

it automatically produced a platform that I produced a plot for me.

I didn't have to do any plotting myself.

However, it turns out if you request some outputs from the Welch function, then Matlab will not produce

a plot and instead is going to give you the data that it used to create the plot.

So here I am running these lines here and you can see there are no figures that didn't actually create

a plot.

Instead, I got out the power spectrum and the vector of frequencies.

And now I'm going to do the plotting myself.

So there you see the pop and whenever you are looking at power spectra of electrophysiology data, there

are generally three features that you want to look for, three prominent features.

One is this one of rough shape and that you see it's pretty steep here.

But probably that's because it's a linear scale, if I would change this to be a logarithmic scale,

so I'm going to say set get current axis y scale and then make this logarithmic.

So there you see the one of rough shape a little bit more prominently.

You can also see that this is not exactly one of RAF's.

So, you know, people call this one over Heff.

But this is really just a colloquial term.

It's not actually one of four, if I can show you what one of over F what real one of RAF's looks like.

So let's say plot one divided by Hertz.

So you hardly see that here.

In fact, maybe I'll make it so I said this to be black and make it a thicker line.

So here it just looks like this.

Now, if I would change the Y-axis going to be logarithmic, then you'd see a little bit better.

That kind of curves down like this.

But this curb, this is a true one over afunction and this is not following that exact same pattern.

So this is not a mathematically described one over F.

In the sense that if you try to fit a one over F to the C function, you're not going to get a perfect

fit.

Anyway, that's a separate issue.

The point is, there are three prominent features that you see in power times, power spectra, and

that's the one over F.

And then you want to look for specific peaks that deviate from the one over like this in the alphabet.

And then you would often find some peak at 50 or 60 hertz, depending on where you're recording your

data from.

OK, so I'm going to go back to this linear plot here.

I think this looks a little bit nicer.

It makes this alpha region a little bit more visible.

Also, you can see that this line noise artifact is not exactly at 50 hertz, there's some spread around

it.

And that's really from the smoothing that's introduced from windowing.

OK, so we can look at this qualitatively, but now let's say we want to quantify this, we want to

know exactly how much power there is in this alpha region.

So that's what I do down here.

It's not super difficult to do.

You specify the frequency boundaries in Hertz here.

I convert those frequency boundaries from Hertz into indices so that that ends up being.

Eight 01 and 12 one, so actually that's not so surprising, given the amount of upsampling zero padding

by one hundred times, so then extracting power in that range is pretty straightforward.

We just take the power spectrum from the first frequency boundary to the second frequency boundary and

then average over those.

And that gives us our average power.

So two point two, and that's the average power in this region here and here.

I'm just going to add a patch.

So that's going to color in the region that I'm quantifying, that I'm interested in, and this is the

sort of thing that you would do if you want to, let's say, make a topographical map of our power over

all the different channels or compare alpha power between different frequencies or different experimental

conditions or maybe different patient groups, for example.