 OK, so here are my solutions to this project, so let's see, this stuff is mostly straightforward. This is code we've used before and not that I'm creating a separate field inside the structure. And that's going to allow me to separate the voltage data for analysis and data. Otherwise, if you would have written something like this, EEG data equals the question of EEG data, then you're basically overwriting the data and there's really no way to create this figure unless you would comment this out. And then that's a terrible idea anyway. So, OK, so let's see. Yes, you leave this as a separate field inside this structure. All right. So most of this is pretty straightforward. Here was the little trick. It might be easier than you think it is. You basically just divide the the number of cycles by the frequency. And this is valid, assuming that you are working in Hertz and this should also make sense as well. So we have the minimum frequency is two hertz. And so at two hertz, one cycle, one full cycle of two hours is half a second. So therefore two full cycles would correspond to one second. So good quick sanity check that that's the right thing to do. All right, then we got the wavelet parameters. This is all nothing new here. The only thing I will remind you is that it's really important when creating the time vector for the wavelet that this time vector needs to be symmetric. So it needs to start and end equally far away from zero. So I accomplish that here by saying minus two to plus two. You could also do it minus three to plus three. The wrong way to do this would be to say minus two to plus three. The problem here is that you're going to get a phase offset. It's basically going to take this entire window and shift it so the timing will be wrong. So needless to say, that's something to be avoided. All right. This part is straightforward. You just have to remember this trick about reshaping the time by trials matrix into a single vector. And then making sure the end of the FBI is accurate, of course, and then later on we reshape that back into a 2D matrix. OK, then. Here is creating the wavelet and the answer here to the question of whether you need to normalize the wavelet in the frequency domain, the answer is no. And the reason for that is that in this project, in this code, we are not caring about amplitude. We don't care about power. All we care about are the phases and the phase of a vector. The phase of a line in a complex plane is exactly the same, regardless of how long the line is, you know, assuming the line is non-zero. So, in fact, if you wanted, you could even scale this wavelet up by some really large number. That's not going to change anything. If you are working with power, if you're working with fasani, if you're working with amplitude, then this will have a kind of bizarre effect. All right. Then we get to the convolution. This part is pretty straightforward. And you have to keep in mind that you want to get the oilrigs phase angle differences. The main potential point of confusion here, the main potential source of errors is to forget about this parenthesis here, which means that the AI, the imaginary operator, is actually only multiplying this. So if you write the code like this, in fact, what you're doing is telling Matlab to prioritize or I should say group the imaginary operator with the angles of the of Channel One and not with Channel two. So needless to say, that's also incorrect. So as long as you get the parentheses right, basically this is pretty straightforward. Let's see. So this is just a repeat of everything. If you're copying and pasting the code, you need to make sure that you're being really careful to change the variable names here. That's also a pretty common mistake. And let's see the connectivity, this is straightforward. So I encouraged you in the previous video to come up with these lines of code on your own just based on your understanding of how these analyses work. But of course, it's also fine if you just copied and pasted from previous videos again, and you just have to be careful that you are using the correct variable names. All right. And then the plotting, I think, is also pretty straightforward. And there isn't a whole lot that you could have gotten wrong here. I hope maybe you made some weird mistakes, but I think finishing this line was pretty straightforward. So that's it. I hope you found this project to be interesting and fun to work on and also instructive about the two different families of approaches for dealing with the potential conflict of volume, connection in connectivity, Niles's. And again, the two different methods are to use particular analyses that are robust to volume connection or use some kind of spatial filter or pre processing method that will sharply attenuate volume connection. Both of those families of approaches you see here in this plot. And here you basically see the inflation of apparent connectivity when you don't apply either one of these two approaches to dealing with connectivity in the presence of volume connection.