 In the previous video, I showed you face synchronization in two signals that had real genuine phase synchronization in the sense that the signals were dominated by sine waves of exactly the same frequency and no fluctuations in phase. And then I added a bit of noise just to make things a little more interesting. But there was genuine synchronization to measure. Now, in this video, I'm going to show you an example of spurious connectivity and noise. So basically, I'm just going to generate pure noise. It's going to be narrowband noise and I'll compute phase synchronization between them. And you will actually see how you can get something that kind of looks like synchronization between pure noise signals. So looking down here, we can see how the signals are generated, this is actually the same code that I used in the previous video to generate narrowband noise. So I just take some random numbers and then I apply a filter to them. And that filter is from the FIA one algorithm. And essentially, that's just creating a narrowband filter between 10 and 15 hertz in this video and also in the previous video, I don't explicitly investigate the filter kernel itself, but as I've shown in previous videos, in previous sections of this course, it's also always a good idea to inspect the filter kernel. The first time you're using it. In particular, you want to look at the filter kernel in the time domain and you want to look at the filter kernel, the power spectrum of the filter kernel. So it's gain function in the frequency domain. Anyway, I want to start by plotting these two signals here. Now, on the face of it, they look actually a little bit similar to the signals from the previous video, and that's really just because of the Narrabeen filtering of noise. Now, what I'm going to do is extract the phase angle time series. This is also just like I did in the previous video. Now turning zoom on. We can investigate this a bit and you can actually find time windows where there happens to be apparent synchronization between these two channels so that you see here, here, it looks like the synchronization breaks down and then here is some more synchronization. And here again, it looks like the synchronization breaks down. Now, any apparent synchronization here is literally just seeing patterns in noise. So now what I'm going to do is instead of computing one synchronization value over this entire ten second window of data, I'm going to create a sliding time series of synchronization using three hundred time points. Now, in this case, because the sampling rate is a thousand hertz, it happens to be that 300 time points is also 300 milliseconds. So imagine taking a window that would go, for example, from point four seconds to point seven seconds. So we would compute synchronization in this window here. And actually, just from eyeballing this, you can see that the synchronization in this window is going to be very high. It's going to be pretty close to one, actually. In contrast, a window here that would go, let's say, from point seven to one. I think that synchronization value is going to be fairly low. OK, so what I do here is initialize a time series of synchronization time points and then I'm going to loop over time. And at each time point I'm going to compute the average phase synchronization or I should say the magnitude of phase synchronization from this time window. So you can see here's the angles from zero one angles from signal two, I subtract them and then that quantity. So putting in parentheses here to group these together, that gets multiplied by the imaginary operator that goes into the exponential four Euler's formula. And then we take the average of all those factors and the magnitude of the average, the length of the average vector. Now there's something a little bit interesting about the way I defined this t idex vector. So this time vector. And essentially what you should first see in this line is this. So ignore this Maximon business for a moment. First, you should see that the time vector t idex goes from T if time points, that's the looping index. So from T minus one size to tie plus one size. That's the basic goal that we're getting at with this time index. However, it can happen. Imagine what happens at the very first iteration. So T equals one and then T minus one size is going to be a negative number and define this yet. So that's going to be a negative number, minus two hundred ninety nine. And then essentially what I'm saying here is give me the minus two hundred and ninety ninth element in this vector here, which of course does not exist. So therefore I say the maximum of one or whatever this happens to be. So in this iteration, in the first iteration that's minus two hundred and ninety nine. So that gives us a value of one. Now that does mean that the time index of the number of time points for computing synchronization actually changes over time and it's going to be smaller at the beginning and at the end of the Time series. But, you know, you always have edge effects. Any time you were working with analyses or time series data, there's almost always something weird happening at the edges. All right. I'm sure you are super excited to see the results. So now I'm going to run all the code in this cell that's going to generate another plot that shows me the time course of synchronization. And here you see that, so sometimes it's low, the reset to original. So now the time is consistent for all of these reports. So sometimes the synchronization is low and this is basically what you would expect. You would expect to see very, very little synchronization between two noise signals. And yet there are time points where the synchronization is really high, you know, this synchronization is getting even you know, it's maybe around point nine or point eight, five or so. And there's another interesting thing happening here, which is that it looks like there's some rhythmicity, you know, it looks like the synchronization is kind of bubbling in and out and that almost looks rhythmic. And so to show you this, I'm going to actually plot the power spectrum of this. And we might expect to see something that looks like a peak at around, you know, maybe one hertz or a little bit less than one hertz. So I'm going to say plot. ABSs fits the magnitude of Fourier transform of sync tests. OK, so what you see here is not a whole lot because there's a lot of empty space in here. So I'm going to adjust the x axis limits to go from zero to, let's say, 100. Now, this is not 100 hertz. This is 100 indices. So to make this a little bit more interpretable, I'm going to create a frequency vector. So the frequencies are linearly spaced. They go from zero. Now, the thing is, these technically go to the Nyquist frequency, of course, but that gives us only half the time points. And then that's going to crash because here with the results of the FFE function, we actually get both the positive and the negative frequencies. So I'm going to do a little trick that I do. Sometimes I'm going to pretend that the frequencies go from zero up to the sampling rate in the number of points corresponding to the total number of points in the signal. And now the thing is about this construction, which I know I've said several times before, in particular in the spectral analysis section of this course, but it's worth repeating the frequencies that you get from this kind of construction are valid up to the Nykvist frequency. So up to five hundred hertz, but they are invalid above this. So as long as you keep that in mind, then it's OK to use this little cheat here. There's a little shortcut. OK, so now I'm going to start this again. Now, this really is going up to 100 hertz. So let's set this down to 10 hertz. And now, remarkably, it looks like there's a peak here. I'm going to make this even more striking by defending the signal. And now it really looks like there is a peak in particular around here. Maybe I'll even do one more thing and smooth this time series a bit and use this function smooth. Let's see how that looks. Oh, this looks great. This looks brilliant. Now, this is not a real peak because there's a one over trend and I've removed that from the descending function. However, if this were real data and I said this is synchronization of, you know, two electrodes that were placed in the brain over time, you would say that the synchronization is coming in and out of existence. So the brain is rhythmically synchronizing and synchronizing at a rate of around one and a half hertz or one and a third hertz or so. And then you even see a couple of harmonics over here. Now, that is a totally invalid conclusion. And the reason why that is totally invalid is that this is pure noise. All I did was filter noise and then compute phase synchronization. And yet with a little bit of plotting, a little bit of D trending, a little bit of smoothing, we managed to get a result that look like this. Now, there's a couple of good things that I can say here. So you don't get too nervous and start thinking that, you know, everything we know about the brain is wrong every time series signal analysis is wrong. One thing I can say is that 300 time points at a center frequency of twelve and a half hertz is actually not a whole lot of time. That's less than three cycles. So if we were to increase this notice these values here, the average is actually I think I'll even compute the average explicitly. So think twice. And we want the average of this. So the average over time is zero point four or five. That's a pretty respectable synchronization value. Now I'm increasing the window size to 500. You can already see that this drops a little bit and some of these fluctuations also dropped. And now the mean is point three seven. And if I go up to, let's say, a thousand time points now, this gets even smaller. There are still places where it increases, but it's mostly lower and the average now is zero point two seven. So you can see that as the window size increases, the spurious synchronization value is decreasing now. Out of curiosity, I'm going to generate this plot again. And now you actually don't see any peaks in here. You just see. So this is not a peak. This is just resulting from the trending clipping off the lowest frequencies. And of course, if these were real data, you would have lots of trials, lots of individual subjects, you would have statistics and so forth. So in real data, there are several ways to confirm that what you are seeing is a real result and not a spurious finding. However, I think it is pretty sobering to see that even in pure noise, if you Narrabeen filter it, you are going to get some synchronization which could be misinterpreted.