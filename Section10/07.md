 All to all connectivity measures can get pretty hairy, you get a lot of data if you have all electrodes to all other electrodes, so all possible pairwise connections, not to mention you have different time windows, different frequencies, maybe different conditions and so forth. In this video, I'm going to show you one way of dealing with such large synchronization matrices, and that's to compute something called the Hubner, basically trying to ask whether particular electrodes, particular regions in space are acting as a hub for large scale interconnectivity. This is one of the myriad approaches that falls under the general umbrella term of graph theory. Graph theory is a really large, extensive mathematical framework for dealing with graphs and networks and so forth. And by way of introduction, a gentle introduction. I'm going to tell you a little bit about generating Hubner. All right. So what we want to do here is compute all all synchronization using these EEG sample data set. In one particular frequency. And then we are basically just going to threshold and some the Al-Taweel synchronization matrix, so let's get started first thing going to compute the scalpel operation that's going to help us interpret the scalpel connectivity. It helps reduce some volume conduction. And we're going to do all the analyses at six and a half hertz and focusing on a time window between zero milliseconds and 1000 milliseconds. OK, so the first thing that I do is narrow band filter around that frequency that I specify here, this is hard coded to a full Web traffic maximum of three hertz. Then I apply the Hilbert transform and extract the phase angle time series note again, as I mentioned in several previous videos. Now you have to be careful that you are computing the Hilbert transform along the correct dimension. Normally I would suggest to be careful and check this. However, I've already checked exactly this format of code in several previous videos. Anyway, the result here is a matrix that is the same size as the original data, but it's all the phase angles at six and a half. So you can see it's sixty four channels by six hundred forty nine points by ninety nine trials here. I'm computing all the all synchronization so you can see him doing a double loop over channels, extracting the phase angles from channel, eye and channel J only in this tiny window and for all the trials. And then I compute the phase synchronization using Euler's notation and then taking the average of these complex vectors and then the magnitude and then finally another average. And that's so we can average over trials. OK, so I run this code now for a little bit of visualization. Here you see the entire channel by channel Synchronization Matrix, 64 channels by 64 channels. Of course, it's ones on the diagonal because every channel is perfectly synchronized with itself. And this matrix is symmetric because the synchronization between Channel Ten and Channel 12 is the same as the synchronization between Channel 12 and Channel 10. So this shows all of the pairwise synchronization is what I'm showing here is the seated synchronization from one channel. So I pick one channel and I treat that as a seed electrode. And then I want to know what is the strength of synchronization between this channel and all of the other channels on the scalp. So in this case, I picked channel season and you can see the way that I'm extracting these data. It's basically just finding the row of this matrix or actually, I guess the column. But that's the same. The rows are the columns. So I find the column in this matrix corresponding to the channel that I want to plot specified here. So it seems that I think is Channel 48. So basically this column here and then I'm just plotting this column topographically. So this is Sisa. That's the seed electrode. Of course, the synchronization is perfect here. And you can also see that it's very, very strong with its nearest neighbors. And then you also see in this just slightly off diagonal elements that are also very close to one here. So this is basically residual volume conduction. And in general, with 64 electrodes, you wouldn't want to interpret synchronization. That's one electrode away or maybe, you know, you can say a couple of centimeters away. So some residual volume connection here. But it's interesting to look around the map. You can also see there's some synchronization here with lateral frontal topographical areas and maybe also some synchronization here with posterior areas, maybe parietal cortex. OK, so now we get to this Hubner analysis, and the idea is that I want to take this matrix and binaries it, so I'm going to convert this into a matrix of zeros and ones where we assume that zero means no connectivity and one means that there is connectivity. Now, that concept is a little bit artificial for something like functional connectivity between electrodes, because it's not the case that there is or isn't connectivity. There always is some measure of some amount of connectivity. And the question is how strong it is. Nonetheless, we need to simplify this a little bit and threshold it. So to come up with a threshold, I'm just arbitrarily computing the median. So I'm taking the median of all of these values. Now, the thing is, we don't want the diagonal to influence the median. And second of all, I don't want to include all of the redundant elements. So I want to reduce this matrix a little bit. So first of all, what I do is say try you, which is triangular upper. And let me walk you through this code piece by piece so we have an image of sync maps. That's exactly what I showed you here, just with different colors going. But this is the same synchronization matrix. And now I'm going to say image of tri you. So this extracts the upper triangular. That's what this function does. So let's see what that looks like. Now you can see the upper triangle. So from the diagonal and up into a right, that is exactly the same matrix that I just showed. It's also exactly the same matrix here, although the color scaling is different, but all the elements below the diagonal have been converted to zero. So these are all zeros. And that's important because these are all the redundant elements of the Matrix. So I can actually exclude these when computing the median. Now, in truth, it turns out you don't need to extract only the upper triangular to compute the median because this these numbers don't provide any unique information, but they also won't change the median. Nonetheless, you know, I just wanted to take this opportunity to introduce you a little bit more to some Matlab functions. In fact, I can even show you the compliment to try you is try trial for the lower triangular. OK, so then the next thing I do in this code is subtract off this weird thing called AI and then EEG. And Vicenzo Eye is a function that creates an identity matrix, which is all zeros and ones on the diagonal. So when I subtract this off, then that has the effect of eliminating the diagonal because the diagonal is currently all ones. Of course, every electrode is perfectly synchronized with itself. However, I don't want those ones to bias the means. They have a bunch of trivial ones. There's 64 trivial values in here that are higher than the rest of the distribution. So those are going to pull up the median of it. So by subtracting this off, I've basically converted the diagonal into zeros. Now, again, it looked like it changed a little bit, but that's really only because the colors changed when they got rid of all the ones. OK, so now we have a matrix of only nontrivial values. So the redundant values have been removed, the trivial diagonal of ones has been removed. But now you definitely do not want to compute the median on this entire matrix because most of this matrix, more than half of this matrix is zeroes. So therefore, I use this function non zeros and that will basically just extract all of the non-zero elements. All right. That gives us our threshold. And the threshold is zero point four or five. So point four or five is the median connectivity value in this at all. Synchronization matrix in this time window in this frequency. And what I do with that threshold is I say find the elements in the synchronization matrix minus the identity matrix, because again, I want to ignore the trivial. Diagonal here, find where those matrix elements are above the threshold, so you can see that looks like this. It's a matrix of all zeros and ones and I can see images of threshed from that. So now this is a binary image. So now we assume that blue means there is no connectivity and red means that there is connectivity. Now, once we've converted the Matrix into this format, this binary threshold, it binary format, computing happiness is pretty simple. You just sum up the matrix elements along the rows or along the columns. It's actually the same thing. And then if you want, you can divide by the number of channels. So that puts it into the scale of proportion instead of the scale of the number of electrodes. And you want to subtract one because we are ignoring the diagonal, which means we are ignoring the trivial fact that every electrode is perfectly synchronized with itself. OK, so now we can make a plot of this over the different electrodes. This is kind of hard to interpret because these electrodes are not necessarily spatially contiguous. So interpreting the electrodes as a line is a little weird. I just wanted to show you what the distribution looked like. So basically, these electrodes down here, that means that this electrode twenty seven or whatever this number is, that electrode has supressed threshold connections to 25 percent of the other scalp electrodes, whereas this electrodes, thirty nine or whatever, has supressed threshold connections to 80 percent of the other electrodes on the scalp. Now, you take all these numbers and spatially organize them into a topography and you got something that looks like this. So here you see that posterior areas have very low interconnectivity and this frontal area has very large inter electrode connectivity. Again, this is only in a particular time window and it's only for a particular frequency. OK, so at this point, you might be concerned that the results are dependent on the exact threshold. So what would have happened if I had picked a different threshold? Maybe I could have done, uh, you know, let's say one point five times the median and those results would then look like this. You can see this is a much, much smaller or if I had done half the median, then, OK, well, now we get all one. So everything is higher than half the median or not even the median. Maybe if I just would have said arbitrarily, how about point five like this? Now we got something slightly different. Actually, this looks a little bit comparable to the result from just using the median. OK, but the point is that this measure of happiness is indeed threshold dependent, particularly in this case, where you you don't have a clear natural way of binaries in the image. And that is the last thing that I want to explore in this video. So what I do here is change the threshold and then I'm going to loop over threshold and basically recompute this Hubner measure over different values of a threshold. So I'm using thresholds that range from zero to one in thirty seven steps because I don't know. Thirty seven seems like a good number. So then here are these two lines of code are basically the same as two lines of code I showed earlier. So I binaries and threshold the synchronization matrix and here I compute the happiness and then we are going to get to see what this looks like. So the lines here correspond to channels. So each line and each set of green dots is a different channel on the scope. This is the significance threshold and significance has to be put into apology quotes here because this is not really a statistical threshold. This is just what we are arbitrarily considering for the rising threshold. So when the threshold is really low, you see that everything is connected to everything. When the threshold is really high. Nothing is connected to anything. And then there are these intermediate values in particular around point four to like point eight, synchronization strength where we get some variability. So indeed the results are threshold dependent. In practice, one way to deal with this ambiguity is by apriori selecting one specific threshold and applying that threshold blindly to all of your conditions, all of your time, windows and so forth. So that way, although there is some arbitrariness in selecting the threshold, at least it is applied equally arbitrarily. So in an unbiased fashion to all of your analysis.