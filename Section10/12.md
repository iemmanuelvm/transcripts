 Now, I'm going to walk you through my solutions to Project two in Section five. Now, this actually isn't going to take too much time because, in fact, I literally copied and pasted all the code from the video power time series correlations, and I only needed to make a few changes. So basically, I'm just going to walk you through the changes that I made. And if you are not familiar with the rest of the code, then I recommend going back and watching the video Power Times series correlations. All right. So one thing that I changed was to make this Matrix format be and have an additional dimension. So before it was just frequency's by channels, by channels. Now I'm making it two, by frequency's, by channels, by channels. And the two, of course, is for the different manifestation of connectivity. So power time, course or phase angle time series. It's also perfectly acceptable to put these into two different matrices. So you have one matrix for power correlations, one matrix for phase synchronization, but in particular for generating figure two. I think it's a little bit easier to have all the results in one matrix that does give a big matrix. You end up with a four dimensional matrix. OK, so now we loop over frequencies. I made a few minor changes here, mostly just to apply the Hilbert transform directly on the filtered result and then here separately extract the Amplitude Time series and the Phasing-in Time series from the Hilbert transform of the narrowband filtered data. And here's this transposing business. I've mentioned this in previous videos and I'll point that out again just because it's a pretty important point. You owe it. Whenever you are inputting a Matrix input into the Hilbert function, you need to be very careful that the orientation is such that you are computing the Hilbert transform over time point's not over trials or over channels. And then when you transpose it back. So if you need to transpose, you don't necessarily always need to transpose. But if you need to transpose and when you transpose it back, you should be sure to implement the normal transpose, not the formation transpose. And that will preserve the correct orientation of the phase angle time series. OK, so now we get into this loop, this is the same as it was before, except for this extra dimension in the beginning of the format matrix. So this you have to be careful of to add the one there and then here for phase synchronization. Now, if you like, you can actually implement this in a double loop over channels so you can say for Channel Eye and then here you could have another loop that would say Channel J. That's perfectly acceptable. I chose to do this using the best X1, so binary expansion and that basically allows me to eliminate one of those channel loops. So this is a lot of code. This is a pretty dense line of code here. This is a bit more advanced matlab programming than writing a double for loop. There's nothing whatsoever wrong with writing a double for loop. However, I do think it's good for you to take a few minutes to look through this ludicrously long piece of code and at least make sure that you understand what it's doing and why it works, even if you prefer to stick to more straightforward and more kind of visually interpretable code of having a double for loop. And if you're a bit confused about what's going on, then the advice is to look through this code, run through this code piece by piece so you can see what is the size of this thing, what is the size of this thing. And then you can figure out what is the size of everything inside this X1 function. What does that look like? You can make lots of it and then basically work your way from the inside towards the outside of this function. And hopefully by the end you will figure out why this code works. And then of course, inside this loop over trials, we are adding more and more data into this format matrix. And so then it needs to be divided by the number of trials or one other thing I wanted to mention, if you are copying and pasting here, you have to be really careful that you're also changing any relevant parameters in here. So here, if you would just copy and paste, you would need to be careful to change this from a one into a two. So if you went like this, there's no matlab errors that are being produced here in terms of pure code. This is correct. However, this is obviously the wrong thing because you are mixing the power correlations with the phase synchronization. All right. I think generating this figure is pretty straightforward. So I kept this was the original line of code. I just had to add a one here for this first dimension. And then I added, hold on. And the second plot command to generate the red line here. And then in here, this is a little bit different. This was the original code and this I just had to change a bit so that it's a three by three geometry subplot, geometry instead of just a two by three geometry. And then this is yeah, this is more or less the same code just with relevant parameters change. OK, and then for the topography, that's actually pretty straightforward. You specify a seed frequency and a seed channel. And then I made figure two using image season and function image scale and then basically input this correlation matrix and the frequency that you want, the seed channel and then all the other channels. And then for both of the power versus phase synchronization. I transpose it here because otherwise the default just based on the matrix orientation ends up being a row. I can actually I can show you what this looks like. So if you don't transpose, it comes out as this row thing, which is fine on the one hand. But these channels actually are vertically placed in the brain. So this is a more sensible orientation for the Matrix. So now that you have all the code, it's interesting to explore around in particular with these figures and just qualitatively look for patterns that are similar between phase and power correlations and patterns that are different between them. And here you already see some difference. So this is synchronization with Channel nine at 50 hertz. And for whatever reason, it seems like there's very low power correlations between Channel Nine and these deeper channels, but there is more robust phase synchronization. So there's something about the timing of the oscillations in these deeper channels that's consistent with Channel Nine, whereas the amplitude fluctuations in these deeper channels is not correlated, pretty much not at all correlated with the amplitude fluctuations in Channel Nine. And in general, this is something you see in the literature and also in real data. If you explore in real data, sometimes power based correlate connectivity and phase based connectivity. Look, overall, quite similar. For example, here the I think these look fairly similar to each other and sometimes they look quite different. And here's a good example of where they look different. So this is power correlations of 56 hertz and phase synchronization of fifty six hertz. And I think these two maps look quite qualitatively different from each other.