 In the video on the scalp replacing four electrode level connectivity, I mentioned that there are two general approaches for dealing with connectivity synchronization in electrophysiology data where there is the possibility of contamination by a volume connection. One family of approaches is to apply some kind of spatial filter to the data to try to account for the volume connection or attenuate volume connection. And in that case, I apply this scalpel place in. You'll see, another set of methods in that general family is to use some kind of multivariate components analysis, which is the main section or the main topic of the next section of this course. So that's one general approach. The other general approach is to apply a different measure of synchronization that is robust to volume connection to instantaneous connectivity. And one of those methods is called the phase like index. It's certainly not the only method. There are several volume conduction, robust methods, but many of them have the phase like index kind of at their core, and then they build off to something a little more fancy. So there's, for example, the weighted phase like index and the biased phase like index and so forth. All right. So in this video, I'm going to show you how the phase index works. And in particular, we will also compare it to the quote unquote, standard phase synchronization, which I often call intercept phase clustering. All right. So here is a pretty simple simulation to begin with. I'm just going to generate one hundred phases. So this is random number, uniformally random numbers, and then I multiply them by PI. And that's basically just because I don't want to fill up the entire phase space, I just want to fill up well, about half of phase space and then I'm adding one that's just an after. I'll show you the implications of this in a minute. Here I compute the play and here it compute the interstate phase clustering and then I make some plots. So I'm going to talk about these lines of code in a minute. First, I just want to show you the plots so the thin gray lines show all the individual faces. Now, of course, these are just pure random numbers, but you can imagine that each of these lines would correspond to a phase angle difference between two channels. So this would be your distribution, your population of phase angle differences. The thick black line here shows the average phase. So the average vector of all of these unit vectors and you've learned from the past several videos that one measure of synchronization would be the length of this average vector, and that is here called ISPCC intercept phase clustering. And this happens to be around point seven. And now the play is not the same measure. The play is a little under point five. So let me now walk you through the equation or the code, at least for computing these two measures so you get a sense of how they differ. So this you've seen before. So basically, we take the oilrigs diversions, we take the phasing-in differences, multiply them by the imaginary operator and embed them into the natural exponential. So this is the Euler's formula, Euler's identity, each of the IC. Then we compute the average vector, which is this black line, and take the length or the magnitude or the absolute value of that average vector. So this is actually nothing new. You've seen this in several previous videos. Now I want to show you how the play is computed. So we start off with the same oilor representation. And you can see that at the end, the play is also really similar notice this piece of code is nearly identical to this piece of code. So we're still taking the average. We're still taking the absolute value. But there's one other step in here. And so that other step is first, we are just extracting the imaginary part of this. So remember. This variable here called oilor, these are the representations of each of these phase angles, each of these vectors in the complex plane is plotted here on a polar plane, but we are representing them initially as complex numbers. So now we take just the projection onto the imaginary part. So that's going to look like this. And essentially, these numbers are going to be positive if the line is above the real axis. So this is the real axis here. This is the imaginary axis. So if the vector is above the real axis, it's going to have a positive imaginary component. If the vector is below the real axis, it's going to have a negative imaginary component so that you see here negative numbers, negative numbers. So whichever two vectors these correspond to, these happen to be both pointing down and all of these vectors are pointing up. And now I take the side of that so we don't actually care about how far on the imaginary axis that's projecting. So the let me try to make this a little bit more clear. So imagine the imaginary axis is the line that goes from here, sort of 90 degrees down to here. Two hundred and seventy degrees. And what this piece of code does. So image oilor, so extracting the imaginary part of this complex representation, that's basically just asking where is each of these vectors on this y axis. So this vector is over here and this vector is over here. So the imaginary component of this vector is very small. It's close to zero, but still negative. The imaginary component here is larger and also negative. And now what we're saying is, well, I don't care about the magnitude. I don't care about how far down it's going. All I care about is the sign, whether it's above the real axis or below the real axis. So it gets converted into sine. And from that, the plate is simply the average of all of these signs. So it's the average of all these ones and minus one. And then we just take the absolute value because we don't actually care about whether the vector is pointing above the real axis or below the real axis. All we care about is whether the distribution is dominated by angles pointing up or by angles pointing to, I should say, vectors pointing down. So that is the mechanics of play. That's how you compute it. The question is, why is that the right thing to do? And there's a slightly longer answer. And you can get this from, you know, the background knowledge for this section. But essentially, if you have a single dipole that is projecting its electromagnetic fields to multiple electrodes, to electrodes, then that single source will project simultaneously to both electrodes. And if there is a simultaneous projection, it would mean that the phase angle difference would be either at zero or at PI, depending on the position of the electrodes relative to the dipole. So that means that any faces that are exactly here or exactly here or distributed around here, you know, you can imagine if it's true volume, connections, simultaneous projection, plus noise is going to be distributed around zero or around 180. And if it's equally distributed around zero, then there's going to be the same number of positive vectors and the same number of negative vectors or like positive and negative. Of course, I'm referring to their projection onto the imaginary axis and basically those values get discounted. All right. So that is a bit about the pie. And now what you can do is take some time to play around with this single parameter here. So I'm going to delete this. And now all of the vectors are pointing up at least a little bit up. So they are all positive. So the phase clustering is around point six and that makes sense. There's quite a distribution of these phase angles here, but the Peli is exactly one and the Peli is exactly one because all the vectors are pointing in the same direction or project onto the same direction on the imaginary axis. So you can try, for example, adding PI and now we see what sorry I am and pi over to. So now you can see ISPCC is still basically the same value. Of course it differs every run because these are random phases. But you can see especially the phase clustering is always kind of around point six point seven, but the play now is basically zero zero plus a little bit of noise and it's zero because half the angles are are pointing down and half the angles are pointing up. All right. So with that as an introduction, I'm now going to go to the next section. And what I want to do is generate two signals. And over time, I'm going to change the phase of one signal relative to the other signal. And I will plot the ongoing play and phase clustering. And actually, what I'm going to do first is just run the animation and then I'll go back and talk about this code a bit. All right. So this cell just sets up the figure. And I'll walk you through briefly what this code does in a minute. First, I want to run this animation and we can talk about it. You can look at it and think about it. And again, I'll come back and I'll talk a bit about how this code works. All right. So here you see the two signals. The blue signal is fixed, the orange signal is moving. So the phase is changing over time. The phase angle distribution between these two signals is moving around the circle. So it's moving around the circle because the phase, the relative phases between these two Steinway's plus noise are shifting over time. And then over here you see the play in blue and the ISPCC in orange, and they are unfolding over time, which also happens to correspond to the phase offset between these two. So let me run this again. Now we can inspect this thing. And this is pretty interesting to see that the phase clustering, the raw phase clustering is just the length of this black line. So that's basically the same magnitude over time. But the blue line is kind of bouncing up and down. And that's because every time this distribution passes through zero or passes through PI, then there's roughly the same number of vectors above the real axis versus below the real axis. And that's causing this big dip in the Peli where it goes down to almost zero. All right. So now that's basically all the content for this lecture. I want to just spend a little bit of time walking you through the code just to give you a bit of a heads up about how this thing is working. So here I initialize basic stuff. That's not a very informative comment, but whatever. So 300 points in the signal. And here is just some arbitrary time vector here. I define the phases. There's one of these phases. So this is going to be the phase offsets and they're going to go from zero to two PI. Now I generate the first signal and this is just a pure sine wave and I'm adding a little bit of noise. And the main reason to add noise is just so you can see these vectors here. If I don't add noise, then all the phase angle differences are just a single line. So this just helps the visualization a bit. All right. Here I extract the angles using the Hilbert transform. And let's see here I initialize I'm using this deal function to distribute this input so this Xeros vector equally to these two outputs. So the plays and the interstate phase clustering. Now I set up the figure, so I'm getting a handle. I've mentioned this several times before in this course and making animations. That in general, when you were working through an animation, you don't really want to draw the entire figure, you just want to update the data in figure or graphics objects. So that's what I do. I get a handle to the plot object here. This just, you know, make the graph look a little bit nicer. And same story here. Notice that here I'm basically just plotting all sorts of random stuff here. Random phases, length one. That doesn't matter. This is totally not the average vector of this distribution, obviously, but that doesn't matter. These are all I need is like these dummy handles and that I'm going to address later on. All right. And then same story here. This can be. Oh, well, OK. Now it actually is data, but up here, they're initialized to be zero. So, in fact, when you run this first cell, these are all zeros. All right. So now in the animation, we're looping over the different phase. Values I generate signal to and signal to this part is exactly the same as signal one. It's just a pure sine wave. But here I'm adding a phase offset and again adding a little bit of random noise, compute the phase angles. And here again, I take the oilrigs phase angle differences. So the phase angle differences and then embed that in Euler's formula. And again, this is kind of weird spacing here. But I want to show you that the computation of phase clustering and the computation of the phase like index are both really similar to each other. There's just a couple of additional modifications that take place in the phase like index. All right. And then so I guess. Yeah. So then I update the Y data for the sine handle two. So there's actually two handles inside this variable and then I have to loop through all of the time points to adjust each of these great lines and then adjust the mean and the connectivity plot. So I'm adjusting the X data and the Y data for the two connectivity measures. All right. So I hope you found this video useful. I think I'll run through this again because it's kind of fun to watch. I was like these Matlab animations. I hope you found this interesting. Neither the phase clustering nor the Peli are really optimal measures. They both have their advantages and limitations. You can read more about the pros and cons of each of these measures in the literature. My point in this video was to give you a better sense of how these two measures compare to each other and how the play is defined.