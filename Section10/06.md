 One of the potential conflicts of measuring connectivity with skalp, EEG or electrophysiology more generally is that of volume conduction. And the problem is that volume conduction describes that a single source in the brain can contribute to the electrical activity recorded from many electrodes. This means that connectivity between electrodes might reflect true connectivity between two different circuits of the brain, or it could simply be a trivial result of the same electrical source contributing simultaneously to multiple electrodes. Now, volume conduction is actually a really important feature of electrophysiology, and you will see that, for example, in the next section of this course on multivariate components analysis. However, here we are interested in electrode level connectivity and there are basically two general approaches for dealing with the issue of volume connection with electrophysiology data. One method is to apply connectivity methods that are robust to volume conduction. And you'll learn about one of those analysis methods face like in a little bit later in this section of the course. Another method that I'm going to talk about here is to apply a spatial transformation, a spatial filter, in particular, a method called the scalpel operation, or sometimes called the surface ablation. And the idea is that the place is a spatial filter that attenuates low frequency activity. And the idea of that is that low frequency, low spatial frequency activity, not temporal frequencies, but low spatial frequency activity, is likely to reflect volume conducted signals. You will see the effects of the scalpel placing on connectivity estimates in a later section of this course and later video. For now, I want to give you an introduction to the scalpel placing using simulated data. So let's get started. What I do here is load in this empty EEG data set. We've used this several times before. In this course, I pick to dipole locations that are pretty close to each other. Oops. Had to be in the right directory here. OK, so I pick two Dipo locations that are pretty close to each other. They are the red and the black. So you can see the close and when you see the topographical maps you will see that these are also quite close to each other topographically. And so they overlap quite a bit. So one of these dipoles projects maximally to thirty one, but also to a lot of surrounding electrodes and the other dipole as its maximal projection to I guess electrode twenty six here, but again lots of distribution. So you can see that the activity from these two dipoles will be overlapping at the level of electrodes. Now what I'm going to do is apply the scalpel placed in to both of these maps and we will see whether the topographies look sharper, whether they look more just sociable. OK, so here I'm using this function, the place in Perren X, it's for the place and the algorithm that implements the application was developed or introduced into literature by someone named Perren and several other individuals in their 80s, I believe it was. And then X, because this is basically my hack, my version of the implementation of this algorithm. So you input the data to compute the place of and then the X, Y and Z channel locations. So compute the place for map one and map two. And you can see that these each return a vector of sixty four elements corresponding to one value per channel. Now later on you'll see that I'm going to input data into this and we're going to get out data, but for now we only input vectors. So we're going to get out vectors. OK, and then here you see the presence of these two maps, so this one corresponds to this map. This one corresponds to this map. And of course, they still overlap a little bit. It's not so surprising, but they are much more isolated in the lipless in compared to the regular dipole projections, the original projections. So here the idea is that if there is activity being generated by these two dipoles, they get spread over the scalp according to this spatial distributions. And now if you are just analyzing the regular voltage activity, you are going to have mixing between what happens at this dipole and what happens at this dipole. And now if you apply the place in, hopefully there's going to be less mixing between the two dipole. So in other words, we are using this spatial filter, the placing to implement source separation. We are trying to separate multiple distinct sources according to their topographies, which is difficult here, but more possible here after the placing after this spatial filter. All right. So here you go. I am going to, first of all, just reduce the total amount of time. I think it starts off with 10 seconds, if I remember correctly. So originally, 10 seconds of data. But I'm just specifying that the times the times vector should go from one onto the index corresponding to one. So it's a little visually tricky. This is index one and this is second one is one second and then have to redefine the number of time points. So this is going to end up being actually just over one second, I believe. Yeah, one simple point over one second. So now here I generate Deportivo. So it's not heavily commented because this is more or less the same code that I presented in the beginning of this course on simulating data and dipoles and projecting them out to the scalp. So initialize the data to be zeros. It's the number of dipoles by the number of time points. Then I specify one dipole activity should be a 10 hertz sine wave, the other dipole activity should be a 15 hertz sine wave, and then the data is simply the gain function times, the dipole data. So this ends up giving us so let's see, this matrix is channels by dipoles and this is dipoles by time points. And so we get channels by time points from here. So now these are the ETG time series data. And now what I'm going to do is create a new EEG structure. I'm going to call it Lappe for the place. So this is just a copy of the EEG data. And then here I'm replacing the replacing data with the EEG data. You could also say lab data here if you want, but the place infiltrates. So in this case, I'm inputting a let me set this. Let's see. I have to run this code. So I'm inputting a two dimensional matrix of 64 by one twenty, that's EEG dot data. And then when I get out is Lappe data, which is also the same size. But this is the plus in spacially filter. All right, so now we have these two data sets and what I'm going to do is run this plot, some egg function to allow us to plot the EEG data and the plasty and data. So first, let's start with Channel 27. Let's see where Channel 27 is. So that is quite far out here. So you can see this projections of Dipo one. Looks like there isn't a whole lot going on there, whereas here there's a little bit of projection density from from dipole to. All right. So let's see what these two figures look like. So let's go first to figure two, this is the regular EEG data here you see a complex looking sine wave. So this is two sine wave, some together, one has higher amplitude than the other that you see here. Now, remember, from the simulating the data, each dipole is a pure sine wave, so just one frequency. So this basically indicates that at Channel 27 in the Raw Data, we have a mixture. We have a combination of the 10 hertz signal and the 15 hertz signal so that you see here. And also in the frequency part, you see that these are mixed. Now, in figure three, you see that we have been able to separate these two different sources. To some extent. It's not perfect. So most of the energy is coming from 15 hertz there. There's still a little bit of energy at 10 hertz. But clearly, compared to the raw data, the voltage data, the place and filter data shows a much, much more attenuated version of the ten hertz component. And you see it also here in this time frequency. So that's useful. We have been able to perform spatial separate our source operation by selecting different electrodes and that method was much better after applying the Piscean than after the original voltage data. So now I'm going to try this again with electrodes 31. You can see here these overlap really a lot, these two original projections. Now, when you look at the LaPlace and you can see you actually still do overlap a little bit. So let's see what the results look like here. So let's start here again, you see a combination of two sine waves and you see that very clearly in the static power spectrum and you get some interference patterns here in the time, frequency, power, pop. And now when we look at the application form, well, I think it's a little bit better if you compare this static power spectrum before versus after, you can see that the separation is better. So this 15 Hertz component is more attenuated than it is here, but it's still present. So this 15 Hertz component is still present in the time domain or in the signal even after applying the law passed in. Now, that shouldn't really be too much of a surprise, though. Place is a great spatial filter and has many great properties, but it's not perfect. No filter or no method is perfect. In general, if you are going to perform skalp level electro level conductivity analysis, then the scalp replacement is a great preprocessing method to help you attenuate. Not entirely eliminate but attenuate potential confounders due to volume conduction.