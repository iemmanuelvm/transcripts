 In this video, I'm going to show you how I go about using ICRA or independent components analysis for data cleaning. Now, before I begin, let me make a few things clear. One is that I'm going to be using a data set that I'm not providing to you, mainly because it's a fairly big data set. It's close to a gigabyte, too, is I'm using the EEG lab toolbox for this video. Now, you do not need to have this toolbox for any other part of the course. And you also do not need to have the toolbox for this video. You can just watch and learn. However, if you are doing EEG processing and cleaning and if you are using the EEG lab toolbox, then you might be using independent components analysis or ISO for data cleaning. So I already have the data imported into EEG lab and I'm not covering that in this video. So we can have a look at the data. We can go to plot and channel data scroll. It's always good to look through all of your raw data. And so I already talked about interpreting a plot that looks like this, where you see that each line corresponds to a data channel and each segment here corresponds to a different trial or apoc in the experiment. And I've already talked about features of the data that you can see that look like artifacts. And these are features that should or should not be worrisome and that you might want to remove. Now, what you also see in this data is these large spikes here. This is actually MGE. These are not EEG channels. These are electromyography channels. These are small electrodes that are placed on the thumb. That's like the meat of the thumb. And these are measuring when the research participant was squeezing their fingers in order to press the button to make a response. So here you see when they press the button and here you see. And so each one of these spikes corresponds to the twitch of a muscle. And then, let's see, it looks like there's a little bit of noise here, like Channel T7. So that's actually fairly close to the ear. Temporal seven. It's close to the ear. So there's a little bit of of noise here. There's some noise in these channels and we can also see blinks. Let's see. So here is a blink artifact like this. You see this large deflection here, OK? And so what I'm going to do now is run independent components analysis in EEG lab in order to decompose the multichannel signal into a series of components that are maximally independent from each other, statistically independent, and that together will account for all the variance in the multichannel data. So we can do this. So different versions of EEG lab have the tools in slightly different places, but it's generally going to be somewhere under the menu option tools and then decompose data by A.S.A.. Now, in fact, I've already run ICRA on these data, so I'm just illustrating to you how you would do this in the lab. Cooey So you can run it with the defaults, you can select different ICRA algorithms and then you press OK. And then depending on how much data you have, this could take anywhere from minutes to hours. If you have really a lot of data, it might even take a full day for one data set to run. OK, but so now I say is finished. We already have ishay. And so what I'm going to do now is walk you through how I look through independent components to try and determine which components should be removed from the data. So we already have the data over here. I like keeping that open and then I'm going to go plot and component activation scrolls. So what this is going to plot is not the channel data, but the component time series data. So now what you're looking at is each line, each each row in this data set is a components the time series from an individual component. Now there's a lot of them. There's sixty six because there's sixty six data channels. However, a lot of the later components are not really accounting for a lot of interesting variance. So generally I would show so. So I just did settings and a number of channels to display and then I'm going to select only the first, I don't know, let's say 13. So I'm only going to look at the first 13 components up here. So it's pretty interesting to see what they look like here. You can already see component two looks like the blink artifact and then you see component four and component nine seem to capture. Now, if you just looked at these data, if you didn't know anything about the data, you might think that this is some really bizarre. Maybe it's like a mechanical artifact or something, but actually, knowing what I just told you about. These two channels, you can see that these two components, component four and nine are telling us about are picking up on the EMG channels. All right. So the thing is, I don't so we want to pick some components that are reflecting some non brain sources, artifacts or eyeblink or whatever, and then remove those from the data. Now, the thing is, I do not trust my own vision just for looking at a component and determining whether that component is noise and should be removed or is signal and should be kept in the data. So what I'm going to do is also look at the topographies. So I will go tools and then inspect label or component map, OK, and then now we can actually view all of the components in the data. However, as I just mentioned here, a lot of the later components are not really accounting for a lot of meaningful variance. So I generally only look at maybe the first twenty or twenty five or something like that. Any of the components after that I think are just not even worth thinking about. OK, so here you see the topographies of each of these components and here you see the Time series. Now it's really clear when you look at these maps. So for example, map one, you know, you might look at this and think, you know, there's some of this high frequency stuff, maybe this is noise. Maybe I should remove component one. But when you look at this component here at the topography, you can see it looks beautiful. This is a really nice posterior essential component. This is definitely coming from the brain. So I click on this number on top of the component and then we get a lot of information about this component. So we see, again, the topography here. You see the ERP, the event related potential of this component time series. Here you see all the individual trials. So this is each individual trial is a row in this image. And then the voltage which here is going up and down corresponds in this image to the color going negative for blue to positive for red. So you definitely see that there is some TASC relevant activity here and here you see the spectrum. So it actually does look like there's some 50 hertz line noise in here. But you can also see this spectrum shows the two of the characteristics that you expect for real brain signal. You have this one over. So this decrease in energy with increasing frequency and you have this deviation from that one over F slope here around it looks like around nine hertz or so in the next section of the course. When I talk about spectral analysis, I will talk more about how to interpret these kinds of plots and, of course, how to compute these kinds of plots. Nonetheless, we see that this component is clearly TASC relevant. We do not want to remove this component from the data. OK, let's have a look at Component two, because I suspect that this might be a capturing the blink artifact. Now, there's a couple of pieces of evidence that are suggesting to me that this is a blink artifact and can be removed from the data. First of all, we see the topography. It's very a.. It's all coming from the face, basically, which is what you'd expect for an eye blink related component. And you can also see these are the time series of these components. So there's a lot they're very energetic in between the trials. So here's where all the trial stuff is happening and you don't see a lot happening during the trial. Now, the thing is, actually, if you zoom in. So I just clicked. Let me see. So I just clicked on this IRP here. If you click on one of these figure components, I will open it up in a new figure so you can inspected in even more detail. And by the way, this happens sometimes in in Matlab, but you don't have the top of the window here. If you have that phenomenon, then what you can do is actually click on the side where you're trying to resize the figure. So you just have to click on it. And that will force your operating system to make sure that the top of the menubar is still inside your screen. Anyway, what I wanted to show you is that although this component contains a blink artifact, it is dominated by Blinkx related activity. We are going to remove this component from the signal. However, it actually does still have a little bit of signal. There's a little bit of an ERP here. So there is some real brain related task related activity that leaked into this component. So that also is a nice illustration that it is never possible. It is rarely, rarely possible to purely 100 percent separate signal from noise in practice. Most often signal and noise get mixed together into the same. Frequencies the same channels the same time, windows, in this case, the same components. So when you are thinking about removing noise from your data, you also have to keep in mind that removing noise from data almost inevitably also means removing a little bit of signal. So then you have to make a decision about what is worth keeping this really, really big Blinkx artifact in the data or risking losing a little bit of signal, which isn't really optimal. But I would say that's preferred in this case. All right. So I'm going to click this button, except and that changes it to reject. So now you see, I've marked this for rejection and now what you want to do is just kind of look through these component time series. You can scroll through time a bit. You want to have a look at these topographies and look for components that might be artifacts. So how do you know if a component reflects an artifact? Well, sometimes a little bit difficult to determine. But one thing you can look for is the smoothness of the maps and the number of electrodes that you see contributing to the topographies. So, for example, if you see like big, smooth, low frequency topographies that change fairly slowly over space, fairly gradually, that typically indicates that you're not dealing with an artifact, that that's a real source of signal. In contrast, if you have a topography that changes really quickly or where the entire map is dominated by one single electrode like this, you can see that this component, component number 20 is pretty much entirely driven by this one electrode that's next to the ear. So that is really suggestive of an artifact. So let's investigate this a little bit more. OK, so then when you look at these plots at the component properties, what you want to look for is whether there is there seems to be task related activity. And the question that I try to pose to myself is, if this line weren't here that said that this is time zero, this was the trial on side of the stimulus onset, where would I guess that time zero would be in this plot? What I know that this was the stimulus onset and in this case and it's not really clear exactly where to put this time zero. Mark. Let me show you a contrasting version of that with component one. You know, you look here and it's pretty obvious that the start of the trial is somewhere around here. I mean, maybe you would put the line here, but it's pretty clear that there's a task related response here. This actually comes from the previous trial. OK, but so with this component, where would you guess would be time zero? You might think it's actually all the way back here, maybe even back here, and this would be the trial on. So the combination of features that it's driven by one electrode, it doesn't have a very strong task related response tells me that this is probably capturing an artifact and not a signal. OK, but on the other hand, I am not going to remove this component from the data, and that's because I'm not terribly interested in this electrode. It's all the way over here by the ear. And I am really, really reluctant to remove components, particularly if they are later than component, let's say, 10 through 12. You know, all of these components up here are the most energetic. They explain the most variance, the most amount of the information in this feature space. As you get to later components, they explain less and less variance. So then you have to ask yourself the question, given that this is, you know, here this is also a tiny line. You don't see a lot of fluctuations here in Channel 20, given that this signal probably accounts for very, very little total information in the signal, is it really worth risking to remove signal just to get rid of a small amount of noise? In my opinion? No, I am hesitant to remove more than one component. Ideally, you should only remove one component from your data corresponding to the blink component. Now, in some cases, there will be other components that you should remove. For example, if there's really strong EMG, we can have a look at this Channel 10. This also looks like it could be some M.G. from the neck. You can see it's mostly high frequency here. So let's have a look at this. All right. So now this is also a pretty interesting example. We can see this component has a lot of noise. This is there's a lot of line noise that's in this component. However, you look at the spectrum, there's a there's a clear peak and alpha here and super clear peak to the to the stimulus onsets. So. This is a strong visual evoked component, there's there's a lot of visual activity happening in this component. So this is a perfect example of how you get components that mixed signal and noise together. Now, I would definitely not remove this component because although removing this component would mean getting rid of a little bit of noise, you're also removing signal. So I wouldn't remove that, in fact, from all of these maps. I would really just remove component to it. Nothing else. OK, so now we go back to the lab graphical user interface, this main window here and now I want to see what the data look like before and after removing component, too. So I'm going to click on tools and then let's see where is it? Remove components from data here. And it already suggests to because I marked this one as two. So now I press. OK, and now this is a pretty cool feature of EEG Lab.. This says, please confirm. Are you sure you want to remove these components? We have the option so you can just accept right here we have the option to plot the single trials and this I strongly recommend. So you get a new EEG lab viewer to open up and now you see two lines overlapping red and blue. So the red line is the data with the component removed and the blue line is the original data. So now let's go, let's zoom in, turn, zoom on, and now we can zoom in and you want to see a couple of things when you're removing the components. First and foremost, you want to see that most of the data are not different with and without removing that component. So here we see, you know, we can zoom in on a time window where there's good clean data. Then you you want to see that removing the components does basically nothing. So that's good. You don't want to be removing signal. And then if you go to periods where there is an artifact like here, this blink, then you want to see that the data look better. They look cleaner when removing the signal, the component. So that would be the red line compared to the blue line. So overall, this looks quite good. You can see that there are other sources of artifact that are still in here. Here, look at this channel here. This is 50 hertz line noise. It's on channel number sixty one. And my guess I don't know for sure. My guess is that channel sixty one corresponds to this electrode right here where we saw that this component was mixing together 50 hertz light noise with real brain signal. So if we would have removed component sixty one, then I think this line noise would have gone away, but a lot of the signal would have been lost as well. And then you see other cases here. There's there's still some this looks like some EMG muscle artifacts here in Channel 15. And who knows, maybe that corresponds to this channel or maybe that's from here. I really don't stress out too much about this stuff. Keep in mind, you know, there's there's some other little artifacts here, these these edges here. Keep in mind, data are never going to be perfectly clean. If you want perfect clean data, you have to simulate data. You have to generate your own data. Real data, particularly biological data, are never going to be perfectly clean. And that is why we collect a lot of data. The whole point of collecting a lot of data is so that you don't need to be so nervous about all these tiny little artifacts. I would say my my strategy my recommendation is to clean the data as gently as possible. You want to have good signal? True. You want to have high quality signal. You want to have signals without too much interfering noise or artifacts in there. But you have to keep in mind that every time you remove noise from the data, you are also invariably removing at least a little bit of signal.