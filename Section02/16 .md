All right, let's get started again, picking up with exercise number four.

So in general, we are working in this group towards more and more kind of realistic EEG data.

And I want to clarify that.

When I say realistic, I'm referring to these signal characteristics being more realistic of the kinds

of characteristics that you see in EEG data.

So we are not doing any biological we're not doing any biophysical simulations here.

So it's not that we're generating realistic brain data.

We are generally generating signals, artificial signals that have characteristics that are qualitatively

and quantitatively similar to those seen in real EEG data.

All right.

So with that said, so what we're going to do here is create narrowband, non stationary data.

And the way that we are going to do this is by creating a Gaussian in the frequency domain.

So I showed the formula for that in the slides two videos ago, and then we are going to be creating

random Fourier coefficients.

So we're going to start in the frequency domain create of just pure random noise in the frequency domain

and then taper that noise by the Gaussian.

All right.

So that's going to be the procedure.

So here's the peak frequency and the full with that half maximum of the the signal characteristics.

And let's see, it's interesting to compare the formula that I showed in the slides with these three

lines of code so they almost look the same, except I made a few changes here.

So I'm multiplying by point five instead of dividing by two.

And then there's also this.

I had minus X squared divided by two squared, so I pulled out the two from the denominator and then

I put the X and S together and squared them.

So I just rewrote this slightly from how the math formula looked.

OK, and actually let's start running some of this code here, and it's interesting to look at this

Gaussian.

So I'm going to make a plot because you should always make plots when you're trying to understand something

in Matlab.

So here we see a Gaussian and this is frequency.

Now I'm plotting it by Hertz again.

If this code looks a little weird, you're not totally sure what this means, then don't worry about

it for now.

The point is that we are creating a vector of frequencies and you're going to learn in the next section

exactly what this line of code means and why it's the right thing to do.

But now I just want to zoom in to say set the frequency limit to go from about maybe like five to twenty

one about something like that.

So here we see the Gaussian has a maximum value of one.

It has a peak value of one.

That's not surprising.

We're not multiplying by any amplitude modulators here.

And the peak looks approximately fourteen, OK?

We can see here it's 14 and then the width is plausibly five hertz.

All right.

So then we have inside this loop over channels and over trials.

So we're generating this signal Channel one channel at a time, one trial at a time.

And here what we do is generate the random Fourier coefficient.

So it's positive value, random numbers times some random phase value.

So you can see it's random numbers and then times two pi.

So that gives us a distribution, a uniform distribution between zero and two pi.

And now what we want to do here is taper the four year coefficients by the Gaussian.

So I'm going to run this code and notice that the variable F, C and the variable, uh, what was the

EFG?

So these are the four year coefficients.

This is the frequency domain Gaussian.

They both have exactly the same size.

So now we can look at we can see, you know, what it's going to look like if we plot the magnitude

of the four coefficients that corresponds to the amplitude spectrum of the so the 48 coefficients,

dot star four element Y's multiplication times, the frequency domain Gaussian.

And that looks like this.

I remember that was the Gaussian.

And then we have this kind of like noise superimposed on the Gaussian and that's essentially what we

want to do here.

So the Fourier coefficients times, the frequency domain, Gaussian, and then let's say I'll run this

line of code and then we take the inverse Fourier transform and then the real part of that.

So that's going to give us a real value signal and I'm going to plot that now so you can see what it

looks like.

So quite interesting, don't you think?

Now we get narrow band activity that is non stationary, so.

It's varying, the amplitude is varying over time, you can see also the frequency varies slightly over

time, so it's a little bit slower here, it's a little bit faster here.

And this is going to be our real data, our real simulated data, I guess I could say.

So run all of this code and then let's have a look at this.

So I guess by this point, working through this problem, that none of these plots to be terribly surprising

or yes, I'm not really going to spend any time interpreting these.

So let's see what is the effect of the full with that half maximum on the results is larger or smaller

more realistic?

OK, so let's try setting this to how about one?

Let's try changing this to one and then I will rerun all of this code here.

And I guess I probably should have put that in a separate figure, so I would say that with a full with

enough maximum of one so really narrow Gaussian.

I think this looks less biologically realistic.

I think this doesn't look like real EEG data anymore.

We see this is to, you know, almost pure, sinusoidal.

And this spectrum here is too narrow for real EEG data.

OK, and let's try the other way.

Let's say, what if we make this about twenty one?

So run all this code again.

And I guess again, I probably would have been nice to put this in a separate figure, but OK, so now

we see.

I think this also looks kind of realistic, but a little bit less like real EEG data compared to a kind

of intermediate value of five, a photograph maximum of five.

I think, you know, there's nothing particularly magic or special about the number five as a full with

the maximum.

But in general, as you spend a lot more time looking at real EEG data, real brain data, you will

come to appreciate that narrowband brain data tend to look something like this.

It tends to have a frequency spread that something like this in the time domain.

It kind of looks like this in the time frequency domain, this kind of, you know, sort of it's not

really, really narrow.

It's a little bit wide.

So it has some width in the on the y axis and the frequency spectrum.

This to me looks the kind of the more realistic than the extreme values.

OK.

Question, can you modify the code to have Narrabeen activity at two frequency ranges?

Oh, that's an interesting question.

So obviously the answer is yes, we can modify it.

And the way that I am going to go about doing this is by specifying two Gaussians.

I'm going to create two Gaussians.

It's called this peak freekeh one and peak freekeh two.

And let's make this I'll set this to be twenty one.

And this one.

How about nine now maybe eight.

Feels like an eight day and you could also set two different four with that half m√°xima.

But I will just leave this at five just for you.

I don't know just, just for simplicity I guess.

OK, so now we need actually to frequency domain Gaussian so we need one frequency domain, Gaussian

for peak one and then another one for peak, too.

And so now I will call this FFG two and EFG one.

Now, whenever you are copying and pasting code like this, you always have to be really mindful, really

careful that you are changing everything that needs to be changed.

Unfortunately, in all of this code, the only thing that really needs to change is this variable here

and of course, the output variable here.

All right.

So now what we need to do is I'm going to say, let's see.

So what I'm going to do is leave this variable the same and then I will set this to be a Fourier coefficients.

One equals this times the frequency domain, Gaussian one and then copy paste.

This is going to be two and this is going to be two.

And then what I'm going to do down here is write.

One, and then I will add this together to number two, OK, and the reason why that works is that we

are actually let me show you why this works.

I have to run this code.

Let's see, I run it from here and again, I'm illustrating to you that a good way to understand data

analysis methods to learn about doing signal processing and statistical procedures in Matlab is by doing

a lot of plotting.

So we have F.C. one.

So that looks like this.

And then I'm going to put another plot here about F.C. two.

And let's see, let's set this now down to zero.

So zero hertz up to, let's say, thirty one hertz.

So this is the two sets of Fourier coefficients that we are using here.

Notice that they don't overlap at all or, you know, maybe a tiny, tiny, tiny little bit here.

So therefore, there is unique variance in each of these two little bumps in the frequency domain.

So when we go back to the time domain here, we can simply add them together and that's going to give

us a suitable result.

So let me run this code here.

And now we see in the static power spectrum, we see these two peaks and in the time frequency analysis

result, we also see these two peaks here.

Very nice.

So that is the successful completion of exercise for now, let's move to exercise five.

So what we're going to do here is start creating transients.

So so far, all the previous exercises have been focused on making ongoing activity.

So ongoing noise or ongoing signals.

But we know that real dynamics in the brain tend to be transient.

They tend to be brief.

They don't last very long, maybe hundreds of milliseconds or maybe a second or two.

So that's what we're moving towards now is generating transient activity.

OK, so we start with a Galson, let's see, and I guess the goal is so we specify the peak time of

the Gaussian, the width of the Gaussian, and given that we're specifying these parameters in time,

obviously we're going to be creating a time domain Gaussian.

And in fact, that's what the code says here.

OK, so.

Now, at first glance, it kind of looks like the code is already done for us because you look at this,

it looks like so we're specifying the data for this channel all the time points.

And this trial equals E to the minus T squared divided by, oh, this should be two times S or width

squared.

OK, so it looks like there's, you know, there's no matlab errors here, but there is a math error

on this line, so we have to be mindful of that.

Whoever wrote this code was trying to trick us here.

Who was that guy?

Let's see.

So first of all, you know, there's this other variable Gauss here.

So I'm going to say that this equals Gauss.

And now we need to fix this plot a little bit.

So we have so we need to shift the time vector to get this peak time to work.

So this is going to say minus T minus or parentheses T minus.

I think I called it variable C in the formula that I showed in the slides.

So time minus time shifted, time squared, divided by.

And then we need two times the width squared like this and I believe that gives us a Gaussian.

I'm going to run a little bit of code here to see how this looks.

So, uh, and then we need to talk about this trial here.

But let's get back to that in the second.

So I'm going to play the exact times, because this is a time series.

This is a time domain.

Gaussian by Gauss.

Let's see how this looks.

OK, looks good as a peak of one, which is expected.

We didn't specify any other amplitude and as a peak time of at one second and possibly so the full with

graph maximum is this distance on the Y axis.

And let's see, that plausibly looks like it could be around.

So point nine to one point one.

So that's a little bit over two hundred milliseconds.

But keep in mind that we are specifying this time, not in terms of the full with that maximum directly.

If you want to specify in the full with graph maximum directly, you'd have to use a slightly different

formula.

And actually that formula isn't actually implemented here.

So I'm going to talk in a later section of this course about two different formulas for creating a Gaussian.

One allows you to specify the width in terms of the number of cycles at a particular frequency and another

formula a lot, which is this one and another formula, which I'm not showing here, but I did show

in the slides, allows you to specify the width in terms of the full with graph maximum directly.

All right.

But we're not going to worry about that here.

We just want to get a nice looking Gaussian.

OK, so I'm going to ignore the fact that we are creating this extra useless variable trial.

We'll get back to this in a minute.

So let's see.

First we run this code, make sure we don't get any matlab coding errors, which we don't, and then

we generate a plot.

OK, this looks good.

So here we see, in fact, you don't actually see the single trial data, and that is because there

is no noise, there's no variance, there's no stochastics, there's nothing to every single trial for

every single channel looks exactly the same.

And that's why you don't see the thin gray lines, because they are perfectly overlapping with this

black line.

Here you see the power spectrum of a Gaussian.

And here you see the time frequency response, which is really just this little isolated blip at very,

very low frequencies at one second.

All right.

So here the question is, what happens if you add random jitter to the peak time on each trial?

And a follow up question is how much jitter until the ERP is nearly gone?

So that's basically the idea of this variable here.

So I'm going to replace this from peak time to trial peak.

And then what we can do is add some noise offset.

So I'm going to say that the peak time on this particular trial is the peak time that we specified,

plus some random number.

So just, you know, one random number and here it's going to shift it by quite a bit.

So let's say divided by ten just so it's not shifting a whole lot.

And I will put this into a second figure and let's see.

So now you see that there is some variability, this would be a way of simulating some trial to trial

variance in the brain response.

So let's say you have a stimulus that starts at zero milliseconds and, you know, it takes approximately

one second for the participant process that stimulus.

But sometimes they process faster and sometimes they process a bit slower.

So that's the idea of this simulation here.

Now, notice that the ERP decreased in amplitude here.

The amplitude was exactly one.

And here the amplitude was around point eight.

And that's not surprising.

We are averaging these single trials that have some variable peaks in them.

So the question is, which is really you know, this is more of a qualitative question than a quantitative

question.

Basically, what happens when we add more and more noise?

How much noise do we need to add before this ERP basically goes away?

So let's I put this in a third figure here.

Now, you know, you could ask the question of what does it mean for the ERP to go away?

OK, well, I guess we could call this going away, but you could see I don't know, this is now so

much jitter.

So the ERP now is unrecognizable as a Gaussian with a peak that should be at one.

Now, this is partly a product of the relatively low trial count compared to the very large amount of

variability.

So I don't want to spend too much time deliberating this question.

But just for you to appreciate that, as you add more and more jitter to the delay to the peak time,

then the ERP is going to get smaller and smaller and the time frequency response will also get kind

of weirder.

All right.

So let's move on to exercise six.

So here we are going to create oscillations with a Gaussian.

So this says that we are now going to create the most useful simulations for a time frequency analysis,

time, limited, narrow band activity.

So this is what's really typical in electrophysiology data.

You see activity that is limited in time and also limited in frequency.

And the way that we are going to simulate that here is by multiplying a Gaussian by a sine wave.

So let's have a look through the code before we start worrying about it line by line.

So we are generating a actually let's even go down to the middle.

So we have this double for loop over channels and trials and then we generate a time domain Gaussian.

And you can see that the peak time is also going to be a bit variable.

So here is the Gaussian.

We generate a pure sine wave cosine.

But that's OK.

And then we I guess we have to multiply the sine wave times, the Gaussian, which is not done here.

All right.

So let's see.

We have the sine wave frequency of eight hertz and then we have the Gaussian parameters at with a peak

time of one second a width.

Remember, this is not a full with enough maximum of zero point to this is probably going to correspond

to a full with the maximum of maybe around five hundred milliseconds or so.

All right, and then inside this loop, so we generate the Galson, let's have a quick look.

So this is E to the minus T shifted by trial, peak squared divided by two is square.

All right.

So we don't need to change this line here.

We need a sine wave with the same phase.

So let's see.

I don't think that this is going to give us what we want.

This is so plot IEG Times by cosine of ego.

At times, this does not look like a sine wave at eight hertz, a sine wave at eight hertz.

We have three seconds here.

So there should be 24 cycles in total.

There's not even one full cycle.

So the problem here is that we need to you apply the full sine wave formula.

So that is two PI times frequency.

And I think, uh, I call it s freakier.

So two pi f t.

So there we go.

I think this is going to look better.

Let's run, uh, start running some of this code here and then we get I'll run this as well.

So let's start by plotting the same thing I plotted before.

So, uh, the time vector by sine wave variable S.W., OK, this looks like an eight hertz sine wave

and then I'm going to look at the Gaussian.

So that looks like this.

And now you can already imagine what's going to happen when we element Y's multiply the Gaussian by

the sine wave.

We get this time limited and narrow band feature in the signal.

And then, uh, so this isn't just the Gaussian.

This is going to be the Gaussian star.

The sine wave might look a little bit confusing because I'm calling this sine wave and sine wave, but

actually I'm generating this as a cosine.

I honestly don't know why I did that.

Uh, but it doesn't matter.

Assigning cosine are closely related to each other.

They're just phase shifted apart, as you will learn in the next section of this course.

So let's see.

Let's run all of this code here.

And all right, this looks pretty cool, so we see the ERP and here we see this time frequency response

and the static spectral response, and this is now really starting to look like the kind of feature

in a time frequency plane that you would see from real EEG data.

And let's see.

And then here you see the trial peak is variable and that's why we get some jitter here.

That's why the ERP is a little bit different from the single trials.

So let's see.

Do the results look realistic?

What can you change to make it look even more EEG like?

Well, I think these results look fairly realistic, except they're too clean.

So let's add a little bit of random noise.

Let's try plus Rand nd.

And we need to see we have to figure out if these are real vectors or column vectors, so this is a

vector.

So we need one comma that points and I will plot this and figure to.

And then let's see if this looks a bit better.

All right, this is starting to look a little bit more like realistic EEG data.

You see that there's some broadband noise.

The ERP is now quite a bit smaller than the single trial data.

And we see all of this kind of texture around here in the time frequency, but also starting to look

more realistic.

We could make this look even more realistic by adding one over Heff noise, but I think that's actually

the next.

Yeah.

So we're going to get to that in a moment.

Let's see.

Here is the next question.

How can you modify this code to make the transient non the make the transient non phase locked?

Which of the three data plots are most affected by phase locked versus non phase locked?

I probably should have clarified here that by three data plots, I'm referring to the ERP, the static

spectrum and the time frequency spectrum.

So I'm going to start by actually removing this noise.

And that's because I want us to be able to visualize the effects of the non phase locked response a

little bit better.

So let's see.

This was figure one and I set out to make this non phase locked.

We can add a random phase value.

So I'm going to say Rende times two times PI and this is going to go in a new figure so we can directly

compare it.

All right, so here you go.

So now we are forgetting about figure two, that was the noisy one.

So we're just comparing figure one and figure three.

And so it's interesting to see that the AARP was sharply affected.

So the AARP magnitude, the you know, the maximum impact here was around point six, point six five.

And here it's around point one.

We can even see more closely what this is.

Yeah.

So here it's around point one and here it's around.

Point six five, but the static power spectrum is totally unchanged, literally unchanged, you don't

notice any difference the time frequency.

It also doesn't look much different.

It's a little bit more extended here.

But I think that's just because of the the random trial peaks.

OK, and now what I'm going to show you is somewhere in the middle and what I'm going to do is multiply

this random number not by two PI, but by one PI.

So obviously, the one is no longer necessary.

And now the idea is this is simulating partially non-physical activity.

So we can have varying degrees of phase locked activity from purely phase locked, which is what we

see here through purely non phase locked, which is what we see here and here.

I'm allowing the phases to be drawn randomly from one half of the distribution.

And let's put that in figure four and you will see that this is going to look somewhere in the middle.

So I'll even move this figure here.

So we see here was the, uh, purely phase locked, half phase locked and fully non phase locked.

All right.

Very nice.

Let's see more exercises for more fun.

Very nice.

So what we want to do here in Exercise seven is add pink pink noise to exercise number five.

Let me close all of these figures.

So what I'm going to do is start by copying and pasting from exercise five.

So this is exercise five.

So copy and.

Paste here and then we want to add pink noise.

I'm going to go back to where we created pink noise that was or was pink noise.

Pink noise was here, so we need the exponential decay and we need, uh, let's see, it was these two

lines of code.

So where are we done here?

OK, so we need an exponential decay parameter, I'll set that to be 50, which we discovered in the

previous video was a pretty decent value.

And then what I'm going to do here.

So here we create the Gaussian.

Here I'm going to create pink noise and let's see generate I'll call this pink noise and then let's

see.

So this generates the pink noise.

I'm going to we have to make sure we're not overwriting any variables here, which we are not.

OK, so that's good.

So now we have our Gaussian.

And actually remember, this random trial pick was a little bit excessive.

Let's divide it by seven point seven seven seven.

No particular reason, but today seems to be like a good day for a lot of sevens, I guess.

OK, so that is going to give us our Gaussian with variable peaks from peak timing, from trial to trial.

Here is our pink noise and then we just add them together.

So the EEG, simulated EEG data for this channel and this trial all time points is going to be the Gaussian

plus the real part of the eye FFE of the Fourier coefficients.

So let's see.

Uh.

So I did a lot of copy pasting here.

I hope I did everything correct.

Let's see.

All right.

So we don't get any errors.

That's good.

But we also don't see any noise.

I don't see any noise.

So what did I do wrong here?

Well, why don't we start by plotting?

Because that's always the place to start whenever you are confused.

So I'm going to plot IEG Times by Gousse.

That looks good.

We have a peak going up to one and then let's plot Hejira Times plus the real part of I forty four eight

coefficients.

And this also looks good.

This looks like what we'd expect for whatever f noise.

So what is the problem.

Well if you look at the this number up here on the Y axis scale, you can see that these numbers are

actually tiny.

So if we would plot the Gaussian on top, you would see that times comma.

Guess that what we simulated as noise is really, really, really small.

So technically we did the right thing here, but the amount of noise is is insignificant.

Let's try multiplying this noise by one thousand and OK, maybe that's a little bit too much noise.

Let's see what happens if we multiply by three hundred and that's also quite a lot.

But let's just try it and see how it looks.

So three hundred times the level of noise.

Now there's also an important principle.

OK, so this is starting to look much better.

This looks pretty realistic.

You still see the Gaussian here in the time frequency response and you see the time domain IRP here

and you see a lot of noise and this noise spectrum.

Now, the principle here that I would like to highlight from this little exercise of multiplying by

three 300 is that because we are not generating signals based on biophysical constraints or morphological

constraints, we are basing the decisions for how to simulate the data on signal processing considerations.

So therefore, it's OK to have these arbitrary normalization factors.

You don't have to worry about what 300 might mean.

You know, neural biologically, it doesn't mean anything.

It's just a way of scaling up the numbers.

So we get some signal that has characteristics that we would want to work with.

All right.

Also, kind of interesting to see that with how many trials we have with 30 trials, we see something

that looks pretty physiologically interpretable.

You know, we get this brief burst of activity at the theta bounce around five to eight hertz or so,

even though this came from purely random numbers.

This is the actual signal.

This is just a noise burst here.

All right.

So now we get to the last one, the last exercise combine four and six to make a transient non stationary

signal.

OK, so let's figure out what this refers to.

So four and six.

So number four was.

The ongoing non stationary signal that was the one where we created noise in the frequency domain multiplied

by a Gaussian to give us a narrowband activity.

So I'm going to start by copying this code and pasting it down here.

And before checking back on what number six was, I just want to simplify things a little bit by getting

rid of everything about the second peak, because I don't think that was that's really necessary here.

So get rid of the second peak and here get rid of the second peak, OK?

And then let's see.

And then what was six.

Six was.

Creating an a transient oscillation with a Gaussian.

OK, so the idea was that exercise for was all about creating narrowband non stationary signals in the

frequency domain that was ongoing.

And number six was all about making a transient response in the time domain by multiplying by a Gaussian.

So therefore, what we want to do is take this signal here.

Where is it here?

And then multiply this by a galizia, and I think I will run this quickly, just as a refresher.

So we're all on the same page here.

OK, so notice that this activity is Narrabeen, but not really, really narrowband, but it's not limited

in time.

It's going it's spreading all throughout time.

So what we're going to do is say that we use the Gaussian in the frequency domain to get this narrowband

realistic looking signal and then we apply another Gaussian in the time domain.

So then we're going to have non stationary in the frequency domain and also non stationary in the time

domain or transient response in the time domain.

OK, so let's see, what do we need to copy from here.

I guess I think I'll just make this all up here or reimplemented, I should say, not make it up.

So I'm going to shorten this by combining this code here.

So I'm going to say that, uh, F.C. one is the real and maybe well, it's OK to leave this variable

name like this.

So now we want to create a time domain Gaussian.

So this is going to be E to the minus times and I'm going to shift this by one second here.

So the peak of the Gaussian will be here minus one, and then we square all of that divided by two times

the width.

And I will hardcoded this width to be point two squared and then the actual data is going to be simulated

as F.C. one dot star Gousse.

All right.

So let's see.

I'll run this code.

Hopefully I haven't made any coding mistakes.

OK, so no matlab coding errors and.

We get a result that looks pretty good, so it is it has both within the frequency domain and it's also

transient in the time domain.

Now, if you like, you could continue working on this code here.

This final exercise, for example, you could make this you could add some pink noise to this.

So it's a little bit more realistic.

You could add some variability to change the peak time, whereas that you could change the peak time

of the time domain Gaussian so that there's some variability basically combining, mixing and matching

all of the computations that you learned about all the procedures that I discussed in this video.

All right, but that is the end of this video and it's the end of working through this problem set and

it's the end of this section of the course, I hope you enjoyed it.

I hope you found it useful and informative.

And I hope you are really excited to learn about all of these really weird, mysterious things in these

lines of code like the foyer, transform wavelet convolution time, frequency analysis and so on.

I will see you in the next section.