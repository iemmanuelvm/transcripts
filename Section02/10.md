All right, so here we are in Matlab, you can see that this file has some errors.

There are some mistakes in here or missing parts of code.

And what I'm going to do now is essentially go through the script and explain all the lines of code,

talk about what each line of code is doing, how it's related to the data.

In this case, it's the data that we are going to explore or the analyses.

What I encourage you to do is before watching the rest of this video, go through all of this code yourself

and see if you can fix all of these errors and you can fix everything else that's going on.

There's going to be other lines of code where there aren't really explicit coding errors like this,

but still the line of code isn't correct.

So you can go through each line and figure out what's wrong.

Now, I've also provided all of the solutions to this code that's in a separate file.

That's going to be a file with the same name, but then underscore SSL for solution.

However, I think it's more useful for you to watch the video and see me walk through the explanations.

That's much more educational than just looking through the solutions yourself.

All right.

So let's see.

So this script actually isn't so much about analyses per say, although we will do a little bit of time

domain analysis.

Mostly what we're doing here is becoming familiar with these sample data sets that we will use for the

rest of this course.

So let's start by loading in this file called sample EEG data.

Now, if you get an error already here, then it means that you're not in the right folder.

So the folder where this script lives, you should have the data sets also in that same folder.

OK, so this says to explore a little bit.

So what are the different fields?

What is the size of the data and so on, the number of channels, time points.

So all the data in this file.

In fact, I'm going to type who's so we can see that this entire file is actually just one variable.

It's a structure.

It's called ETG.

You can see it's a structure here and let's see what's in it.

So this is what I mean by exploring a little bit.

So here we see this structure, e.g. has a bunch of different fields.

There's a set name and file, name, file path.

You can see a lot of these are empty.

So we don't really need to worry too much about these.

But there are some fields in this ETG structure that are important, that are really useful and so good

to be mindful of.

So we have NBT Beach and that is the number of channels or sixty four channels.

Ninety nine trials, six hundred and forty time points.

So this means that for each trial we have six hundred and forty time points.

The sampling rate was two hundred and fifty six hertz.

And then we have these two related variables, x men and X max that refers to the x axis minimum and

maximum when plotting.

So that actually corresponds to the first and the last time point.

So the range of time for these data go from minus one seconds to one point five seconds and then here

we have eight times.

That is a vector of time points.

And notice that EGT Times is six hundred and forty and that corresponds to the number of time point

six hundred and forty.

All right.

And then here we have probably the most important field of this structure, and that is ITG data.

So you can see that it is a sixty four by six hundred and forty eight by 999 matrix.

So this is a cube of data and these numbers should already sound familiar.

We had sixty four channels, six hundred and forty time points and ninety nine trials and ninety nine

repetitions of the same stimulus event.

OK, and then the last thing that I think I will point out here is this variable here called Channel

folks.

This is for the channel locations.

You can see there's also sixty four of them.

So let's have a look at this channel.

Looks variable, by the way.

You can see there's there's a lot more fields in here.

Some of these are relevant for independent components analysis.

Some of these contain the epic information.

So all of the information, the detailed information about what kinds of stimuli, what kinds of responses

were made in each trial, you will learn more about some of these different fields as we go throughout

the course.

But for now, I just wanted to focus on these parameters here.

So about the size of the data, the data itself, and the time points for the data and then the channels.

So we can zoom in to this EEG, that channel Lokes structure, and you can see this is itself a structure.

So this is a structure that is contained inside another structure.

These are the names of the fields.

And you can see that they're all related to space, so we have Theta and radius, X, Y, Z and so on.

So let's look at just one of them.

How about Channel 10?

So this tells us that Channel Ten is located at this X, Y, Z coordinate.

So that is pretty interesting.

We can plot the locations of all the channels.

I'm going to do that using a 3D plot.

So plot three and then here I'm using angle brackets to to concatenate so etg that Channel X comma e.g

the Channel X, Y comma, ETG that Channel Z and then let's just plot to see how it looks.

OK, so we see something that looks kind of weird.

It looks like, I don't know some like sci fi weird building structure or something.

Let's see, I'm going to plot this with circles like this.

Let's make them black circles.

And how about a marker face color of how about magenta?

OK, so now it just looks like a collection of dots.

I'm going to set the axis to be square and then I'm going to rotate.

And now you can see that it's like this kind of semicircle semi sphere showing the locations of all

the electrons in 3D space.

So obviously this is where the head would go in.

So the the participants, the research participants head is going to be in here somewhere.

And here is the physical location of all of the 64 electrodes.

All right.

So let's see.

So that was our exploration of this EEG structure.

Now, what we are going to do is plot some ERP.

So event related potentials.

That's the main engine for time domain analysis in electrophysiology and topographical maps.

Let's see this says compute the IRP of each channel.

Remember that the ERP is the time domain average across all the trials at each time point.

OK, so we learned about this in the lecture.

So to create the ERP, what we want to do is just average over all of the trials.

So let's see.

So EEG, that data, remember, this is a three dimensional cube of numbers of data.

So we want to average over trials, which is 99.

There were 99 trials.

And so to compute the average, we want all of the channels all of the time points and all of the trials.

And then we have to provide a third input into the mean function to indicate which dimension here we

want to compute the mean over.

And that was three, of course, because the third dimension corresponds to trials and now it turns

out this is actually unnecessary.

So there you go.

That computes the to the Iraqi the average for all of the channels.

And let's see what size this is.

So this is this variable IRP.

This is now sixty four by six hundred and forty.

And that should make sense because we have sixty four channels, six hundred and forty nine points.

And in the ERP we no longer have trials were averaging over all of the trials.

All right.

So then what we're going to do is pick a channel and plot the ERP only for one channel.

So here we list the channel that we want to plot and now we can go back and have a look again at this

channel, look at labels.

Labels was another one of the fields that was inside this channel structure.

And I'm using here curly brackets to concatenate appears using square brackets to concatenate.

And that's because these are numbers here.

The labels are strings.

So for strings, we use curly brackets for concatenation.

All right.

And so what you see is that this is a list of channel names.

So each one of these channel locations has a corresponding name.

Now, depending on your version of Matlab, this output might look slightly different.

If you have older versions of Matlab, you're not going to see these curly brackets.

It totally doesn't matter.

The point is, you can see that there are these letters that correspond to each individual channel.

All right.

So we are looking for Channel F.C. Z, so that's frontal central and then the midline or the zenith.

All right.

So let's see.

I don't immediately see any errors here.

So let's just try to run this code and see if it works.

Always a good way to start.

OK, and it works.

So we get a wiggly line here, a bumpy line.

We can see that this is activity in micro volts over time.

So this is our event related potential for this one channel.

He said, and essentially all we're doing here is indexing one particular element of ERP.

Let me close this so we can see all the code.

So we have so we're plotting the time point.

So the vector of time points and the ERP, except we are not plotting the ERP from all the channels,

so we are plotting the ERP from all the time points, but we're only selecting this one particular channel.

And the way that we are selecting this one channel is by using this function SDR comp I so string compare

the means to ignore the case so uppercase and lowercase don't matter.

And then we are looking through this list of channel labels and finding the one that matches said OK,

and then that's how this works.

Oops, I meant to do it like this.

All right, so there you go.

That's the ERP and now you can already start exploring around.

It's pretty interesting to see what does the ERP look like at different channels.

So, you know, O1, for example.

Oops.

Oh, one looks a little bit different.

You can see there's a lot of shared activity across different channels and then there's also unique

variance at each individual channel.

All right.

So now we get to the next cell and here we want to make some topographical maps.

So we want to do here is look at basically a spatial distribution of the activity of this voltage value

at all the electrodes at one single time point.

So here we are slicing the data by looking at all the time points at one spatial location.

And what we're going to do here is basically slice the data the other way.

So we're going to pick one time point.

So it's going to be 300.

So around here.

And then we want to see what does this value look like, this microbial value at all the different electrodes.

So here we pick the time point to plot and we want to plot three hundred milliseconds.

Now, the thing is that three hundred milliseconds is not the same thing as the three hundredth time

point.

For example, if we look at times, the specter of time points for three hundred.

So if you look at the three hundredth element, that actually corresponds to time point one hundred

and sixty eight milliseconds.

So we need to convert from time in indices to time in milliseconds.

And the reason why these don't match the reason why the three hundredth time point is not 300 milliseconds

is partly because we start at

minus 1000 milliseconds.

You remember earlier when we were exploring the EEG structure that that was EEG, that X-Men.

And it's also partly because we have a sampling rate of two hundred and fifty six.

So each time point actually doesn't correspond to a millisecond.

Each time step is, you know, almost four milliseconds, around four milliseconds.

So what we are doing here in this line of code is figuring out the index into each times that is as

close as possible to time to this value here at time to plot.

And so the way this works is minicabs computation is to say minus time to plot, and then it's pretty

much that simple.

So and then we want the second output, which corresponds to the index.

And this tells us that the answer is three hundred and thirty four.

So interestingly, it's pretty close to three hundred, but that just happens to work out like that.

So now we see each other at times T idee X that corresponds to not exactly three hundred milliseconds

because we don't actually have exactly 300 milliseconds in the data, but we get pretty close to three

hundred milliseconds.

All right.

So now we're going to use this Function Topal plot inde.

This is not a Matlab function.

This is a function or it's not a built in matlab function.

I mean, this is a function that I have provided for you.

It's also in the zip file where you got this file and the the data files.

So let's see what happens if we run this code here.

We get an error.

It says reference to non-existent field labels.

Now, normally what you should do when you get an error like this would be to look up the help file

of the function and see if you can figure out what you've done wrong.

Unfortunately, the author of this function didn't give us a useful help file, but we can do a little

bit of guesswork so we can look at the inputs into this function.

So the inputs into this function are values.

And then Channe looks.

And then actually if we look back at the way we've written the code here, we provided values and then

just the structure.

So in fact, what we need to do here is just write that looks like this.

All right, very nice.

So here we see the topographical map of activity at three hundred milliseconds and here you see the

legend.

So this shows the voltage level.

So I explained in the lecture how to interpret these kinds of maps.

Essentially, you're looking down on the top of someone's head and this is the nose and the left ear

and the right ear.

The black dots correspond to the physical location of the electrodes.

Remember, from earlier we were looking at that 3D location of all the electrodes.

So here you see that mapped onto two dimensions and then the colors are interpolated.

These are spatially interpolated values that show the distribution of the microbial value across each

different electrode.

So, for example, this channel here is O1 and that's what we were plotting here.

So O1 had a value at 300 milliseconds.

That was that is.

Yeah, that is like this time point here.

So we have a micro value of around four.

And so looking at the color bar, it seems like oh one here, which we saw in this plot should be around

four.

It looks like it only has a value of maybe, you know, one point, one point three or something somewhere

around here.

So what is going on?

Let's see if we can figure out what's going on from looking back at this code.

So here we specify a time point in milliseconds.

We converted that into indices.

And then looking at the input into the total plot in the function, it seems like we should be calling.

You know, we should be using this variable t idex.

In fact, we don't use this variable anywhere.

It's created here and it's never used.

So we are actually inputting an entire matrix into this total plot indie function, which is not the

right idea.

What we are supposed to be inputting is a vector of electrode values at one single time point.

So this is a really sneaky mistake in here.

This shows the importance of visualizing data and really carefully thinking about what you're looking

at, doing some sanity check.

So what we actually want to plot is all of the channels and just the time point corresponding to t idex.

Let's try this again.

Hmm.

Totally different.

And now we actually see that this channel does have a let's see.

So one is here and that does seem like it has a value of a little bit over four.

So the color scaling, of course, is completely different from the previous plot.

All right.

And now it's interesting to look at different time points and see how the map changes.

So, for example, here's how it looks at 300 milliseconds.

You can see there's a lot of activity, a really large voltage deflection at the back of the head and

not so much as a slightly negative deflection at the front of the head.

In fact, we can even I'm going to fix this color scaling here to make it symmetric.

So I'm going to say set current axis Selam, let's go minus eight to plus eight.

And that gives us an even more accurate representation or more easily interpretable representation of

what's happening around the scalp.

OK, so this is still three hundred milliseconds.

I'm just curious how this looks at 100 milliseconds.

So rerun the code and here we see it.

One hundred milliseconds.

I think I'll.

OK, so one hundred milliseconds.

This is now using the same color scale as 300 milliseconds.

There's really very little activity anywhere.

There's just a little bit back here.

And that actually makes sense because there is a visual stimulus that appeared at zero milliseconds.

So this is just the very beginning of cortical visual processing.

All right.

So that was four topographical plotting.

So we next have the the V one data set.

This is a separate data set.

And I think I will explore this data set in a separate video.

So I will see you soon.