The goal of this video is to see how wavelet convolution compares to the Fast 48 transform.

So what we're going to do here is generate a signal.

This will be a non stationary signal.

So it's going to be a chirp and a non-linear chirp and then we're going to compute one fifty.

So what I often call a static FFE over the entire time series and then a time frequency analysis through

complex multi waves, a convolution.

And then we're going to see how the two compare to each other.

All right.

So let's start by creating the chirp.

Now, this code initially looks quite similar to the code from a previous video on creating a time frequency

plot of a non-linear chirp.

In fact, much of it is the same code, except it's a different function.

So in that other video, I used a lipless distribution and here I'm just creating a normal exponential

function.

So it's E to the T and it's basically just something that goes up like this.

So it increases increasingly.

So E to the X, the derivative is each the X, so it goes up to infinity.

Of course, I'm not going to let it get quite that far.

And actually, let me just show you what this looks like.

So it's here.

Run this cell and I'll run this out.

And this will just show you quickly what the chirp looks like or sorry, what the vector of instantaneous

frequencies looks like.

So it starts at five and it goes up to seventeen.

And you can see as time goes on, it gets faster and faster.

All right.

And here is what the Time series looks like.

This is the chirp.

Here is the static FFE.

And again, if I didn't show you the signal.

I just showed you this static power spectrum, you would have a difficult time figuring out what this

signal looks like now when you look at this signal and in particular this thing, it does make a lot

of sense that the static Fourier transform would look like this.

This signal spends a lot of time at relatively low frequencies and it spends less and less time at faster

frequencies because it's spinning faster and faster as time goes on.

Still, I think we can all agree that this is not the most useful way to interpret this signal in the

frequency domain.

Therefore, what we're going to do is to a time frequency analysis.

And I'm not really going to talk about this code because this is really no different.

So this is just creating the wavelet.

This is running convolution.

In fact, probably most or maybe even all of this code is directly copied from the previous video of

a time frequency plot of the lipless distribution.

So you see that the time frequency power plot looks good.

It's getting a little bit washed out over here with increasing frequency.

We can actually make this look a little bit better by changing some of the wavelet parameters to specify

this to be point five.

So basically, it's just five hundred milliseconds for with the maximum all the way through.

Oh, no, I meant to do I meant to make it wider.

Actually, maybe what I'll do is something like this.

OK, so now it looks more accurate.

It's a little bit too smooth maybe.

But that's OK.

Doesn't matter.

And now what I'm going to do is so now what we want to do is compare this time frequency plot against

the static power spectrum.

So how should we do that?

Well, one thing we can do is to consider that in the 48 transform all of the time, points are weighted

equally.

And that happens because the way that a four year transform is computed is by comparing the signal to

a bunch of Steinway's at different frequencies.

And those are pure sine waves.

So that means that the entire signal gets weighted equally.

So therefore, one way that we can compare a time frequency analysis against a static Fourier transform

is to sum all of the time points in the time frequency analysis are actually average.

So if we were just average this entire map over time, that would give us a static picture.

Right.

So that's going to give us one power spectrum.

So we have one value for each frequency that represents the average of all of these values, basically

each row in this time frequency plot.

And that is exactly what I do here.

So here I compute the power spectrum based on FFE of the chirp.

And then here what I do is take the average of the high frequency matrix and this time frequency matrix

is 40 by four thousand, which corresponds to frequencies by time.

And so here I'm taking the average over the second dimension, which is time.

So now run this cell and that plots them.

So what you can see is that taking the time, frequency analysis and averaging over time gives us something

that looks kind of like the fast 48 transform power spectrum.

However, it's quite a bit smoother, so it looks like it's less accurate and in fact, in this picture

it is less accurate.

But part of the tradeoff here, what we sacrifice, we lose a little bit in spectral precision and we

gain in temporal precision.

Now, you can actually make this look more like the results of the four year transform by modifying

these parameters here.

Some particular are going to set this back to be point five.

And I'm going to run this entire code, this entire map file.

So you can see now these look more close to each other.

They look more similar to each other.

But that means we sacrificed a little bit of accuracy over here.

Now, there's one thing that I would like to show as well, which is adding a pure sine wave, so this

is a non stationary signal.

And what I'm going to do here is add a pure sine wave on top.

So I'm saying the chirp equals itself, which is the instantaneous frequency signal.

So equals itself.

Plus a pure sine wave.

At 13 hertz and I picked 13 hertz just kind of randomly, I wanted it to be somewhere in the middle

here.

All right, so now I'm going to run this all this this whole file again.

And so now it's also interesting to see when in this picture where we directly compare them again,

the average of all the wavelet coefficients over time gives us something that is a pretty decent approximation

of the static Fourier transform.

So it's clearly a peak here and then it decays and then the peak here.

But it's a smoothed version.

So we lose some precision.

And here is also interesting to take a look at this, you get some interference patterns here and this

looks to be a little bit smaller.

And again, part of this is parameter dependent.

And as always, I strongly encourage you to play around with these different parameters.

One thing I would like to do here is increase the frequency of resolution, so increase the number of

wavelets between two and 30 hertz.

So now it said to 40, let's try extending it to 90.

And the question is whether this will become more accurate or at least closer to the fast for you transform

the static transfer.

And the answer is not really that much.

So you can see it did increase a little bit.

This got a little bit narrower.

This got a bit smoother.

But overall, the match between the time frequency analysis and the static transform is actually more

dependent on the full width at half maximum and less so on the number of of frequencies.

So, for example, now I'm going to set this up to be one both of these.

So now run this again.

And you see, this is starting to get a bit more accurate, so the amplitude is lower, but that's OK,

that's really just a scaling effect.

That's not anything super interesting.

What we are concerned with here is the shape of the distribution.

So the shape, the distribution now are looking closer.

However, getting the wavelet analysis to match the static Fourier transform analysis actually decrease

the accuracy of the time frequency plot in particular as you get to higher frequencies.

And this is now happening because you have more temporal smoothing at these higher frequencies.

So there's more smoothing of previous time points and following time points, which means that the estimated

amplitude is actually getting smaller here.

And that should make sense when you look at this frequency sliding time series as well.

So basically there are more non-state parties up here later in time and the signal is actually more

stationary here earlier in time.

So as these non stationary these increased, as the signal changes its spectral characteristics faster,

having a really long wavelet.

So one second for what?

The maximum having a really long wavelength actually means you get a less and less accurate result as

the frequencies increase.

And again, that's not necessarily because the frequencies are increasing.

It's because the non stationary is are increasing.

The signal is changing faster.

So that's just some additional detail.

The main point of this video is to express the idea that if you take the average of a time frequency

analysis over all of the time points, that will give you a function that will approximate the static

Fourier transform.

It'll be like a smoothed version of the static 48 transform.