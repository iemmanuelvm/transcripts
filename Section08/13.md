 So I initially had the idea to have the simulated data and the real data in the same video, but that video turned out to be fairly long. So I decided to cut it up into two videos. So if you haven't already, then I encourage you to first watch the previous video on instantaneous frequency in simulated time series data and then continue on with this video here. I'm going to now move into real data, so it's loaded in this data set. This is a resting state EEG data set. So this is one EEG channel recorded while the research participant was just sitting quietly for, I think, two minutes. We'll see the time vector in a minute here. I'm applying Welches method to get the 48 transformed over lots of blocks of one second. And you see very clearly the typical two character spectral characteristics of EEG data or brain time series data more generally. So you get this one over feature and you get this Narrabeen thing to pop out and this is around 10 hertz, which makes sense. This is called the Alpha Band. OK, so what we are going to do now is inspect this alpha band for time, varying fluctuations in frequency. And just by looking at this plot, it's actually very reasonable to expect that there will be time varying fluctuations in the instantaneous frequency of the signal. And that's because this is not a super narrow feature of the signal and in fact, that we do this. I think there might be some loud noise here. Yeah. So this is a noise that you can see. This is narrow. This is actually even more narrow in the real signal. It gets smoothed out a little bit by Welches method, but this is narrow relative to this. And so the width of this peak is telling us that there are some non-state narratives. So therefore, what I'm going to do is apply a filter to the data I'm going to filter using. Let's see, this is fire once I'm using an air filter through narrowband filter between eight and 12 hertz. And that's basically just based on a little bit of visual inspection of this plot and a little bit on kind of standard definitions of the alphabet and around eight to 12 hertz. And as I mentioned before, and I discuss much more of my signal processing course, it's always important to visualize the filter kernel before applying it to the data. So let's do that quickly here. You can see what the filter kind of looks like and this looks pretty reasonable to me. Here you see the gain function in the frequency domain. So this is basically just the Fourier transform of the time domain filter kernel. So you take the fifty. So let's see this time series here. This is called Filt Kurn Filter Kernel. And then I take the FFE and I extract the power from the fifty and then I plot that. And that's what you see in the black line here. The red line shows the quote unquote ideal filter. This is what we specified here. And this looks fine. You don't see any really weird things. You can see it's it's a little bit narrower. The actual filter is more narrow than the ideal filter. And this is often what happens with FIA filters. Now, in this case, that's actually a good thing for reasons I'll explain later. If you prefer to include you know, if you want to get these nodes in here a bit more, you can have this bit wider. Then you might switch to Fiorelli or you could set this to be a bit wider, you could make this, for example, seven point five to twelve point five, and that would notch this actual filter a little bit wider. And in this case, it's actually good that it's a little bit narrow. OK, so I'm convinced that this is a reasonable filter to apply to the data. So therefore I apply the filter to the data, make sure it's double precision, otherwise MATLAB is going to give us an error and then let's see, for starters, we can inspect the signal. So here in blue is the original signal and then in red is the alphabet and filtered signal. So again, more visual inspection. This looks pretty sensible, looks pretty good to me. And now basically I compute the instantaneous frequency. This is no different from what I had above with the simulated data. It's just different variables, of course. OK, so here you see this result now, you can already tell that this looks a little bit noisy. There's a bunch of these weird spikes are going down to minus two hundred and fifty hertz, whatever that means. It's not even interpretable from a signal processing perspective, but this is also not really interpretable from a neural perspective. So it doesn't really make sense for the brain to suddenly jump up to 110 hertz when it's typically around, you know, eight to 12 hertz. And so, in fact, it doesn't even also make sense from a signal processing perspective because we narrowband filtered the signal. So this is all reflecting little noise. So I would guess that some of these fluctuations are natural. These are real fluctuations that are really happening in the brain and some things like this and this and this, of course, and definitely this. These are just some artifacts from a bit of residual noise. Not to some extent. These artifacts are coming from the width of the filter. So if you would make this really wide, try getting this from like four to about 20. Now, we don't actually see the whole filter. So I don't really know if this is still a great filter, but it doesn't really matter for present purposes. Mostly, I want to show you that when this filter gets wider, we get a lot more of these filter artifacts. Is these not sorry, not filter artifacts, but noisy bursts. And if this gets narrower, let's try making this from nine to 11. I hope this is OK. Still good enough for demonstration purposes, although I think the order needs to be a little bit higher. But now you can see that we get fewer of these noise spikes. OK, so let me go back to eight to 12. We ran this rerun this. And now what I'm going to do is apply a median filter to the Supre threshold points. So what I do is convert to this frequency instantaneous frequency time series into Z score. So I subtract the mean and I divide by the standard deviation. And then here I'm plotting a histogram of what this looks like. You can see a lot of these values are clustered around zero. No surprise. But then we got a couple of these extreme values. This is really extreme. This is, you know, minus one hundred and forty standard deviations away from the distribution of the instantaneous frequencies. So here I'm just picking an arbitrary threshold of two. It's not totally arbitrary, somewhere around to a Z score of two corresponds to a probability value of around zero point zero one. So what I do is find all of the extreme points in this Time series that's going to be, of course, these points and these points, these points basically anything above a standard deviation of of two, either above or below. That's why I think the absolute value here and then I'm going to apply a median filter so based I'm going to replace those extreme time values with the median of these surrounding K time values. And here I take to be 100 milliseconds. So that's 50 milliseconds. But then it's a plus minus K and plus K, so this ends up being a one hundred milliseconds. So this is one way this is a fairly simple, straightforward way to compute a median filter on extreme data points. If you check out that paper that I highlighted in the beginning of the previous video, actually. So it's at the top of the script, basically. So if you look at this paper, I suggest a couple of other ways or a slightly more involved, sophisticated way of doing it. Median filtering to smooth out this Time series a bit. So this is a pretty straightforward, simple median filter that I'm applying here and we can see what that looks like. The black is the original frequency Instantaneous Frequency Time series, and in red, you see the filtered one. So you still see some of these dips here, but it doesn't get to these extreme values all the way down here.