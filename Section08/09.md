 Power is only one of the several features that you can extract from a time frequency analysis, it's the dominant feature. It's what most people extractives, what is often most informative about the signal. However, there's also the phrase values and those can be utilized. In particular, phase provides insight into the timing of frequency specific processing in the brain. For example, after a stimulus is present. So that's what we are going to explore in this video. Intertribal phase clustering and in particular we are going to do is compare it PC into the trial phase clustering in the original data, the raw data. And then what I'm going to do is remove the ERP from the data. So I'm going to subtract the ERP from the single trial data. And the assumption here is that the ERP reflects all of the phase locked activity in the signal. And so by removing the ERP from the single trial data, we are pulling out the phase locked component of the signal and leaving in all of the non phase locked activities. Right. So let's see how that's done. It's actually pretty straightforward. So we loop over channels and then for each channel we compute the ERP for that channel. So it's just the average over all the trials for this channel. And then we loop over all of the trials and then we say the EEG data for this channel all time points and this trial equals well itself, that this thing minus the ERP. So you can think of this as like the residual. Of the single trial data, after removing all the phase locked components, assuming that everything stays locked, ends up in the ERP, notice also that I'm putting this into a separate field in this data structure. So the original data are in data, of course. And now I'm calling this sub data, which I'm initializing here to be the same size as data. I'm separating these two because I would like to run analysis both on the original data, which is sometimes called the total signal and the subtracted data or the residual data, which is also sometimes called the nonferrous locked part of the signal. OK, and then it turns out so I wanted to write this out in a double loop like this. So it's very, very clear to you what is happening, what is the mechanism of subtracting the ERP from the single trial data? But it turns out that you can also do basically everything that this double loop is doing. You can implement in one line of code using the fun function. And if there's two things that you should know about me in general in my life, it's that I like The Color Purple. And I think Fine is a great matlab function. Those are like the only two important things to know about me. So this is given in a separate subfield. Here I call it sub data two versus sub data, and that's really just so that in case you don't believe me, if you want to prove this to yourself, you want to evaluate, test yourself whether all of these all of this line of these lines of code is really equivalent to this one function. Then you can compare sub data to to sub data and you will find that they are identical within machine rounding error, so they are going to be the same to around 10 to the minus 16 or thereabouts. OK, so let's run this. And what I want to do is show you some examples of what the signal looks like before versus after subtracting the ERP. So I'm going to say ETG that data amounts to channel thirty one and trial. How about trial also. Thirty one, because why not. So here is what a single trial of data looks like. Now what I want to do is plot on top of this EEG five times EEG that data sorry. This is now actually sub data again the same channel and the same trial. And here you see the difference. So basically anything that's different between the blue line and the orange line reflects the event related potential or the average. The trial average signal, which we can take as the phase locked part of the signal, and it's interesting to see that these two lines don't really differ much around here, they don't really differ much around here. Mostly they differ a lot around here. So in the first yeah, let's say from around 100 milliseconds to around maybe five or six hundred milliseconds here, they differ more and they also differ here. But it turns out that because these Epic's are cut so long, this is actually the stimulus period from the previous trial. So you don't need to worry about that too much. Usually we just consider the time around here. OK, so that's one example. Let's try the same trial from a different channel. Let's try to Channel 47 and here you see a similar phenomenon. So these two data sets. So the total data and the non locked data look really similar here. They look really similar here. And actually they still look really similar here in this period. It looks like just that the orange line is kind of shifted down a little bit. All right, so now I'm going to do a time frequency analysis again, this is basically all the same thing that I'm doing that I have done in many previous videos. Now, the only thing to notice that's different is now I need to get to Fourier spectrum one for the regular data and one for the subtracted data. And you'll notice also here, I'm doing it in two lines. This I introduce you to previously, for example, in the video on time, frequency, power of multiple trial EEG activity. And here I'm just running it all in one line so you can see basically all of this stuff that goes into this variable, all data. I'm putting that code directly here and then I'm just using sub data instead of data. OK, so let me run this cell. And now convolution is mostly the same. So this part of convolution is all the same. This is different from power because here we are computing the phase synchronization over all the trials at each time point. So you might recognize Euler's formula E to the I k work is the angle of the analytic signal, the complex result of wavelet convolution. And then we were averaging over trials and then taking the magnitude of that average. So this is for the full data or the total data, this is for the reduced or residual or sometimes called non phase locked data. Again, this is all the same code. And really the only thing that differs is whether we're taking it from data X sub or from data X, and I'm storing these two results in the first element or first dimension of this time frequency matrix. OK, so now let me run this code here and then we plot the results here. And so here you see the entire trial phase clustering with the AARP included. So this is with the unmoderated signal. And here's what the AARP excluded. So the nonferrous locked part of the signal. And it's important to note that the color limits of the color scaling is identical on both these plots so they can be directly, visually interpreted and compared against each other. Now, it might initially seem a bit strange if I would only describe this analysis as saying that I subtracted the IRP, that why would you get no more phase clustering across any of these frequencies just because I've subtracted the ERP. However, when I change the terminology and say that I assume that the ERP reflects all the phase locked parts of the signal and therefore by subtracting the ERP from the single trial data. We are left with just the nonferrous locked part of the signal, then it actually makes sense that if this is a phase locked signal, then there actually shouldn't be any consistency in phase values. Now, what I encourage you to do is change the code in here to make this compute the power instead of the entire trial phase coherence. And then you can make another figure that looks like this that one should go and figure to so you can, you know, go back and forth between these two figures. So that's going that other figure will show you time, frequency, power of the total signal and the non phase locked signal. And if you like, you can also apply a baseline normalization. You will almost certainly need to change the color limit. So that's something to keep in mind. And it will be interesting to compare how removing the ERP, so isolating the non-physical part of the signal affects the phase clustering versus the power.