 There are several reasons why it's useful to normalize your time, frequency power, using some baseline level of power, for example, a pre stimulus period. There are two dominant ways to normalize time frequency power. One is Debe for decibel and the other is percent change. And in this video, I want to illustrate both of these concepts to you and also show you how they differ because they generally look quite similar. You'll see an example of how they look similar, but they're not identical transformations or I should say normalizations. So first, I want to show you this in simulated data. So I'm just generating activity that goes from one to 20. And we're going to compare this against the baseline value of ten. So this means that we will have relatively negative values in the activity and relatively positive values. Here you see the formula for DuSable, so it's 10 times logarithm of 10 and then it's the activity divided by the baseline. Here you see the formula four percent change. So it's the difference of the activity divided by the baseline. And then this difference altogether is divided by the baseline. So this formula on its own like this will give you a proportion. And here you multiply it by one hundred, and that will give you percent. Now, there is something that's common between these two, which is that you take the activity and divide it by the baseline. So you can see that's very clear here in the decimal formula. And here it's still in percent change. So the activity divided by the baseline. So there is something important that's that's similar between decibel and percent change, which is dividing by the baseline. OK, so now let's just have a quick look at these already here. You see over the values of X, you know, you can pretend that this is time or space or whatever. That doesn't really matter. Here is the activity in the blue line. That's kind of like the raw power. The raw power goes from one to twenty and the decibel normalized power goes from minus 10 up to a bit of zero. So I guess that's probably around one. But you can also see that this is a nonlinear function, and that's really just reflecting the fact that we are taking the logarithm of this line. And here you can see decimal and percent change plotted against each other with some lines for reference drawn. And so minus two DB corresponds to around minus whatever. This is 38 percent. And conversely, plus two DB corresponds to an increase of fifty nine or so percent. So that's again, this non-linearity that's imposed by the logarithm. That means that positive DB values correspond to larger change in percent. This is also a sensible approach when you consider that power values tend to be or not tend to be, but they are not normally distributed. So power values, there's many small power values and then the power values tend to have a decreasing probability with increasing power value. So it's like it's much harder for a system to get a lot of positive power up here compared to a smaller amount of power. All right. So now I want to show you this for real data. So I'm going to load in this sample EEG data set, set up a the parameters for the wavelets and here do a time frequency decomposition. Now, I'm not going to talk in much detail about any of the code in this cell or in this cell. And that's because this is all code that you are quite familiar with now from the past half dozen videos or so. What is new here is doing the decibel or percent change. Normalization probably would be more accurate to call this baseline normalization. So here I'm extracting the average baseline power, so we have this variable T.F. for time frequency, so it's frequencies by time points and so I'm averaging over just some time points. And you can see I define that up here. So there's going to be minus five to minus two hundred milliseconds. So relative to stimulus onset and then here I'm averaging over the second dimension, which means I'm averaging over these time points. So that's going to give me a vector of corresponding to one power value per frequency. And if you like, you can already inspect this. Let's try a new figure. We can plot the frequencies by the baseline. And here's what that looks like. So you see there's this one over Heff and you also see that there's a peak in Alpha and this shouldn't be so much of a surprise. It's a pretty well-known phenomenon in EEG that alpha power increases during the entire trial interval. And that's what you see here. So this is the baseline power, the amount of power or energy at each frequency. Before the before each trial started. All right, so then here, recompute decibel and percent change now here I'm using this function because it's fun. So I'm doing right division. That's the function. The function is being applied on the variable T.F. And I'm using the baseline vector. Now, this function best fun will inspect the sizes of these and say this is 40 by 640. This is 40. So therefore this thing needs to be expanded six hundred and forty times in order for this operation to be valid on this matrix. So this fund is doing all of this matrix replication for you. You could also do this in a loop. You could do the baseline normalization here directly inside the for loop over frequencies during convolution. You'll see examples of that in other videos. And then here, four percent change. It gets even more complicated because I have two embedded BoSox fan functions. This is really just to make sure you're awake here. So get a cup of coffee and see if you can figure out why this is the right line of code to compute percent change accurately. OK, so I'm going to run that. And now here I plot the results. Here you see the raw power with no normalization applied. Note that these are all non-negative values, right? Power cannot be or I should say raw power cannot be negative. It can only be positive or zero in some cases. Here we have oh, these are the incorrect titles, my apologies. I sometimes I copy and paste too quickly and this is percent change power there that looks much better. So raw power decibel, normalized power and percent change normalized power. Now, it's interesting to compare these. You can see that these two plots, DB and percent change look really, really similar to each other. Non-identical. Some of the suppressions here are more prominent for a DB than four percent change. That is because of this phenomenon here. But otherwise, these look overall really similar, but these two together look quite a bit different from this raw power plot. Now, the thing about this raw power plant is that it is not baseline normalized. So here you see a lot of alpha power. But you'll remember that when we looked at the baseline activity, there was already a lot of alpha power in the baseline. So therefore, some of this alpha activity actually decreases a bit because there's also Alpha in the baseline period. And this very low frequency thing, whatever this reflects, this must be approximately the same amount of power in the stimulus baseline and here in the post stimulus window, because this feature of the signal is obliterated in these baseline normalized plots. So the last thing I want to show you is a direct comparison of raw power and these normalized powers in this actual data set. So here I'm plotting the time frequency. So this is the raw time frequency by percent change time, frequency. And that's what you see in this block. And it looks a little weird at first. It looks like it's kind of, you know, collection of these pretzel sticks that if someone dropped on the floor or something, maybe they're Twizzlers, because that would be that would be more matching with the color. OK, so it looks like someone just dropped a bag of Twizzlers. But what's actually happening is each one of these lines corresponds to a separate row in the time frequency plotts. So you can see that the raw power varies from a little bit over zero, up to around six, maybe just over six. And the percent change varies from around minus 30 to upwards of one hundred and twenty percent change relative to baseline. Now, each individual row in this plot, which means each individual frequency, has its own baseline to compare against. And again, that's what you see here. So this value of zero point six five, whatever that is, that is the baseline for 15 hertz. And there's a different baseline power for 14 hertz. And so that's why each row has a different line in this plot. OK, than here. I'm comparing percent change power versus DB power that you see here. So again, DB is on the X axis percent change is on the Y axis. Oh yeah. And I use a little bit of latent coding here just to give you a little bit more experience with integrating later coding in particular for Greek characters in Matlab plotting. OK, but you can see that this has a slightly nonlinear shape. It's a relatively restricted range compared to here. Here I went from DB of minus 10 up to around three, I guess. So this is a smaller range. So it looks less nonlinear, it looks more linear. That's also important to keep in mind that in general, nonlinear functions are always well approximated by linear functions at small intervals. And that also means that at small intervals, particularly around zero DB and percent change, are going to look really, really similar to each other.