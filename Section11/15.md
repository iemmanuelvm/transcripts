 The purpose of this video is to implement strategy to a that I introduced you to in the previous video. So remember, that strategy to A was about defining some time frequency region of interest on the time frequency plane based on the grand average time frequency power plot. So that is average at the level of the group. So across all individuals and across all experiment conditions. And then we want to extract individual numbers from each of those regions of interest, from each subject and from each condition. OK, so let's get started. We are going to import this data set called our map file called our group T.F. Data. So group time frequency data. Now, this is not a map file that we have worked with so far in this course. So therefore, it's a good idea to start with a clean workspace, load in the data and then have a look at what we have. Just load it in. We see what is contained inside that map file. So we have three variables, Frex times to save A.F. So we can already guess that Frex is a vector of frequency's times to save is a vector of time points and T.F.. By looking at this. This is clearly so. It's a four dimensional matrix. We clearly have frequency's by time over here and then it is a reasonable guess based on, you know, the goal of this video and looking at the sizes that twenty five corresponds to the number of subjects, the number of research participants and two corresponds to conditions. So we have two different experimental conditions. Twenty five subjects and sixty frequencies, one hundred and one time points. So let's see here we define some statistical parameters, but I think we don't even use these. Yeah. Let's get back to this. I think we don't even use this code here. I think we don't use these variables. Let's start by plotting. What we are plotting here is there's going to be two subplots and we can see that it is the mean T.F. variable matrix. And we are averaging well, it doesn't say which dimension we're averaging over, which means that we're using the default dimension, which is one. So we're averaging over subjects for the two experiment conditions and we're going to make a contour plot of the time frequency matrix. So let's have a look. All right, so here you see whatever condition, one in condition to mean it actually doesn't matter for present purposes, you can see that they both look qualitatively similar. So we both get, you know, for both of these conditions, there's this burst of theta here and a suppression of like beta over here. And both of these features appear to be stronger for theta. So the theta is, you know, visually at least, theta is definitely stronger in condition to compare the condition. One and I don't know, by my eye, it looks like this beta suppression is also a little bit more intense. It looks like it's more blue here compared to here. All right. So that is not a statistical determination. Of course, that is just based on qualitative inspection. So this is averaged over all the subjects. It's also good to look at these single subject data. So what we're doing here is looping over twenty five. And remember, that was the number of subjects here. And then in a five by five subplot array, we are making a contour for the second condition for so for this condition, for each individual subject. So let's see what that looks like. This is also a really important way to do visual data inspection, to look at all of these single subject data. Now, first of all, it's also just interesting to see how much variability there is across subjects. Sometimes there's a lot of variability, sometimes there isn't a lot of variability. So, for example, you can see that basically everyone shows this kind of low frequency theta increase here, maybe this. OK, I think this subject really doesn't show this low frequency increase. Everyone else does. This one's a little bit of a weird case because it looks like the theta or this low frequency increase is really low frequency and then it's a bit blue here where other subjects have red. So that's already pretty interesting. And then we can also see that there's some features in some of these data sets that seem to be replicated in some subjects, but not in other subjects. And in particular, I am looking at this thing here. So it looks like this red blob here, here, here. And this subject shows that this one, this one, this looks like a little bit of noise here, here, here. So some of these subjects are showing this looks like a beta rebound effect. So an increase in beta power after this suppression, but not all the subjects show that effect. So that's also kind of interesting. And it's also interesting to note that we definitely don't see that in the group average. But I guess it's kind of they're a little bit, but it's really weak. All right. So let us now move on to picking a time frequency region based on all conditions and all subjects. So we want to compute the grand average over basically over everything. So let's look at this time, frequency matrix again. So size of T.F. So we want to average and average T.F. And we want to average over conditions and average over subjects. And then let's run this and see. So this is still a four dimensional matrix. So we have size Grand Ave. This is four dimensions. Now we have two singleton dimensions in here. Fortunately, we only need to use one squeeze command. Be a bit annoying if we had to squeeze, squeeze, maybe a double squeeze. Let's check out the size of this thing. OK, now it is a frequency by time matrix and we make a plot. Looks like this, so this is the grand grand grand average over everything, and now based on visual inspection, we want to draw boxes around to time frequency windows. So the way that this code works is we are specifying the time range and the frequency ranges for these two prominent features of the time frequency map. And then we're going to drop boxes on top. So let's just start by drawing these boxes. OK, and then we see there's a question up here. Do these seem like good choices? Now, obviously, the answer is no. Otherwise I wouldn't have written the question. So how can we improve these? What are more appropriate time frequency windows of interest based on what we see in the plot? Now, I'm going to have I'm going to talk quite a bit about this issue in the next video on avoiding circular inference. But I think a lot of this is fairly intuitive. So let's see, how about we draw a box that goes from here? So from two eighty five. So two hundred and eighty five milliseconds to around here and that is six hundred and thirty. And then let's draw the frequency for this first region of interest to go from three up to. Seven, how about that? So I think we will need to fix our way too as well, but I'm going to first just make sure that this first one looks good. All right. This looks much better. Don't you agree? Now, there's always a little bit of ambiguity. There's always a bit of uncertainty here and arbitrariness. Why did I pick three hundred millisecond or twenty five milliseconds and why not? Over here, 270 or, you know, out here at two. Twenty five. Now, some of this is a bit of a judgment call. Some of this is admittedly a bit arbitrary and subjective. Some of this comes with experience and some of it also just comes from, you know, just a little bit of a guess. And you will probably find that when you try various regions of interest that are all reasonable, then the results end up being more or less the same, qualitatively the same. OK, so let's now fix our way, too. So I think this this time boundary at the end here to the right is fine. I would like to extend this a little bit earlier, maybe one hundred and eighty. And then the frequency ranges should be how about 15 hertz. That looks pretty good on the lower bound and the upper bound. I will set it to be maybe. Let's see what we have here. Maybe 30. Let's go up to 30. OK, so again, draw this new figure. And all right, this looks pretty good. I am quite happy with these two regions of interest. So now we have drawn these regions of interest based on condition average and subject average time frequency plot. So the interpretation is that these are two regions of interest that show a significant sorry, not significant because I didn't test this, but a robust a salient change relative to the pre stimulus baseline in this electrode, wherever this electrode comes from. So what I want to do now is create a table, a data matrix, where I have data from these two regions of interest for all subjects and for the four sorry, two conditions. So this is going to end up being a twenty five by four matrix, twenty five rows for twenty five subjects and four columns corresponding to condition one and condition two from Arawa one and condition one and condition two from Arawa two. So and that's what we do in this line, in this cell here. So first of all, I'm going to convert the time indices or of time points in milliseconds and the frequency points in Hertz into indices. So that's what we do here. And then we need to extract those data so you can see, OK, so actually I said we were going to create a 25 by four matrix. That looks like we are creating a four by twenty five matrix. So the data labels oops. And said, oh that's interesting. I don't know where we are. Hmm. Looks like this variable was created here. OK, so I just accidentally forgot to run this and I'm not sure what these three lines of code are doing here, but they don't seem to be relevant for this video. So I'm going to pretend like that was done on purpose just to confuse us. Anyway, moving along. So let's see, we have so now we can initialize the data. So we have the labels. So what we want to do is make sure. So we want to get the first row of the data to correspond to theta, which is this low frequency here from condition one. So that is the average and then average of the time frequency data from all subjects, from condition one and frequency one, frequency one time one and time one. OK, so this looks correct and I'm going to run this here just to make sure that it's really going to give us twenty five numbers. Yeah. Looks good. OK. And then I already saw something wrong here. So now I know actually this isn't wrong. This is correct. So we want the first row of these data is theta condition one. The second row is theta condition two, which actually is this. So Freck I frac one idex and time one IDEX are both for the lower frequency y, so that's correct. And then we have indexed two for the second condition. So now let's see, I'm going to copy and paste this in row three. We are going to put this is again going to be condition one. But now this is coming from the beta band. So it's that higher frequency region of interest. So this has to be two and two and two and two. OK, and then this is four. So row four is the high frequency region of interest. So that's still two and two, but it's condition two. All right. So let's run these lines of code and that looks good. And then finally, we're going to show a bar plot of the results. So here is a bar plot of the results. So we can see this looks pretty interesting here. You see the theta is the low frequency thing and here you see the high frequency activity. And so, not surprisingly, these values are positive. These values are negative. That's kind of what we saw on the time frequency plot. But it is pretty interesting to see that this theta power is much larger in addition to than in condition one, whereas the beta power seems to be the same for condition one and condition two. Now I have to make sure that I'm very clear that I'm saying seems to be the same. I am making zero statistical inferences based on the error bars. We already learned about that mistake in the past video or maybe those two videos ago. So I'm not making a claim that these are statistically significantly different purely based on the error bars. And likewise, I'm not making these you know, this actually could be a statistically significant condition difference here. I won't know without testing it. But, you know, I'm just kind of making a guess and making an inference. It seems like this could be a significant difference and this might not be OK. But anyway, that's not the point here. The point here is to illustrate to you how to create a data matrix, a data table like this based on a time frequency map. So what you could do it if you know, if this were your real from your real data analysis, you want to do group level statistical analyses. You could, for example, export these data and import them into, for example, SPSS or S.A.S. or R and run whatever is the appropriate statistical test. Maybe you want to do a two by two ANOVA if you want to also test for an interaction between theta and beta. So frequency band and condition.