So now you know about complex Morleigh wavelet convolution, you know about the Filter Helbert method

and you know about the short time F.T. Method, the question is, when should you use each of these

methods for doing time frequency analysis?

How do they compare with each other?

And is that even a useful question to ask?

So it can already guess that the answer to that final question is no, it doesn't really matter, but

we have to talk about it anyway.

So let us start by comparing Wavelet Convolution and Filter Hilbert.

So what you see in this plot are a wavelet in the time domain.

So the real part of a Morleigh wavelet and the filter kernel from an FHA band pass filter.

And you can see that they are not identical, but they are really similar.

And I've already discussed this a few videos ago when I introduced you to the FHA filter Colonel construction

procedure.

So they are quite similar to each other.

Now let's look at the amplitude spectra.

So the frequency representation of the filter colonel and the wavelet.

So here is the wavelet Ingrey.

And of course, you know that this is the wavelet, even without this LÃ©gion, because the shape of

the power spectrum of the Morleigh wavelet in the frequency domain is always a Gaussian.

And here we have the filter kernel.

So you can see again, they are not exact the same in the frequency domain, but they are quite similar.

So here's some points of comparison.

So the filter Hilbert method involves more parameters, as I discussed in the video on Filter Helbert

method.

So we had let me see if I can remember, there is the kernel construction algorithm.

There is the order.

So the number of taps, the number of time points in the kernel there is the transition zone for how

gently these slopes go down to zero gain.

And then there is the bandwidth, which is the width of this plateau up here.

Wavelets, on the other hand, have only two parameters, one of which is the frequency of the sine

wave that determines the peak of the of the wavelet, the peak frequency of the wavelet.

So that's even not really much of a parameter.

The key parameter for wavelets, of course, is the width of the Gaussian, which you can define either

as the number of cycles or as the full with that half maximum.

So there are fewer parameters.

That has two implications.

One, it means that it's easier to do the analysis using wavelet convolution.

It's a bit more tricky here.

There's more to think about.

And it also means that there are fewer opportunities for failures or accidental failures here.

It's actually surprisingly easy in Matlab or in any language or using any programming language to create

a bad filter that doesn't do nice things to your data, that's going to screw up your data and give

you terrible uninterpretable results.

So that's easier to do with Narrabeen filtering.

It's harder to screw up basically with wavelet convolution.

So these are kind of idiot proof.

Wavelet convolution is also faster because you're just doing a couple of Effie's.

It's one after the data, one fifty per frequency per wavelet frequency and one inverse of fifty per

wavelet frequency.

The filter Hilbert method is slower, in part because the filtering takes longer and in part because

the Hilbert transform itself involves several footy's so.

So this computation time is longer.

The main difference and the main reason, the main circumstance where you might want to prefer Filter

Hilbert over Wavelet Convolution is the feature of wavelike convolution of Morleigh Wavelets that they

are always Gaussians in the frequency domain.

You have no control over the shape of the wavelet.

In the frequency domain.

It's always a Gaussian in contrast with FBAR filtering and also Iaat filtering, but more so with our

filters.

You have control over the shape of the spectrum.

So let me give you one situation, an example situation where that might be useful.

Let's say you have an apriori hypothesis about gamma wideband gamma, so let's say 40 to 80 hertz.

If you are using the Filter Hilbert method, you would only need one filter that spanned forty to eighty

hertz.

And then you apply the Hilbert transform and you extract the Power Time series.

If you are using Morleigh Wavelets, it's not possible to get one wavelet to span from forty to eighty

hertz.

So instead what you would do is create a series of wavelets that.

Maybe, let's say 15 or 20 wavelets that go that peak from 40 hertz up to 80 hertz, so then you have

20 different wavelets with slightly different frequencies you would extract.

So run convolution for each wavelet separately extract the power time series and then average those

Power Times series together.

Now, not that that's like some huge ordeal that takes three days to compute, but it is, you know,

running a little bit more analysis than you need compared to the Filter Helbert method where it's just

one single filter.

You can also see in this plot an example of where Filter Hilbert might be more advantageous.

So you can see that we can create this filter to have much more frequency precision.

So this is really isolating the filter here is really isolating this band from, you know, whatever

this is, 12 to 30 hertz or something, whereas the wavelet is under-represent energy here and overrepresent

energy here.

Now, whether that is a good thing or a bad thing depends, of course, on the goals of your analysis.

But you can certainly imagine a situation where you would actually want to have maximal energy within

a specific range and minimal energy outside that range.

And if that is your goal, then you are you might be better off with the filter Hilbert method than

with wavelet convolution.

So for these reasons, I generally prefer wavelet convolution in particular for.

Well, obviously these are the two advantages over Filter Helbert, and there are definitely situations

in my case in my hands the kind of analysis that I do.

It's much more rare that I will prefer Filter Helbert, but this is just something to keep in mind.

OK, so now let me compare Morleigh Wavelet convolution with short time for eight transform and unfortunately

I don't really see any advantages for the short time for you to transform.

There are more parameters to worry about.

The computation time is slower.

I mean still based on the FFE, which itself is fast.

But here, with the short time for a transform to build up a time frequency plot like this, depending

on the parameters that you use, you might be running hundreds or thousands of fees and each individual

activity is fast.

But when you add them all up, you know, you're doing many, many Effie's.

It ends up taking a long time to do the computation, whereas Wavelet Convolution is the least number

of fees that you can get away with.

With wavelet convolution, you retain the temporal resolution of the data.

And that's because convolution retains the temporal resolution of the data.

With the short time eight transform, you typically have a lower temporal resolution.

And that's because this time window here for each individual FFE gets moved along by, let's say, one

hundred milliseconds or maybe even two hundred milliseconds.

So the temporal resolution here can be the same as the original data, but then it means you're really

doing a ton of footy's.

So in practice, the temporal resolution ends up quite a bit lower.

So you might be wondering why people use the short time for they transform instead of wavelet convolution

when wavelet convolution can give the same results, which I'll talk about on the next slide.

And it's faster and more computationally efficient and also has advantages.

The main reason is that the short time for to transform was around before it was developed, before

wavelets were developed, before the whole theory of wavelets was even discovered.

So short time for Transform is, you know, when it's used, it's it's mainly used for historical reasons

because it was the dominant method for time frequency analysis a few decades ago.

And, you know, some people just continue to implement the same procedures because that's what they

are comfortable with and that's what works.

So to be clear, there's nothing wrong with the short time for a transform.

It's a great method.

It's fine, but it's hard for me to imagine any specific advantages of the short time before you transform

over wavelet convolution.

I've never come across any.

OK, but do these three methods actually differ?

And the answer is no, they don't.

In earlier iterations of this course, I would give people an exercise.

I would give students an exercise where they would take some data, either real data or simulated data,

and they would have to produce a time frequency powerplant from Morleigh Wavelet Convolution Filter

Helbert and short time for a transform.

And you will see they discovered that given appropriate parameter selections the results are.

Nearly the same, you get almost exactly the same results from time from these three different time

frequency analysis methods, so that's easy to demonstrate to yourself.

And if you want, I encourage you to do this as an exercise.

I actually stopped giving this exercise out in teaching, mainly because it turned out to be not so

interesting.

And it takes quite a while to write all the code for doing these three different analysis methods.

I think it's better to spend that time doing more kind of practical Hands-On work that leads to more

important applications.

Anyway, several people have investigated more rigorously whether these methods are the same or different,

whether they give different or the same results.

This is one of those papers are several other papers.

So the idea of this paper was to analyze the same data using these three different methods that you

now know about.

Short time for you to transform Filter Helbert and more complex, more wavelet convolution.

So here you see some example results from this paper.

Here is the Raw Data signal.

And here you see power time courses from for so short time for a filter Helbert and Wavelet Convolution.

Now these are not exactly identical, these three different times series here, but you can see that

they are really, really, really similar.

Now, of course, they're not identical.

Any time you change the analysis, you're going to get some difference in their result.

The question isn't whether these overlap perfectly.

The question is whether you would arrive at different conclusions, whether you would say different

things about the data based on the results of these three different methods.

And in these cases, these are with three different frequencies.

The answer is clearly no.

Now, you might wonder how much this is dependent on the analysis parameters that you pick.

And the answer is that they are so that the comparability of the results from these different methods

is a little bit dependent on the analysis parameters are here, for example, you see the bandwidth.

So this is the tradeoff between temporal precision and spectral precision.

And what you're looking at here is the parameters on the X and Y axes and the color here.

The grayscale intensity is the correlation coefficient.

So this is for comparing short time FFE and Filter Hilbert and you see that, you know, when the parameters

are selected to be comparable, the correlation between the results from these two methods is basically

one, you know, a little bit less than one, but really, really high.

And even all the way out here where the parameters differ quite a bit, the correlations are still around

point nine.

So we still get really strong correlations.

So this is short time for a transfer and filter.

Hilbert, short time for a and wavelet convolution and filter Hilbert and Wavelet Convolution.

I think you're getting to see the point, which is that it doesn't really matter which method you use.

As long as you are using these methods appropriately, you are going to get basically the same results

to within some reasonable degree of tolerance.