 A more than wavelet takes to key parameters, one of those parameters is the frequency of the sine wave that you used to create the wavelet, and we've already discussed that quite a bit in this section already. And the other key parameter is the main focus of this video. That is the key parameter that defines the tradeoff between temporal precision and frequency precision. That key parameter has a few different terms that people use to refer to it. Some people call it the shape of the Gaussian or the width of the Gaussian. The full with the maximum or the number of cycles. Anyway, let's dive in and start talking about it. So here we see the formula for a complex Morleigh wavelet. So here is the sine part. So this is E to the I and then two PI F.T. And this would be the one one of the parameters for the wavelet. So the frequency of the sine wave and now previously I've shown you this as being the complex sine wave multiplied by a Gaussian, but because the Gaussian is also E to the something, then we have to terms with the same base and they are multiplying each other so we can actually just add the exponents, add the terms in the exponents, and then there's a minus sign here. So that's why it gets subtracted. OK, but anyway, here is the Gaussian part. So this is E to the minus T squared over sigma squared divided by two. And what you see here is this part. So the Gaussian written out in code. And so the idea here that I'm illustrating is that this is the key parameter sigma or what I often call s in the code. Now, this sigma is actually not the parameter itself. The key parameter is this variable n here. This is a normalization factor. So n divided by to pay for this F is the same frequency that's used for the sine wave. So this NP character here, which you can see here in the code, is often called the number of cycles. That's why it's N for a number of cycles. So this is one way to define a Morleigh Wavelet. This is one formula that you can use to express a more they wavelet. There is another way. So here you see exactly the same formula just written with slightly different notation. So the formulation is slightly different, but it's the same thing. And here is an alternative formula for computing. The more they wavelet so you can see the same part is exactly the same. We saw E to the A two pi after. You don't know why the two in the eye are swapped here, but that's OK. And then we have E to the minus four times the natural log of two times T squared divided by H squared and this H squared here, this parameter H. This is not a formula for something else. This is directly specifying the full length and half maximum. Now you've already seen both of these formulas in the in previous videos in the Matlab code, I discuss and justify and motivate this formula more in this paper, which you can actually download in the resources section of this video. In case you curious to read this paper. It's a little bit technical, but I tried to make it still pretty readable. So this is not a fundamentally different way of writing this equation. This is just expressing that Gaussian in a slightly different way that I believe makes it a bit easier to work with. And that's because I think it's easier to think about Morleigh Wavelets and Gaussians in terms of full that have maximum and not in terms of the the number of cycles parameter. Now, in this course, I go back and forth between these two formulations, so sometimes I will express more they wavelets using this formulation and sometimes I express them using this formulation. The thing is, although I find this to be a more natural way to think about wavelets, it has been standard now for like two decades in this literature to use this formula. So therefore, I think it's important for you to be familiar with both of these methods. And again, it's not that this one is wrong. I think this one is just a little bit easier to think about. It's a little bit more natural. OK, anyway, that point doesn't really matter. I just wanted to explicitly show both of these two different formulations. OK, so what I actually want to talk about in this lecture is this parameter NP here, the number of cycles, which is the same thing as this parameter H or the full with that half maximum. So here what you are looking at is the Gaussian in the time domain. So these are time domain Gaussians and these. I have different and parameters, so the number of cycles is two here, the number of cycles is six, eight and 15. So you can see this is pretty intuitive as the number of cycles, parameter increases, the Gaussian gets wider. So what are the implications of this parameter for the Morleigh wavelet? Well, to understand that, we can just plot the more they wavelet underneath. So what you see in the dark blue is still that the Gaussian that multiplies the sine wave. And in Si√¢n, in this greenish color, you can see the resulting Morleigh wavelet, the real part of the Mallee wavelet. So you can see why it's called the number of cycles parameter. So here there's, you know, two cycles. There's like one cycle here that's pretty clear. And then there's like two 1/2 cycles before it tapers really, really close to zero. And here we can count. So there's one, two, three, four, five kind of big cycles here. And then this little guy here is going to be half a cycle. And this little guy here is going to be half. So there's around six cycles that fits nicely under this Gaussian. So that's where this that's where this terminology comes from a number of cycles. OK, so what is going on here? What's going on here is that with an increasing number of cycles, the Gaussian is getting wider. The wavelet energy is wider in time. And what is the implication of that? Well, let's think about convolution. Let's think about convolution in the time domain. So a sliding time series of DOT products, when you convolve this wavelet with some EEG data, then you can see that there's going to be a lot of data that's just being multiplied by zero. And there's a relatively constrained window of time where the data are or where the there's non-zero energy in the wavelet to multiply with the data. So that actually means that the temporal precision of this wavelet is really high. You're going to have a lot of confidence in the localization of your frequency, specific features to a specific time point. Now, let's try that with this 15 cycle wavelet. And here you see the energy spans in this wavelet, the non-zero energy spans, let's say, a period of two seconds. So let's say it goes from minus one second, up to one second. So when you convolve this with the EEG signal, the result of convolution at this time point here will be an estimate that is influenced by what's happening a second in the past and a second in the future and a second in the brain is actually a pretty long period of time. A lot can happen in one second in the brain. A lot of really interesting dynamics, all sorts of non stationary things and things like that. So here we are smudging together a lot of potentially different things happening over time. One thing to keep in mind here is that a 15 cycle wavelet will have non-zero energy over a period of two seconds only at this frequency, so that the time window of non-zero energy for the wavelet is actually a function of the number of cycles and also the frequency. So 15 cycles at a higher frequency is actually much narrower in time. That's part of the reason why I prefer this formulation over this formulation. But anyway, so now when you look at these plots and when you hear me explain this, you're probably thinking, well, OK, so we should always use to cycle wavelets. We always have good temporal precision. Isn't it great to have as high temporal precision in this high frequency analysis as possible? We want to localize things in time. OK, but unfortunately, it's not that simple. And this is where we get to the trade off between temporal precision and spectral precision. And I'm going to show you this in a moment on the next slide. But we can already start thinking about this here. So let's think about the non stationary cities in this signal, in this wavelet versus the non stationary cities in this wavelet. So you can see that the non stationary cities are more severe. We have more like much stronger rapid changes in amplitude in this signal and more gradual changes in amplitude in this signal. So that means that in the frequency domain, this is actually going to need the foyer transform rokaya energy at other frequencies in order to represent this signal, whereas here the Fourier transform will require energy at less frequencies. OK, so let me show you what that looks like. So here again, you are looking at Gaussians in the time domain. So these are the same Gaussians that I showed in the previous side. So this is the time domain. These are the Gaussians that multiply the sine wave to create the wavelet. OK, and. Now, what I'm going to show you here in this column is more Galicians, but this is now in the frequency domain. So what I did to create these plots is use these Gaussians to create a Morleigh wavelet in the time domain and then take the 48 transform of those wavelets and look at the amplitude spectrum. And that's what you're looking at here. So these are the Gaussians that create the wavelets. These are the power spectrums of the wavelets. So this is in the frequency domain. And now what you see is they do exactly the opposite thing. So here we have a Gaussian that is really narrow in time, but it's frequency representation is really wide. So you can see this wavelet peaks at around. I guess this is six or seven hertz somewhere around here and even all the way at DC. This still has non-zero energy at DC. So that means in the signal we are also, even though we're trying to estimate activity at six hertz, we are still actually influenced by the DC component by an average offset. You can also see that DC here. So you can imagine taking the average over this green signal here. And you can see there's still going to be some non-zero energy. So formally, this wouldn't even classify as a wavelet. OK, but so but otherwise, the point is you can see that also going all the way up to like 12 and 13 hertz. There's attenuation here. But your estimate of activity at six hertz is going to be influenced by something that's happening all the way up here at 13, 14 hertz, in contrast. So we have this really wide wavelet in the time domain, then the frequency spectrum. So the amplitude spectrum is really narrow. So we are getting a very precise estimate of what's happening at six hertz with very little influence of what's happening at neighboring frequencies, certainly distant frequencies. So if I didn't show you this time domain signal and I only showed you this frequency domain signal, then you would say, hey, we should just use 15 cycle wavelets all the time or maybe even 20 cycle wavelets, why don't we just have lots and lots and lots of cycles and then we get really precise frequency information. OK, so here you see the trade off. The more temporally precise you want to be, the less frequency specific the analysis ends up being. In contrast, if you want more frequency precision, you want to have a better, cleaner, more accurate estimate of the activity at a particular frequency. You have to be willing to sacrifice some temporal precision. You have to be willing to use a wider wavelet in the time domain. OK, so now you see this is the fundamental tradeoff between temporal precision and spectral precision. And it's all controlled by this one parameter, either the number of cycles which I'm illustrating here or the full with that half maximum using the other Gaussian formulation, which is actually exactly the same thing. It's just parameter using the formula in a different way. OK, so what are the implications of this parameter for data? What you are looking at here is exactly the same EEG data, wavelets with exactly the same frequency. So everything is the same. The color scaling is the same, the frequencies are all the same. The only thing that differed between these two plots is that I hear I used wavelets with three cycles here. I use wavelets with ten cycles. And by the way, these are the number of cycles. Doesn't have to be an integer. I'm so far illustrating always using integer number of cycles. But that's, you know, you can use ten point one cycles. So it's initially quite striking that you get seemingly different results from these two sets of analyses, even though almost everything is identical between these two analyses. So now when I teach this in person, I always ask the question which one is right and which one is wrong, which is the right analysis parameter and which is the wrong analysis parameter. And of course, the answer ends up being that neither one is right, neither one is wrong. They simply highlight different features of the data. So this analysis is highlighting the temporal features of the data and this analysis is highlighting the spectral features of the data. So, for example, we can go through lots of examples and I'll point out two, and then I encourage you to pause the video and continue meditating on the difference between these two plots and what you can interpret from these two plots. So one example is this theta feature here and in this plot with the small number of wavelet cycles, you can see that there's actually two discrete bursts. So there's like a quick burst of theta here and a quick burst of theta. Here and in this plot, you don't actually see that it's just all smeared out over time. On the other hand, here in this plot, you see that there's definitely two distinct frequency dynamics. So there's theta and then there's a gap and then there's Alpha here. So this is clearly different spectral features happening here versus here and here. It's not so clear. Certainly not here, maybe here. You know, this corresponds to this. So here you do kind of get the sense that this alpha burst is something separate, but you don't see that there's another that there's clean separation between Theta and Alpha here, which is pretty obvious from looking at this plot. And we could go through there's a bunch of other features that we could discuss that differ between this plot and this plot. So how do you know which parameters to use? Well, fortunately, what most people do or what many people in the field do is have a variable number of cycles. So this trade off, this balance between temporal precision and spectral precision generally changes or you can allow it to change as a function of frequency. So here each frequency in this time frequency plot has its own number of cycles and it generally starts off with a low number of cycles. So in this particular case, three, and it moves up to a high number of cycles, in this particular case, 10. And I think you can see that this plot has a nice trade off between what you see here and what you see here. And in fact, at lower frequencies, this plot looks more like the first one. And as you get to higher frequencies, it looks more like the second one here in Panel B. OK, so this is a fairly typical way to change the number of cycles with increasing frequency. There's still a question and an interesting discussion to be had about how exactly you select these parameters and how do you know if you've gotten the right parameters. Now, that's a great question and it's a really important question. Unfortunately, it's not a question that I can give a clear answer to, because the answer is basically it depends. If you are focusing more on temporal precision, then better to go for a fewer so fewer cycles. And if you're focusing more on spectral precision frequency precision, then better to go for more cycles. And you just have to be cognizant of the fact that when you are optimizing for one type of one domain time domain or frequency domain, you are necessarily causing some sacrifices in the other domain. So I hope that's clear. And it's also, of course, possible to run through your analyses twice, once using a low number of cycles and once using a high number of cycles. Or of course, the corresponding difference is in the full with graph maximum parameter. Anyway, the point of this video was to introduce you to and discuss this key wavelet parameter. And I hope you found that interesting and informative. This key parameter also has implications for the assumption of stationary of wavelet convolution and that I'm going to discuss very soon in the next video. 
