 This video follows up from the previous video. Now I'm going to be talking more about trial phase clustering or sometimes in the literature is also called ITK for inter trial clustering or into trial coherence. And I will be talking about how to interpret these results and importantly, the robustness of inter trial phase clustering results to temporal Gita's and to the number of trials or the number of data points. So here's just a quick reminder of what it means, what phase clustering means in terms of the length of the average vector and the distribution on the polar plane. So here you see some unit circles here in black and each gray line corresponds to a unit vector. So a vector with length one where the angle is defined by the phase angle time series from a single time point over different trials. So let's say there was a hundred trials, one hundred trials, and from each trial at two hundred milliseconds, you get a phase angle resulting from complex Marlay Wavelet convolution. And for 100 different trials you generate one hundred different vectors. Each vector has length one and a phase angle defined by the phase angle from each individual trial. So what you see here is that at two hundred milliseconds these phase angles are generally pointed in this distribution. Not every angle is pointed over here. Of course, there's quite some dispersion, there's quite some variability. But you can see that there's definitely strong clustering in this region. And so the average length or the length of the average vector is point six. So if you would draw the average of all of these vectors, I'm sure it would point somewhere in this direction and the length would be point six, which is just over halfway. So it might be somewhere around here. And what you're looking at here is a histogram of the phases. So this is actually a slightly awkward way of looking at a phase angle distribution, because the this this, you know, the left side of the histogram actually wraps around to the right side of the histogram because this is really circular nonetheless. The reason why I show this distribution and also this histogram is so you can appreciate that the null hypothesis here, if there is no clustering, the null hypothesis would correspond to uniformly distributed phase angles here, which would mean a flat distribution down here. And that's kind of what you see over here. So this is actually the same channel, the same frequency, all the same trials, the same data set. It's just from a time point later on. So this is that two hundred milliseconds. This is 800 milliseconds. And you can see that there is almost a perfect uniform distribution of these phase angles. And the length of the average vector is zero point zero nine seven point one. And you know, if you had to guess where would be the average vector? I wouldn't even know. I guess maybe it would be in this direction somewhere, but it would be pretty short. That factor would be pretty small. So this is the ITC at one time point at one frequency, and this is at the same frequency, a different time point. Now, as you might imagine, we can build up an entire time frequency plot of these phase clustering values, and that might look something like this for one particular channel. So here you see time and frequency and the colors here don't correspond to power, as we've been looking at before, but instead the phase clustering. So it's pretty interesting, you see that there's really strong phase clustering from, you know, around zero. So stimulus onset to really just around two hundred milliseconds and is kind of broadband. It spans multiple canonical frequencies, including a bit of theta. A lot of alpha. A bit of upper alpha, even getting into the beta range. Maybe there's even some high beta or low gamma up here, but you can see that it spreads across multiple frequencies. But it's also very brief in time. It's very transient. It's done by, you know, even this little thing. An alpha here tapers off by around three to four hundred milliseconds. So if you remember from the very beginning of this course, I talked about how to interpret features on a time frequency plot. And so in general, we interpret features as reflecting neural oscillations or evidence for neural oscillations if they are narrowband. So if they are confined to a canonical frequency band and the canonical frequency bands are Delta, Theta, Alpha, low, beta, high, beta, gamma, you know, these kinds of frequency ranges. So here we see a feature of the time frequency plane that spans multiple frequency ranges and it's also very brief in time. So I would say that this is not. Reflecting a neural oscillation, this does not reflect a narrow band oscillatory event. In fact, this is often what you see qualitatively. This is typically what you see for it in real data, when you time lock the data to a stimulus onset or an auditory stimulus or some kind of external event. And essentially, this reflects the event related potential in the frequency domain. And later on in this section, I'm going to start talking about the phase locked, the non phase locked and total parts of the signal. And you will see how this is related to the phase locked part of the signal and not the non locked part of the signal. OK, so now let me tell you a little bit more about how to interpret its results. So here I have some simulated data. And what I've done in these two cases is simulated some background oscillations that you see here. These are non phase locked background oscillations. And then what I've done here at time zero is imagine that there is a stimulus on set. So something is being presented on the screen, for example. And here we have two different cases of what can happen in this case. What I've done is simulate both a power increase and also a phase reset. So the phase values here in this ongoing rhythm are totally random. And then here we get the same phase value. So whatever the stimulus is doing, it is realigning the ongoing neural activity recorded by this electrode. Again, this is simulated data. This is not real measured data. So here we have both a power increase and a phase reset, so the phase values are all suddenly aligning to one particular value. And here we have a slightly different story. There is no phase reset. The phases are still ongoing. And all that's happening here is an increase in power. So the the power, the the energy in this system is transiently increasing and then decreasing. But the phases are not being realigned on each stimulus repetition. So what does the ERP look like and what does the time, frequency power look like from these two trials? So here you see what the ERP looks like from this trial. So it's flat early and it's flat late because these are all random phase values and then you only see the ERP in the middle. Now, here we have purely non phase locked activity, so the average over trials is just going to be a flat line. So this is actually the ERP from this data set. Now, the time frequency power, on the other hand, looks a bit different. So here we see ongoing activity, plus a burst of increased power here. So here you see the ongoing activity and this burst of power here and here. You also see the ongoing activity and the burst of power here. So in both of these cases, the time frequency power actually has you know, these are not exactly identical to each other, but you can see that there are a lot of qualitative similarities. So there's ongoing power and an increase in power in this time window in both of these cases. So the ITC is going to help us distinguish between this situation and this situation, because you can see if you're just looking at the time frequency power plots without looking at the ERP, without looking at the ITC, what you would see is that, well, basically would be difficult to know which of these two cases is happening in the time domain just based on looking at this time, frequency power. So I haven't plotted the ITC here, but the ITC, which is essentially a big result here, is a concentration of phase clustering here and zeros everywhere else similar to the ERP, and it would show all zeros here. So in fact the ITC and the ERP are very closely related to each other. They're not exactly the same. And I will talk more in a later video about why they are not exactly the same, but they are very closely related to each other. There's a few more things I would like to say about it and Fais values in general. So any time you're looking at some analysis with phase clustering, whether it's ITC or phase synchronization, so phase based connectivity, which I'll talk about in the next section, these phase value based analyses are sensitive to trial count. So what I've done here is analyze the same data set with one hundred ninety one trials and a subsample, a random sample of 20 trials out of this population of one hundred and ninety one. And what you see is that the sample of 20 trials is generally higher. It's higher almost everywhere. I mean, there's a couple of points where it happens to be lower, but in general, the smaller number of trials leads to a higher phase clustering value. And you also see that plot that shown here. So what I've done here is basically take some window of time here. I forget exactly which. Oh, it says minus five hundred plus thousand. So it's actually the average ETPs in this window here. And then I did this sub sampling from a bunch of different trials. So you can see that there's this general decay. It's not a perfect, mathematically defined decrease. But in general, as you increase the number of trials, the ITC, the phase clustering value, the length of the average vector is going to decrease. One of the main reasons for that is that it is a strictly non-negative quantity. So it cannot be negative. In theory, it can be zero, but in general it's not going to be zero. It's going to have some positive value. So if you add some noise or if you're sub sampling, you know, you have some sampling variability in there, then that's only going to inflate the results. It's not really going to deflate the results towards zero. It's going to inflate the results positively. And you can also see that this function tapers off with more trials. So what does this mean practically? This actually is important to keep in mind when doing analyses of any kind of phase clustering based method. What it means is that if you are comparing conditions with a different number of trials, then you have to be mindful that a big difference of trials between conditions can. Lead to a spurious or an art of factual difference in it. Now, how much the trials can differ depends a bit. If you have one condition with 100 trials and one condition with 200 trials. That's not something I would be really, really immediately concerned about, because already 100 is a relatively large number for computing phase clustering. However, if you are comparing two different conditions and one of those conditions has only 20 trials and the other condition has 200 trials, that is a pretty serious concern. It is likely that your condition with 20 trials is going to have higher ETPs than the condition with 200 trials simply because of noise and low sampling count. So that is something you need to be concerned about. The second thing I would like to point out about it is that it can be very sensitive to mild temporal jitters. So what you are looking at here is peak and power. Interestingly, these come from exactly the same electrode. So this is the same data. These are the power dynamics. These are the phase dynamics. So you can already see that power and phase tend to behave very differently. They don't look similar at all. OK, and then what I've done in this experiment is simulate some uncertainty in the refresh rate of the monitor or not the uncertainty in the refresh rate, but the uncertainty in drawing the stimulus to the monitor. So imagine you have a 60 Hertz monitor. And, of course, you know, nowadays people use higher refresh rates. But imagine you have a 60 Hertz monitor and you programmed an experiment where you show a visual stimulus, but you're not having a good control over the hardware. So there's some uncertainty about whether the refresh, whether the screen was actually drawn at this refresh or the previous one or the following one. So that's introducing a temporal jitter of only around 30 milliseconds. So what I'm simulating is jitter jittering the stimulus onset by around 30 milliseconds randomly across different trials. And you can see that the power results are basically not at all different. There are some subtle differences. If you look carefully, you'll see that there are some subtle differences. But the overall features of the time frequency power plots are robust to this little little amount of temporal jitter. However, the ITC is almost completely obliterated. This higher frequency stuff is completely obliterated and its lower frequency. You know, this kind of theta thing here that is relatively well preserved, although it is attenuated. So it sort of fades. Values are exquisitely sensitive to the exact timing. So this also means if you are looking for its results, if you are designing your experiment with the goal in mind of doing phase based analyses, then you have to make sure that you are really confident about all of the millisecond precision timing in your experiment design and the way that your experiment code is interacting with the computer hardware. OK, so that's all I want to say for now about inter trial phase clustering. After having a look at this in Matlab, I'm going to get back to Morleigh Wavelets and I will start talking about the key parameter of Morleigh Wavelets, which defines the trade off between temporal precision and spectral precision. 
