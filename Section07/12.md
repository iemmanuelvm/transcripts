 You now know how to perform wavelike convolution with one single trial, what I'm going to do now is show you how to use this super trial concatenation track that I showed you in the slides a few videos ago. Running the code for this video assumes that you have already run the code from the previous video, in particular, importing the data and creating the wavelet. You can see I'm referring to the wavelet already in here, the complex Morleigh wavelet. So if you have a fresh Matlab session, then you might need to go back to the previous video to run some of that code. All right. So let's see. We are going to now we're going to extract more data. So before we were just getting the data from one trial and now we're getting the data from all two hundred trials. So we have a matrix of data. And here is where I reshaped the data to be one dimensional. So reshape. And then the first input is the data that we want to reshape and then the size that we want to reshape it to. So I want it to be a one by empty vector. So when you have one by empty, that's basically telling Matlab to say one by however many points it ends up being, not, if you like. You could also say, uh, so you could say like pride of size data. So this is going to extract the size of the data and then prod is the product function. So that's going to multiply those two numbers, multiply those two numbers together. So it's going to end up being a three hundred thousand point long vector. So you can specify all that. That's totally fine. Or you just said it to be empty and Matlab will figure out what the right size has to be. You can see it's the same size, OK? And just as a matter of principle, although I don't think it matters for accuracy in this case, but I'm going to convert these data to double precision because it's generally a good idea to do signal processing and multivariate analysis with double precision data. OK, so now for convolution, this is basically all code you've seen before, but you have to keep in mind that the length of the data is now longer. This is not fifteen, twenty seven, which is what it was in the previous several videos, because we don't just have a time series of vector, we have a time by trial series of vector. By the way, I'm curious to see what this thing looks like. So data are Rs4 reshape and now I guess it's probably not going to be possible to zoom in and detect where we have the transitions between trials. I don't think that would be possible just by visual inspection. OK, anyway, so the end of convolution now is a bit over three hundred thousand time point. So there's going to be a much longer convolution result compared to what we've had before. OK, but otherwise this stuff is all the same really. So we take the spectrum of the data, the spectrum of the kernel. Now it's much longer of course, but it's really no different. Normalize the wavelet in the frequency domain, multiply the spectra and take the inverse for a transform to get back to the time domain. And of course, this is a complex result. This is a complex result because this is an asymmetric Fourier spectrum. So this is a symmetric amplitude spectrum because the data are real valued. But this is a non symmetric this is an asymmetric Fourier spectrum because it's the spectrum of a complex valued result. OK, so let's see. So then so right. So we take the inverse for a transform and now you have to be careful about cutting off the wings because we ran convolution on this reshaped time series. So this really long vector of time by trials. So that means the wings are actually not on the individual trials themselves. Only the first trial and the last trial have the wings of convolution attached to them. So we have to cut off the wings of convolution first and only then can we reshape back to the size of the data. So now we get a two dimensional result of convolution. So now we do a little bit of plotting and let's see. So this shows the broadband signals. So this is the just the raw data that I extracted. So here you see time. Now, this is not frequency, this is trials. And the color here corresponds to the microbial value. So this is all the single trial data. And you can see basically like what is consistent in the ERP. So you see there's time zero. There's a initial response here and then. There's also the strong response to the phase reversal in the visual stimulus, and it's also pretty neat. You can see the gammer here in individual trials. Also kind of interesting to see that there's something looks like something strange going on here where the response to this visual stimulus is relatively weak. I don't know what is causing that. It might just be random variability, but interesting to look at single trial data. OK, so now here I'm going to make an image of the amplitude spectrum. And this is even more striking. You really see at this frequency at forty five hertz, we see a lot of consistency over trials except for this period here where there's clearly a response to the visual system. This one was clearly responding to the visual stimulus here, but not at forty five hertz for whatever reason. Now, if I saw this in my data, while these are my data, but if I was really analyzing data for real, I would probably look back in the experiment logs or if this was a behavioral task, you might want to look at the behavior to see if there's some way to account for why there is this missing data. Now, in this particular case, in this experiment, this was an anesthetized mouse. So there was nothing particularly happening in terms of a cognitive or behavioral event. So I think we can just chalk this up to random variability, unexplained variability, totally fine. This is the reason why or part of the reason why you record data from lots and lots of trials. So we're having a lot of data allows you to basically ignore, you know, some strange data events or unusual or non representative data events without having to get into this really sticky, hairy issue of artificially selecting data, you know, like looking at the data and then throwing out data because you don't like how it looks, that gets to be very ethically questionable anyway. So then the idea is we can now average over trials. So I'm just going to show you what that looks like quickly. So plot time back by. So here we have the the magnitude of the confreres to D and now this is the amplitude response from all two hundred trials. And if we want to see how consistent this is over trials, then we can take the mean and we want to average over the second dimension because that's the two hundred trials. So that looks like this. This is the amplitude response and if you want to look at the power then you can square it. And here you see the time frequency power averaged over 200 trials at forty five hertz. So now this is one line. This gives us one frequency. What we are going to do in the next video is basically repeat this procedure for lots and lots of different frequencies, and that's going to allow us to build up a full time frequency plot. I'm super excited. It's the first full time frequency plot in this course, and I hope you are as or even more excited than I am. See you soon.