 You are now ready to learn about complex Morleigh wavelet convolution, you will see that it's essentially just a combination of things that you've already learned about. So we get the more they wavelets and we get convolution and we get complex values. And extracting information from complex wavelet coefficients is essentially the same thing as what you learned with extracting information from Fourier coefficients. So let's begin here's a quick reminder of the different kinds of information that we want to extract from narrowband signals. So we want to extract the Narrabeen filtered signal itself. So this is just, you know, like the the filtered version of the real broadband signal. And then we have the Amplitude Time series, which is like this envelope that's resting on top of all of these faster wiggles from the narrowband signal. And of course, you could square the Amplitude Time series to give you the power time series. And similar to the distinction between power and amplitude for the four year coefficient, when you are doing time frequency analysis, the difference between the Amplitude Time series and the Power Time series is that the Power Time series will highlight the most salient features in the Time series signal at that frequency, whereas the Amplitude Time series will highlight the more kind of subtle features of the Time series. And then we get the phase angle time series, which tells you about the exact timing of this particular rhythm at this frequency. So in this narrowband signal, I haven't really yet talked about phase. I'm going to start talking about phase and what to do with phase in a few videos from now. And this is also going to come back up when I talk about connectivity, because one of the dominant measures for measuring brain connectivity is phase synchronization. So these phase angle time series will actually become fairly important throughout the course. All right. So you already learned about Mallie Wavelets. And I have mentioned before that, in fact, we will be using complex valued Morleigh wavelets, not real value to Morleigh Wavelets. So a complex valued more lay wavelet, just like a complex valued sine wave has two parts. It has the real part and it has the imaginary part. And the real part corresponds to a cosine and the imaginary part corresponds to a sign. And when you look at them like this, it looks like the imaginary part is like a little bit wobbly. And the real part or the cosine part looks more like firm ground. It it looks more steady. Now, this is one way of viewing a complex more wavelet. You also saw with the complex sine wave that a good way to think about or to represent a complex sine wave visually is in a three dimensional space where you have the time axis, the real axis and the imaginary axis. So we have the same thing here and the middle. So here there's going to be a space in the middle where the complex Morleigh Wavelet will look a lot like a complex sine wave. But of course it tapers down to zero as you get to negative time and positive time. So what changes when we use a complex valued Morleigh wavelet instead of a real valued Morleigh wavelet? It turns out that not a whole lot changes in terms of the implementation. So Convolution is exactly the same with a real valued wavelet and with a complex valued wavelet, you're still taking a sliding time series of DOT products. Except now here is the key difference, because this kernel is complex valued. The DOT product between the signal and the kernel is going to be a complex number. It's not just a regular, real valued number. It's a complex number. It has a real part and it has an imaginary part. By the way, you can also notice that I'm fluidly going back and forth between thinking about and talking about convolution in the time domain and implementing convolution through frequency domain multiplications. So this is another reason why it's important to have a good grasp of convolution in both the time domain and how it gets implemented in the frequency domain. Some concepts are easier to understand in the time domain and other concepts are easier to understand in the frequency domain. All right. Anyway, so we get this complex result of the DOT product here. So we have in fact an entire time series of complex value numbers. So the result of convolution is a complex time series. So what do we do with that? Well, we take the complex number, the complex DOT product at each time point. Which is now called a wavelet coefficient, just like how in the 48 transform, we call these things Fourier coefficients here we call these wavelet coefficients, but it's just a fancy term. The concept is really simple. This is just the DOT product between a segment of the data and the kernel, which in this case is the complex wavelet. And then when we represent or think about this wavelet coefficient as being a complex number, representable through Euler's notation with Euler's formula, then we can extract the distance away from the origin. So the length of this line and we call that the amplitude. And then the angle here with respect to the positive real axis is called the phase. And this is exactly how we get the Amplitude Time series and the phase angle time series from Wavelet convolution, because the thing is that at each time point this little dot is going to be moving around the circle. So this is the wavelet coefficient at this time point. And at the next time, BOYENS, it's going to be somewhere over here. Maybe this line will be a little bit shorter, maybe it will be a little bit longer. But over time, this dot, this dot product is wavelet coefficient is moving around and around the circle. And as it moves around this circle, the closer it gets to the origin, the closer it gets to zero, the smaller the magnitude. The DOT product, which means the smaller the amplitude, which means the less the signal looks like the kernel at that time point at that time, you know, time window where the time point corresponds to the center of the kernel. And when this DOT product is wavelet coefficient gets further away from the origin, its all the way out here. Then that means that the amplitude is going to be really large. The distance away from the origin is really large and that means that the signal looks a lot like the kernel. And then just like with the Fourier transform, you can see that we have a decoupling of the phase which tells us about the timing. So the position along this circle and the amplitude so we can have phase values or amplitude values that are small and amplitude values that are large. And that doesn't really affect the phase. Of course, we also have to keep in mind this issue of uncertainty that I discussed in the section on the foyer transform. So when the amplitude is small, we have greater uncertainty about the exact face value. And when the amplitude is large, we have less uncertainty or I should say more certainty about the face value. OK, so then the whole procedure for complex wavelet convolution look something like this. So we start with our signal and our complex Morleigh wavelet and we convolve the two. This is often used to as a symbol to indicate convolution and at each time point that gives us a complex wavelet coefficient which is going to look something like this on this complex plane. And from here, we extract three features of this signal that end up being used to create a time frequency plot. So here I have a time frequency power plot, a time frequency phase plot. And here is the narrowband filtered signal time series. So we take at each time point the length of this line. So the distance from the origin, that's the amplitude. It's pretty common, certainly in neuroscience to square this and get power. And that becomes the value in the time frequency plot at the time point corresponding to the center of the wavelet where it's aligned with the data and the frequency corresponding to the frequency of this sine wave that creates the wavelet and this particular value. This is one pixel in this whole time frequency powerplant. The value at this one pixel is the distance away from the origin. And then of course, we're going to color that. So, you know, darker, hotter colors are going to correspond to larger power. Cooler colors are going to correspond to lower power, same deal for phase. So here we have the time point corresponding to the center of the wavelet where it's aligned with the data, the frequency corresponding to the frequency of the sine wave that creates this wavelet. And now the value at this pixel becomes this phase angle here. And over time, as this wavelet slides across the signal, this is going to be moving around. So this phase angle will also spin around. OK, and then finally, we can take the projection onto the real axis and that becomes our Narrabeen filtered signal. And if this result is suitably normalized, then this y axis, which is actually the x axis here, the real axis is voltage or whatever the original units of the data were. Now we can also think of. About this, as this is moving through time, this projection onto the real axis is going to be positive, it's going to go to zero and then negative and then it's going to go back to zero. As this thing spins around here, the projection onto the real axis will go back to zero and then positive again and so on. As this spins around the polar circle, around this complex space, the projection onto the real axis goes from right to left and each time it crosses through zero. And now when you change this real axis to be this y axis, then you can see that this is going to give us a signal that goes up and down. And that's related to the phase. It's, well, a combination of the phase and the amplitude of this signal. Now, when I was introducing the Fourier Transform, I explained that this was actually like a and this is a real limitation and why we needed to use complex valued sine waves for the Fourier transform so that our results are power results would be independent of the phase relationship between the sine wave and the signal. So now we have the same concept. If we would use only real valued Morleigh Wavelets and not complex valued Morleigh Wavelets, we would be able to get this narrowband filtered signal. But we wouldn't be able to get power or phase because we would have this phase relationship, this coupling between phase and power. So once you've done this procedure and extracted these, for example, these magnitudes, these length or power values, the Power Time series for all of the time point that this frequency, then you essentially go back and you repeat this procedure using a wavelet with a different frequency. So use a wavelet with a slightly faster frequency. You repeat this procedure, all this convolution business, and then that gives you the next line. So you can see in this time frequency plot or with complex Morleigh wavelike convolution, we are building up this time frequency power powerplant, one frequency at a time and at each time point our start. Each frequency we follow the same procedure of convolution and all we do is just repeat that for a range of frequencies. All right. So I hope you found this video informative and instructive. And I hope you also appreciate that time. Frequency analysis is not so difficult. It's not so mysterious. You already know everything that you need to know. It's really just complex numbers. The DOT product Fourier transform and working with complex numbers like this.