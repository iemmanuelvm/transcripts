In this video, we are going to use some pretty simple simulations, data simulations to explore the

phase lag index.

As I mentioned in the previous video, I am focusing here on the phase like index, mainly because it's

the simplest, most straightforward one to to understand conceptually and also to implement in code.

There are several other phase lag based measures of synchronization like the WPA, like the WPA, imaginary

coherence.

And so, yeah, there's several other of these things.

And I just want to make it clear that I'm not specifically endorsing the play over any of these other

measures, but I'm just, you know, it's mainly for like educational purposes that I'm focusing on.

This one specific member of this family of synchronization measures.

OK, so what are we going to do here?

What we are going to do is generate a bunch of phase angles.

These are simulating phase angle differences, but we're just going to create the phase angles themselves.

So we're going to create a population of two hundred.

And this is going to be the proportion of the circle that we fill with these vectors.

And this is going to be the center of the phase of the distribution.

OK, and then that is implemented here, linearly spaced numbers.

And then essentially I'm taking the center phase minus the proportion of fill and then the center phase

plus the proportion to fill.

This is actually a bit of a shortcut here because really we have the proportion to fill and then we

need to fill up the entire two dimensional space.

So it's really the proportion of two pi that we are filling up.

And then from the center phase, we have to go negative and then also positive.

So so then we are having half of the phase angles to the left and then it's two pi and then half of

the phase angles to the right.

So this would be like the full formula, the way should really be.

But then of course you have times two divided by two.

So we can actually just simplify and say Pinfield times pi.

OK, so let's run this code.

And now so this gives us a population of phase angles.

We can plot them.

Maybe I'll plot them as on a number line, which I normally recommend against.

But you can see the phase angles go from yeah.

A little bit below zero radians up to one point seven and I guess that's around Pi over to.

OK, so we're going to show these as angle as vectors later on.

But first I want to compute the play.

Now, you might remember a few videos ago when we first computed the Matlab code for Innosight phase

clustering and there we did it, you know, one piece at a time.

And so we're going to do that.

Here's what we're going to break up this formula to one tiny little piece at a time.

It's going to take a bunch of lines of code.

And of course, in practice, you would just mix all of these together into one line of code.

All right.

So let's walk through it so we can do it methodically and make sure that it makes sense.

So first, we want to oilrigs the phase angle differences.

So that is E to the I times the phase angles.

Now, in this case, it's just one vector of phase angles.

But, you know, depending on how you set things up in your code, it might be, you know, phase angles,

one minus phase angles, two from phase angles for two different electrodes.

OK, so that's just a reminder of how it might work in real data.

OK, so so then we create these oilrigs vectors.

These are complex vectors and then we want to project the phase angle differences so these guys onto

the imaginary axis.

And we do that simply by using the function image and notice that these very this vector here, these

values are complex, valued, and here they are all real valued because we are just taking the projection

onto the real axis.

And then we want the sign of those projections because remember, we don't actually care about how far

up or down the real axis they are.

All we want to know is, are they positive or negative?

So then we say sign of C variable CDI, OK, and then we take the average sign that one is pretty straightforward,

so mean of CDI s and curious what this ends up being.

So it ends up being point eight three.

And then here what we just care about is the magnitude of the average, not the sign of the average.

So then we take the final value of play is the c d i.

S m it's quite a lot of letters there, but it's the CD which.

The complex differences are not actually sure what the CD stands for, but anyway, this is the imaginary

part and then the sign and then the mean so and then finally that gives us the play, which, of course,

is also going to be point eight three.

That's already the positive value.

OK, and then for reference, we can also compute phase clustering and now here for phase clustering,

we can actually start from this variable.

So we take this variable CD and then to compute Innosight phase clustering.

So we have CD and then we want to compute the average.

So that's the mean.

That's the average of the phase angles, the complex vectors, and then we take the magnitude of the

average.

OK, and now, you know, this can get a little bit confusing because here these this is still a complex

number.

This is a vector in the complex plane.

And here we are taking the length of that line from the origin.

And here we are taking the absolute value of this number, which is just sitting on the real axis somewhere.

OK, now let's make a plot.

So we are going to make a polar plots of all of these phase angles.

So first of all, it looks really beautiful with these thin black lines.

It's just nice to look at.

So here we see that's the it equals one.

Something is wrong here.

First of all, this probably should say I speak because that's what we're simulating and that's a one

here.

Maybe I didn't run this.

Let me see.

And that's between 85 to 90 something or.

OK, I think I just didn't run this yet.

Let's see.

OK, that's more like it.

OK, so pretty interesting, actually, in this case, it looks like the play and the phase clustering

are nearly the same value.

They're almost exactly the same value.

So now we can we can play around with this a little bit.

For example, we can change the center phase.

What happens if we make this pie over 40?

This is not zero.

You know, technically it is not zero, but it's pretty close to zero by over 40.

And let's see what this ends up being now.

Now, based on what I've already illustrated to you in the past several videos, it's no surprise that

the play is close to zero and the phase clustering is still relatively large.

So I'm not going to play around with the code in the cell anymore.

But I do encourage you to spend a few moments playing around with these three parameters.

These two are the most important.

The end is also, you know, that's also relevant.

You can see if you you know, if you just simulate like four vectors, you're not going to get a very

sensible result.

So but definitely spend some time and play around with these two variables and see how that affects

the plot and see how the visualization of these phase angles differences relates to the play and the

phase clustering.

All right.

But I want to do is go on to this part here, which is called Flesh Out the Space.

This is pretty cool, this exercise.

I'm looking forward to it.

So what we are going to do here is very these two parameters.

So here these two parameters are, you know, we just have one single value for each of these parameters.

What I'm going to do is generate a whole distribution of these parameters.

So we are going to have the range of the circle.

So the part of the circle filled in between zero and one, which means one hundred percent, and the

center phases are going to go from zero to two pi.

So we're looping over all possible values or many possible values of these two parameters.

And then so here's this double for loop here.

We create the phase angles exactly the same as what I showed in the previous cell.

And here we get the oil erased, phase angle differences that's already getting started.

And then here we want to compute the rest of the play.

All in one line.

Super intense is really exciting.

Let's see.

So what we want to do is take these guys, let's walk through it one piece at a time so we want to project

them onto the imaginary axis.

And then what we do once we've projected them onto the imaginary axis, you guessed it, or.

Well, you didn't gas it.

You knew it.

We take the sign.

And what do we do with all of those signs?

We take the average and what do we do with the average of those sine we take the absolute value because

what we are interested in is the overall differences with respect to the real axis.

We don't care if they are pointing up or pointing down.

So there you go.

That was pretty straightforward, wasn't it?

Now, when you're implementing something like this in real data, you just have to be mindful that you

were computing the mean over the correct dimension.

In our case, in this simulation here, we only have a vector.

We are not dealing with trials and things like that.

So we don't have to worry about that.

But, you know, just a reminder that you should always be mindful about using the mean over the right

dimension.

OK, and then here we get ISPCC.

That's already done for us.

OK, so let's try to run all this code.

And ran super fast, modern computers are amazing and let's see what this looks like.

All right, pretty neat.

So, first of all, it looks like fire, these are like flames coming up from a from a fire.

So here we have it apply.

Here we have the it's our eye SPCA.

I guess it should be, but that's OK.

And the color corresponds to the strength of the measure, which again, is, you know, in our kind

of dumb little simulation that would correspond to the strength of the synchronization between two electrodes.

So on the x axis, you see the face angle and that's the phase angle between the two electrodes simulated.

So the preferred phase here is PI and this is two PI.

So in fact, these are really wrapping around.

So this all all the way on the left side, this connects to all the way on the right side.

And same thing here, all the way in the left connects to all the way on the right.

So this is really wrapping around like a tube.

And then here we have the proportion of the circle that is filled going from zero.

So, you know, basically none of the circle is filled, which means that there's really, really tight

clustering all the way up to one where there's no clustering whatsoever, perfectly uniform distribution

of phase angles all throughout the circle.

OK, so it shows no relationship whatsoever to phase angle.

There is nothing interesting happening on the X dimension, on this horizontal row dimension here,

and that is not surprising.

Phase clustering is totally blind to the phase angle.

It only cares about the amount of clustering which is depicted here on the Y axis and the PLA.

You can see it's pretty interesting that it is sensitive to both.

So it is sensitive to the proportion of the circle that's filled to some extent, but only for certain

phase angles and the phase angles where you get the where you get, you know, very, very weak PLI

or even Peli of zero corresponds to zero pi, which is the same thing is true pi and one PI.

And then the reason why you get this kind of spiky triangular shape here is because as the distribution

is opening up, you are getting more and more phase angles around here that are going to the other side,

shifting to the other side of the imaginary or the other side of the real axis.

So would be negative, the opposite sign on the imaginary axis.

Now, armed with this picture, this is now a great opportunity for you to go up here and rerun this.

And now you can pick variables here based on interesting points here so you can plot this part here.

So this would be a proportion field of point five and a phase angle of also zero point five.

And, you know, this doesn't need to be specified in terms of PI.

You can just write point five directly based on the value that you see here.

OK, the very last thing that I want to show your point out in this video is the color map.

So I have the color map here.

It's actually inside the figure.

It's embedded inside this axis here.

Now, normally, I don't really like to have the color bar inside the axis.

However, I just wanted to show you how to move these these color bars around.

So I use color bar and then I wrote E!

So that was that's a way of moving the color bar around to different places.

You can also do s, for example, and that will look like this.

That puts a color bar on the bottom.

So one of the important take home messages from this plot and also this video is that the play is not

the same thing as the ITC or ISPCC.

So when should we use phase clustering and when should use phase phase lag and when should use phase

clustering?

That is an important question and I'm going to discuss it in the next video.

See you soon.