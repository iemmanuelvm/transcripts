What I want to do in this video is not only illustrate the policy in simulated data, but also give

you code so that you can continue exploring the legislation on your own with simulated data.

And in the next video, we are going to apply the policy into real data so you can see what it actually

looks like.

OK, so what we're going to do here is pick two channels and then we are going to create essentially

create Gaussians around each of the center channels and then apply the law plasty and visualize the

resulting topographical maps.

So let's get started.

Now we are simulating data.

However, we still need realistic channel location.

So that's why I'm loading in the sample EEG data set and we are working with Channels -- and seized.

So these are channels that are kind of close to each other, but not totally overlapping.

And it will be interesting for you on your own after this video to explore the how the lipless looks

when you try with different electrodes, electrodes that are closer to each other center, electrodes

that are further away from each other and so on.

Okay.

And then all we're doing here is converting the channel label into an index that tells us which channel

into the channel indices actually corresponds to Peizer and sees it.

OK, so here we are computing.

So actually, let's let's look down at this code here.

So what I'm going to do is create two features of data that have low spatial frequency and high spatial

frequency.

And you can recognize that there is something that looks like a Gaussian in here.

So it's E to the minus then this variable.

OK, dist, which is for Euclidean distance squared.

So it's E to the minus something squared divided by some shape parameters, so some width.

So and then this Euclidean distance variable is you can see it's a matrix that's two by sixty four which

corresponds to the two like C channels here and then sixty four Skalp channels.

And let's have a look at this.

It's a pretty long line of code but it's actually not so, not so difficult.

So it's the square root that's surrounding everything.

Is the end of this all the way at the end of the line of code and then we have this piece here.

So this says.

Channel locations that X of the X value, the X coordinate from this channel in the Loop to our Channel

One IDEX and then squared.

So it's a difference in distance squared and then along the X dimension and then the same thing along

the Y dimensions.

So the difference of the distance or the distance between these two points and then squared and then

the distance between these two channels on the Z dimension and squared and then the square root of all

that.

And you should recognize that as the formula for Euclidean distance.

So we square all of the distances, add them up and compute the square root of that.

So let's see.

So here we need to do the same thing, except this is Channe to IDEX.

So let's make sure we are correctly changing all of these.

There should be three.

Yeah.

One, two, three, four, x, y, z.

All right.

So that gives us a matrix of Euclidean distances from each center channel, so from seized and --,

and then here we compute our spatial frequency maps.

So these are sixty four elements corresponding to one element per channel.

Now, I'm going to get back to these parameters here in a moment.

So here I have this function, LA Plaza and Parent X, we can actually open up this function and have

a look at it.

This is a function that implements an algorithm that was described by Perren at all in nineteen eighty

nine.

And if you're curious how it works, you can look through it and you can refer back to this paper for

the math.

I also describe this in more detail in my textbook analyzing neural time series data.

There are some optional parameters which you can specify, but in general I and most other people recommend

just leaving these set at the default parameter.

So the way this works is that you input your channel data and then you input X, Y, Z, and that corresponds

to X, location values, Y, location values and Z location values of the data.

So that's what we have here.

We are going to compute the policy and of the sum to activity.

So this is the high spatial frequency feature, plus the low spatial frequency feature.

And then the other three inputs are just the translocations X, Y and Z values.

OK, so let's run that and then here we're generating a plot, so this is the low spatial frequency

map and the high spatial frequency map.

And let's just start by plotting this, because we haven't looked at these things yet.

All right, so here we go.

You see the low spatial frequency feature of the data and the high spatial frequency feature of the

data.

And now this helps us understand these parameters here.

So this is the amplitude parameter.

This means that this map is actually 50 times brighter than this map.

You don't notice that because Matlab has fixed the color map to be separate for each subplot.

But I can say get get current access selim's.

So I'm going to set this to be minus 50 to plus 50 and OK, that's maybe too much.

Let's try.

But times five.

No, too little time too.

All right.

Of course these are only positive values.

Let's do something right.

OK, so this is actually a pretty small range going to do.

How about 40 to 50 there?

And for this map, then I'm also going to put that on the same scale.

And I mean, get rid of all these things, delete all data tips, so when I put these two maps on the

same color scale, then you don't even see this map anymore.

You don't see anything on this map anymore.

That's because all these values are tiny relative to these values.

And you will see in a moment why I wanted to set that up, why I wanted that to be the case.

So let me let these allow these plots to go back to their original color scheme.

So, again, this is really, really high amplitude.

This is really, really tiny amplitude.

And that's determined by this value versus one implicitly.

There's a one time this thing here and then this value here is a little bit arbitrary, but essentially

the thirty thousand and the three thousand is just defining the width of this Gaussian.

So this is a wide Gaussian.

This is a narrow Gaussian.

As always.

When the video finishes, I encourage you to go back to this code and play around with different parameters.

OK, but for now, what I want to do is plot something in the third subplot.

So what is going to go here?

Well, we don't.

So obviously there's something missing.

We don't have a comment that's telling us what to do, but we can guess from the title.

So this is going to be the low Spatt Frech, uh, without a W here low Spatt plus high spatial frequency.

OK, so now what I've done is just some these two together.

So this map plus this map, each electrode added together and that's what you see here.

Now this map obviously looks much more like this map.

You do see that the center kind of does get pulled upwards a little bit.

It gets pulled the interior from the addition of this map focused at sees it.

And now what we're going to do in the fourth subplot is plot the this variable surf flap.

And that was here where we took the look plus the end of the some of the high and low spatial frequencies.

So this is the the passing of this map and that looks like.

This so that's pretty remarkable, even though this has 50 times the amplitude of this feature and when

we sum them together, you hardly see this feature at all.

It's dominated by this low spatial frequency feature.

We apply the lipless and that not entirely eliminates you know, it doesn't get exactly back to this

thing, but it really strongly attenuates the low spatial frequency structure and preserves the high

spatial frequency structure.

So I think that is pretty remarkable.

That's a pretty neat outcome of the lipless in operation, the plus and spatial filter.

Now, something that you can do if you are interested in exploring the location further in the simulated

data.

So one thing I've already mentioned is to play around with these parameters.

The second thing I've already mentioned is to play around with the electrode locations.

And a third interesting addition to this code is to simulate a third electrode that would have a high

spatial frequency.

So let's say it's like what I showed in the previous video in the slides with the two little blobs at

the bilateral motor cortex.

So, for example, maybe you want to simulate instead of just that in season, you have a low spatial

frequency, high amplitude feature, P, Z.

So basically just this.

And then you can have two small features at, you know, maybe C one and C 2s.

That would be these little electrodes over here.

And then you can see whether the lipless in can separate those activities from the low spatial frequency

coming from --.

Anyway, in the next video, we are going to start exploring the effects of the little plastic and in

real EEG data.

I will see you soon.