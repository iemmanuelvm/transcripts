 Real brain activity is often narrowband, but highly non stationary, non stationary basically just means that the characteristics of the signal are fluctuating over time. That's the sort of thing you see here where the amplitude is increasing and decreasing over time. The frequency is changing a little bit over time. So here it's not it's a little bit faster and here it's a little bit slower. So these are some characteristics of brain electrophysiological signals. Therefore, it's important to be able to simulate data that share some of those characteristics. So one way that you can do that is by filtering noise. And that's the major goal of this video. Now, this is another good example of the distinction between simulating data to test analysis methods versus simulating data to understand something about the brain. Now, just starting with a bunch of random numbers and applying a band pass filter, that is a terrible way to understand how the brain works, because that's not how the brain works. However, you can generate some random noise and filter it, and that gives you a signal that shares some spectral and temporal characteristics with real brain data. So therefore, this is a great method for testing data analysis methods. OK, so there's numerous ways to accomplish this, to obtain a noise signal that looks like this, the way that I'm going to show you, which is just the way that I prefer, because I think it's pretty straightforward, is to start in the frequency domain and then move into the time domain. So what we do is generate a bunch of random numbers, positive random numbers, and that becomes a random spectrum. So each one of these would correspond to the amplitude of a four year coefficient at different frequencies, and then you generate a Gaussian in the frequency domain, which has a slightly different formula compared to the Gaussian in the time domain. And then you point wise, multiply these two functions together that gives you this signal spectrum. Now, this is not the time domain signal. This is in the frequency domain. So this would be the amplitude spectrum of the signal. And then you take the inverse for a transform of this spectrum to get back into the time domain. Again, this is not the only way to create narrowband noise to give you a signal look something like this. But well, that's the method that I'm going to show you here. Here we specified some simulation details. We have four thousand five hundred and sixty seven points with a sampling rate of nine hundred and eighty seven, you might be wondering why I picked these bizarre numbers and not something simple, like five thousand and one thousand. And that's because, you know, sometimes it's good to be a little bit different. Here are the parameters in Herts for the noise spectrum. So it's going to have a peak frequency of 14 hertz and a width of five hertz here. I'm specifying frequencies. Now, if you're familiar with four eight transformed or if you taken my courses on the four you transform on signal processing, you will immediately recognize that there is something fishy going on because I am specifying this frequencies vector to go all the way up to the sampling rate, whereas valid positive frequencies only go up to the Nykvist, which is half of the sampling rate. However, it turns out this is a really useful trick and the frequencies up to the Nykvist are still perfectly valid. Here is the formula or I say the code for generating a Gaussian in the frequency domain. Some of it looks similar to the time domain Gaussian. So you still see E to the minus something over, something squared. And mainly what's different is how you specify the width of the Gaussian, the shape parameter of the Gaussian. Here I generate the random Fourier coefficients, you can see it's positive random numbers that are scaled by some. Other positive random numbers that are in the range of zero to two pi, so basically this is generating random fais values. This puts it into Euler's formula. So E to the IC, where K is these random phase values and then just links together random phase values and random amplitude values. Here I taper the four year coefficients by the frequency domain Gaussian and take the inverse Fourier transform. This is a non symmetric and asymmetric spectrum, so we just care about the real part and then I do some plotting. So here's what that looks like. Here is the amplitude spectrum in the frequency domain. And here you see what the signal looks like in the time domain. So interesting things for you to play around with include the peak frequency and the full with that half maximum, so you can make this wider. And what happens when you make this wider is that you increase the amount of non stationary that's in the signal. So you can see this time domain signal. Now looks more variable. There's more kind of stuff happening. It's more non stationary or you can make this narrower and you'll get less non stationary. So now you can see this is a very, very band signal in terms of frequency. It's really not changing at all. So it slows down a little bit here. But otherwise it's really not changing speed. It's only changing in amplitude.