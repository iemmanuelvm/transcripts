So now I'm going to walk through my solutions to project to again, I've mentioned this in my solutions

to Project one, but I'll reiterate it.

It doesn't matter if your code matches my code, if you solve the problem in a different way than what

I solve the problem, that's totally fine.

That's not the point.

The point is to gain more experience and more insight into simulating characteristics of data.

OK, so let me start from the beginning.

Don't actually need to run all this code, but I do need to load in this data and I'll run this as well.

And so that's done.

Now, let me close these things.

So generating a pure sine wave over 40 trials, that one's pretty straightforward.

In fact, it's basically the same thing that we did here.

The main difference is to add more trials.

Now, you can do this in a loop over trials or you can generate just one trial like this and then repeat

that trial over and trials.

So I use this map function.

I repeat the signal and over the matrix one by one, because the signal is already a good size as it

is after P'-- for all the channels and for all the time points and then repeat for all the trials,

OK, and then plot the data.

And the question is, what is the smallest amplitude of typos?

And this is a little bit of a trick question, because if you specify that all the other dipoles are

zero, then essentially, you know, there's a little bit of signal loss as you get from the dipole

to the channels or a signal amplitude modulation.

But it actually doesn't really matter.

Pretty much as long as you're at machine precision, you're still going to get a response.

So you can see this is ten to the minus twenty nine.

I fear the power because that gets squared, so that's ten to the minus 57.

So it's a bit of a trick question, but this is definitely not a trick question, given an amplitude

of one at the Dipo level, what is the amount of noise that is basically still tolerable where we can

still visually, qualitatively see a result?

So here the data are simulated exactly the same and the only thing that changes is this.

And so I have this over individual.

So this code is placed within the trial loop because that means that each trial gets its own unique

noise characteristics.

Of course, the signal is identical on each trial.

So the sine wave here is ten hertz.

The frequency of the sine wave is 10 hertz.

And you can still see a peak here at ten hertz, although it's kind of washed out in the time frequency

plott.

But when pulling over more data, you see the 10 Hertz peak here, and I would say this is about as

good as it gets.

So you can see, you know, if we go down, let's say point one now, you'll see that peak is going

to be more prominent.

The noise will be smaller, easy to recognize.

And if we go to I think even if we go to noise, standard deviation of five, it's probably going to

be indistinguishable from noise.

Yeah.

So you don't even see in fact, it looks like at 10 hertz there's even a minimum.

So it's not really that there's low power at 10 hertz.

It's that there's so much broadband power and noise power that that overpowers the 10 hertz signal.

So that's kind of interesting to know.

When you're simulating data, you want to know how robust your method is to noise.

And this is one way that you can manipulate it.

This will come up, for example, in the section on spatial filters and you will see that the amount

of noise that is tolerated by spatial filters is much, much larger compared to the amount of noise

that's tolerated by a single channel analyzes.

OK, now four, problem three, we want to put a non oscillatory transient into one dipole noise into

all the other dipoles, so I'm generating a non oscillatory transient through a Gaussian and with some

trial and error.

So this peak time and with I just kind of came up with or just basically copied and pasted from previously.

And this amplitude level I had to play around with a little bit.

So here I created the Gaussian.

And then I loop over trials, generate new random data on each trial, the dipole is always the Gaussian

that part's fixed and then this part I've seen before.

So now we can make a plot of this.

See how that looks.

And this is interesting for a number of reasons.

First of all.

So when I said I had to play around with amplitude, what I meant is that when you have an amplitude

set to one, so without saying anything, then basically you don't see the Gaussian here.

The noise totally overpowers it.

So from trial and error, I figured out that 70 is a pretty good you know, it gives us a pretty healthy

signal to noise ratio here.

Now, it's interesting to note that a galizia normally goes up and down and this Gaussian does go up

and down.

Let me show you that.

So, of course, you can see it goes up and down, but here it actually comes out as being negative

at the scalp level.

And that's essentially because of the orientation of the dipole.

So the dipole is actually oriented away from the electrode, which means it projects onto the electrode

negatively.

So it's the other side of the dipole.

That's a really important concept in EEG analysis because it's difficult to assign the phase or the

voltage amplitude, you know, which the sign of the activity that you recorded the scalp to the sign

of the activity that's actually happening in the brain.

So that's interesting to keep in mind here you see the time frequency plot of a Gaussian, it's not

terribly interesting.

It's just a very kind of blurry, low frequency response.

Looks like this.

And the power spectrum is a negative going exponential, and that is the power spectrum of a Gaussian.

All right.

Now we get to the last point.

And here so this last segment, I said that you should split it up into first picking two dipoles and

copy paste some of the code from the very beginning and then do the simulation.

So here I picked these two dipoles.

And again, this is, you know, largely just kind of poking around.

Those two dipoles are here.

They're both kind of posterior.

I wanted to pick these two dipoles so that they're relatively close to each other, but not totally

overlapping.

So you can see they kind of overlap a little bit around here.

Their projections overlap a little bit, but not entirely.

Now, that is an interesting concept in data analysis because there's going to be some contamination.

So two very different sources in the brain, which are generating very different kinds of activity,

are actually going to mix at the level of electrodes.

So when you measure the activity at electrode, let's say 57, the activity that you measure at Electrode

57 reflects a combination of some of what's happening at this dipole and what's happening at this dipole.

Now, it's a little it's going to be more dominated by what's happening at this dipole, but you're

still going to get a contribution of this dipole to electrode 57, I should say, this dipole to electrode

57.

And of course, these are only two dipoles in the brain.

You're going to have lots and lots of dipoles.

They might be much closer to each other than I have stimulated them here.

OK, now.

We get to the simulation.

This is not really any more difficult than what you've done before, just slightly more involved.

So I'm going to use this multipolar chirp to generate non stationary oscillation in Type one, and then

I'll use a sine wave multiplied by Gaussian to generate the signal in Dipole two and then from here.

So once you generate these two dipole signals plus trial unique noise, then projecting the dipole activities

onto the scalp is basically the same as you've always done.

You just multiply by the gain of the lead field.

OK, so I'm going to run this whole code.

We can see what it looks like.

So now it's interesting to see it interesting to compare figure to and figure three, so figure to show

you this.

So figure two is for Channel 31 and figure three is for Channel 56.

And I picked those two channels because they highlight or they're like the maximum projection electrodes

from these two different dipoles.

So here.

At Channel 31, you see this 10 hertz signal and here at Channel 36, you see this transient oscillation

here.

So that's pretty nice.

We see that just by picking different channels.

We can separate these two sources.

Now, that's not always possible, it's not always possible to do source separation by just picking

through different channels.

It depends on how far apart those channels are, how strong the dipole activities project to each of

the two channels and so on.

Now, what I encourage you to do is spend some time playing around with this, you can afford the oh,

sorry.

There was one last thing that I wanted to mention, which is that I specified the non stationary oscillations,

non stationary steinway's to have a range of five to 10 hertz.

And the way that I did that is by keeping in mind that just this code here suggests this entire one

function.

This is going to generate numbers between zero and one because it's using the RAND function and then

I multiply by five to generate random numbers between zero and five and then I add five.

And that gives me random numbers or some frequency time series between five and ten.

So that's the mechanism for specifying the range of frequencies.

Of course, you could have also done this by filtering white noise or starting in the frequency domain

with noise and using a Gaussian and so on.

OK, so now the thing that I encourage you to do is to try changing the amplitudes of these two features

so you can try increasing the amplitude of this, let's say, you know, make it four times the sine

wave or in different simulations.

You can make this one really big, like 40 times the amplitude and then get rid of this.

And basically you want to see what happens with the contamination.

So do you get more cross contamination between the two different channels when the amplitudes of the

two signals are vastly different, which is not how I have it here.

So over here, the amplitudes are basically the same.