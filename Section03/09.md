In this video, I'm going to walk you through my solutions to Project one before showing you my code

and talking a little bit about it.

I want to make sure it's clear to you that there are many correct ways to solve these problems.

That's.

So if you got a result and it looks different from my results or your code looks different from my code,

that's totally fine.

There's nothing necessarily wrong with that.

The important thing is that you are simulating data that you're not getting any matlab errors and that

you're generating a plot.

And of course, the most important thing is that you are learning and thinking carefully.

All right.

So with that said, we can skip one because that was already done for you before.

So now we get to to the pure non phase lock sine wave.

And essentially that's all the same code.

You just need to add a random phase offset to each trial.

So the total possibilities for phase values and radians is between zero and two pi.

So what you want to do is generate a random number between zero and one and then scale that up by two

PI.

So that's going to produce the plot that looks something like this.

You can see the average has an amplitude that's considerably smaller than the all the single trial data.

Now you might have expected this to be zero.

The reason why this is not zero is just because of some sampling variability.

You can see it just so happens that there aren't a lot of trials with phase values that give you data

right around here.

Oh, and I think I forgot to mention this in the previous video, but you've probably figured out by

now in this plot, all the individual trials are plotted in grey and the average across all the trials

is plotted in black.

So if you think there's something special about this and you can try running this again, you'll see

both the amplitude and the phase of the average vary from run to run.

And it's really just random sampling variability.

If you would increase the number of trials.

Let's see.

So there's 30 trials.

If you would make this, you know, 100 trials, then this would be much closer to a flat line.

But what's really interesting and what I would like to point out explicitly is the difference between

the time the main plot and the to frequency domain plots.

So the time domain plot looks very different from trial to trial.

But these two plots don't change and these two plots don't change because these are actually within

trial based analyses.

So here you take the four eight transform of each individual trial and then average together the power

spectrum.

Here you take the time, frequency analysis of each individual trial and then average all of those together.

All right.

Next, we get to the multi sine wave signal.

So here I'm copying code from one day to this from elsewhere.

That's from live teaching this course so you can copy code from the previous video on the three important

equations.

So essentially you're just generating a vector of all zeros here and then you're adding it inside this

loop over frequencies.

You add it to itself.

Plus a new sine wave at this new frequency with this specified amplitude and then that just gets added

here.

So then we plot this again.

And now here is a perfect example of how you can use simulated data to try and understand the advantages

and the limitations of data analysis methods.

So here you see we are generating sine waves at three hertz and five hertz.

Those are very clearly distinguishable in this power spectrum here.

However, when you look at the time frequency, you don't see separate lines for three hertz and five

hertz.

You do see a separate line for 16 hertz, but the three hertz and the five hertz are basically interfering

with each other.

And that's why you get this kind of beat like pattern.

So this is really interesting to know.

This shows you one of the limitations of time frequency analysis.

Now, there will be plenty of other occasions where this static power spectrum doesn't give a good result

and the time frequency does give a good result.

So the conclusion here is not that time.

Frequency analyses are terrible and static.

Spectral analyses are always great, but it certainly is the case that you have now discovered one limitation

of time frequency analysis, and that is that you can get some interference patterns when the two frequencies

are pretty close to each other.

Now, it turns out there is a solution to this.

You can change the analysis parameters of the time, frequency analysis parameters in order to separate

the three hertz from the five hertz signal.

I'm not going to do that here.

That's the kind of thing we will do later on in the course.

All right.

Now for the non stationary Steinway's.

So this is basically just that starter code that I gave you already and then you just have to kind of

wrap this loop around it so that one wasn't too difficult.

So here's what that looks like.

This is starting to actually get a little bit more physiologically interpretable compared to this.

This is not really physiological.

So this is starting to look a little bit more like what you might expect for real data.

So here we get to the transient oscillation using a Gaussian.

Now you'll notice that the Gaussian is the same on every trial in every channel.

So the Gaussian is created outside this loop.

You could think about doing other things.

For example, you could have the peak time be variable.

It would be pretty interesting.

So you could do something like this.

If you move the Gaussian into the trial loop here, you could say peak time, let's say, plus Rand

and maybe Rand and divided by two just to make it a little bit less variable.

So now the peak time on one trial is going to be one point, four seconds.

One point.

Also around fourteen point four seconds.

Here, it's even going to be a little bit negative.

So maybe that's too much.

Maybe you want to constrain the variability a bit more.

That would be somewhere generally around one second.

OK, I'll run this.

So this is interesting.

You see that the average is certainly around one, but there are some trials where the peak is earlier,

some trials where the peak is later.

This is also very physiologically plausible.

This happens a lot that there's a lot of variability at the single trial level.

OK, let me get rid of this.

Go back to how it was.

I just want to give you a bit of a feel for the kinds of things that you can do when simulating data

and these give you interesting insights into.

Different analysis methods.

OK, so here we go now this just looks like a Gaussian, you don't see the single trials anymore.

That's because all the single trials are plotted behind the trial average.

So there is zero variability.

Nothing changes over the different trials in this code here.

So I'm going to change that in a second.

But I just want to point out here is actually a case where the time frequency plot gives you a more

accurate depiction of what's happening in the data compared to the static power spectrum.

And that's because this is very brief.

This feature of the data is very time limited and the time frequency plot shows that.

But the static power spectrum does not show that.

OK, so I'm going to change this a little bit and make this non phase locked.

Now, that was not explicitly in the instructions, but come on, man, who cares?

You can do whatever.

That's the great thing about coding.

So I can say to PI and simulating data.

So now each trial has its own random face value.

And what's interesting is to see that the single trial data kind of just show this kind of pretty looking

Gaussian envelope here.

It's actually almost like a like Lipps, right?

Like one of these cartoon Lipps things.

If this were red anyway, they can see the ERP.

The average of all the trials is really flat.

It's barely, you know, just a little bit of bumps here, a little bit of wiggles, but the time frequency

powerplant looks exactly the same.

So this is a really nice depiction of these two different analysis methods, the event related potential

in the time domain and the time frequency power response here and the time frequency.

And this preserves the activity.

And here a lot of the activity is lost because this is purely non phase locked.

So we can recover this by making it partially phase locked.

So I'll say that the phases can vary randomly between zero and PI instead of zero and two PI.

And now that's going to look a little bit, you know, you'll see more of an ERP, although it's attenuated

and this is still the same.

So now we get to number three and this is repeated with white noise.

Not this one isn't super interesting.

I just added some noise here.

Otherwise, all of this code, in fact, basically all of this code is the same as for number three.

It's really just this piece of code here.

Now you can see I'm generating normally distributed random numbers and I'm multiplying them by five.

That's just a random, arbitrary factor that I added.

You can try changing it to point five to add a little bit of noise or, you know, maybe 15 to add even

more noise as you like.

It is kind of interesting to see that as the noise corrupts the signal, this basically everything starts

to look worse, although except this this still looks pretty good.

If we would say 15 versus zero, no noise.

Let's see how this looks.

So this changed a little bit, of course, but this seemed to be less corrupted by the random noise

compared to the time frequency plot or the ERP plot.

Again, that's pretty interesting to remark.

And then finally, we have the one over Heff noise where we're repeating step five.

So this is also just copied and pasted from all of this is copied and pasted from the previous video

on generating pink noise.

OK, so now I can run this.

Now, this one is quite interesting because if you have worked with EEG or MBG or FFP data, this simulation

might start looking a bit biological.

This is the kind of thing that you would expect to see in real data.

Maybe you would expect to see this burst a little bit wider.

And in fact, we can do that.

We can set the width, we can change the width to, let's say, at no point four to.

So now this looks a little bit wider.

And this is not so unusual, this is not so weird for real data.

In fact, if you would have told me, you know, if I if you didn't tell me anything about where these

plots came from and you didn't show me this plot or this plot, you just gave me this plot and said,

do you think, Mike, do you think this is real data or fake data?

I think I would have a hard time knowing for sure that this was fake data.

So that's pretty useful.

This is a way to simulate data without having to worry about any biophysics, without having to worry

about any neuroscience or physiology.

We have a way to simulate data that kind of looks like, you know, it contains many of the features

of real empirical data.