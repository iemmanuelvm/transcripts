 So far in this section, I've taught you how to generate signals at individual electrodes, that's fine, and that's very useful in many cases, but sometimes it's also important to generate a little bit more physiological plausibility. I should say physical realism into the simulation. So slightly more realistic would be to generate the signals, not at the level of electrodes, because that's not where brain activity is produced, but instead to produce signals inside the brain. And then project those signals out to the brain, onto the topography, onto the different electrodes so it works something like this, we start with a collection of locations in the brain. So this each one of these dots is the location of a dipole in the brain. So this is the frontal lobe, the temporal lobe and the occipital lobe. There's 24 of these dipoles. And then what you can do is pick one of the dipoles and generate some signal in that dipole. So in this particular example, it's random noise plus a time limited sine wave. And then the activity from this dipole is projected onto the scalp, along with the activity from all the other 2003 three dipoles. So you can simulate anything you like in all of these dipoles, different kinds of signals or different types of noise, different levels of noise. You can see here is a correlation matrix between all the dipoles. So this is showing that you can impose some autocorrelation structure inside the brain and then project everything projekt, all this correlated noise out onto the scalp. So the idea in this particular topography, the idea here is that all of the dipoles are silent. 2003 of these dipoles are doing nothing and only one dipole is active. And then it would look like this, the topography would look like this. And because of the location and the orientation of this dipole, it projects Maximilien onto these electrodes and the projection decreases as a function of distance. So this is pretty interesting because you have this one source. This is a source of activity and it projects simultaneously, but with different amplitudes to many electrodes. So here's what the activity in the dipole looks like, and here is what that activity looks like at this electrode. So this is pretty interesting. And actually, I think in this case, there was noise in these other dipoles. But you can see that even if there's a very strong signal inside the brain as that signal gets mixed in with other signals and projected onto the scalp, the signal gets much smaller and the noise of the contamination from other dipoles gets larger. So this leads to some interesting challenges in neural time series analysis. How do you best estimate what's happening inside the brain based on what's happening at the level of the scalp? That is definitely not a trivial problem. And you can see here that it's already quite difficult. OK, so this is just a little bit of a theory about how you would start from simulating activity in a dipole and then projected out onto the scalp. Now I want to discuss with the mechanics of actually doing this and not the physical model that's called a forward model, the estimate of how electrical fields propagate from some equivalent dipole out onto the scalp, but a bit more about the mechanics, the mathematical and matlab mechanics of this. So all the important data are contained in a Matlab structure called L.F., which stands for lead field or lead field matrix. There is a bunch of different fields in here, but the important ones are this gridlocks, that's the grid location. You can see it's two thousand four by three. So that corresponds to two thousand four dipoles and three locations, X, Y, Z. So making a 3D plot of this gridlock is how I got this plot here. And then there's the gain matrix, and this is the most important matrix here. So this is sixty four by three by 2004. So essentially this is a mapping of each of 2004 dipoles onto each of sixty four channels. So that's how you project the activity from one dipole onto 64 channels. So you would just look at the eye of dipole and all of the channels and that gives you this mapping, this gain field. Now why is there three in here? The reason why there's a three here in the middle is that you can model dipole orientations in three cardinal directions. So you have the X direction, the Y direction and the Z direction. So in fact, at each physical location in the brain, there are three dipoles that you can model. And then the idea is you can come up with any arbitrary direction of a dipole by combining these three directions here. In practice, it's typically easier just to take one direction and ignore the other two, and that would give you a sixty four by twenty four matrix. Here is the math. So this is the linear algebra expression here for how to get data from the from the brain dipoles into the scalp. So if X is a matrix of dipoles by time, so it's a time series at two thousand four dipoles and Ã‰l is the lead field matrix and that is 64 by, I should say, more generally channels by dipoles, then it's just a very simple matrix multiplication. You multiply the lead field matrix by the dipole time series data and that gives you Matrix Y, which is channels by time. So this is the channel time series data in Matlab code. It looks like this. You have the lead field matrix. And again here I'm just selecting one dipole orientation, fixing one dipole orientation times. In this case, just total random noise. For the number of dipoles by the number of times points, and that gives you the data. So in general, the idea of simulating dipole data and projecting and onto the scalp is that you start with simulating your dipole data project, everything to the scalp. And now when you do your data analysis, you're only analyzing the channel data. You're not analyzing the dipole data. You're just analyzing the channel data. And you see what the results look like at the level of the channels. And then if you want to compute the data, evaluate the accuracy of your data analysis methods, you would compare the results of the methods against the actual data that you simulated in the dipole. OK, I hope that's enough theory for you to understand the general idea. I'm not going to switch to Matlab and I will show you how to implement this in practice. So this is part of the script for Project two, which is the second part of the project in this section. I have the Leitchfield matrix inside this variable or star data file MDT that that so we load this in select dipoles, kind of randomly selected. And then I'm going to make a plot that looks just like the plot that I showed in the slides. And I think I'll actually just run this. So you can see all of the brain dipoles in yellow and then you can see dipole. One hundred and nine. And these are ordered a little bit arbitrarily. It kind of goes from the back to the front and it sweeps down, but it happens to be that dipole. Number one hundred and nine is located here. And of course, as always, I encourage you to play around with this, try different dipoles. And when you project that dipole onto the scalp and that's you can see here. So the lead field again and then it's all of the channels, only this one orientation and this one dipole location. This is what the topography looks like, projecting this dipole with that orientation out onto the scalp. So you can try, for example, showing the second orientation. You'll see that that's not orthogonal to the first one and the third orientation is going to be orthogonal to all of those. OK, so let me set this back to one. And so here I'm just showing you a quick intro on generating some signals. So he specified number of time points and a time vector here I generate dipole data, so it's two thousand four dipoles by 21 points and it's just a bunch of zeros. And then what I'm doing in this line is replacing the Time series from one dipole with a pure sine wave at 10 hertz sine wave. And here is the line where all those dipole data get projected onto the scalp into that data. So you can see it's just the Leitchfield times, the dipole data, exactly how I showed in the slides. And then we use this function that you're now familiar with to plot some of the data. So again, the idea is we're simulating data in the dipole, projecting it onto the scalp and then doing scalp level analyses.