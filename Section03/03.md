Let's begin by talking about three important equations in Time series analysis, those will be the sine

wave, the Gaussian and Euler's formula.

These three equations appear over and over again all throughout time, frequency analysis, spectral

analysis, synchronization analysis, and you'll see them quite a bit in simulating data.

So let's go through them first.

We start with the sine wave.

Here's the formula for sine wave.

And here is just a little hint to tell you how it's pronounced.

So it's a sign to PI F.T. Plus Theta.

So let me walk you through a little bit about what these different parameters mean.

OK, so here it is again.

So A is the amplitude F corresponds to the frequency.

And if you specify T in units of seconds, then you would specify frequency in units of Hertz and then

Theta is a phase offset.

OK, so now I'm going to tell you a little bit about how to interpret each of these three parameters

of the sine wave.

So first we have frequency.

That's this F character in here.

Frequency refers to the number of cycles that takes place within some unit of time.

So typically that would be a second.

And then you're measuring frequency in Hertz.

So this would be one hertz and this sine wave would be two hertz.

Next, we have phase.

That's this theta character that's being added onto the this product that's inside the sine function.

And the phase of a sine wave refers to its global shift to the right or to the left.

So it's like you take this whole sine wave function, this yellow time series, and drag it to the left

or you drag it to the right.

And really, what phase is referring to is the value on the y axis of the sine wave, when the sine

wave crosses, time equals zero.

Now, the terminology is a little bit confusing because this is the parameter of the sine wave that's

called phase.

And there's something else that's also called phase, which is the phase angle time series.

And I discussed that in other videos.

For now, you only need to worry about this one parameter.

These two phase values that I'm illustrating here are particularly important phase of zero and a phase

of PI over two.

And those are commonly called a sine wave and a cosine wave.

Those are important for a number of reasons, one of which is that they are orthogonal so they are maximally

uncorrelated.

If you take a sine wave and a cosine wave and correlate them, you would get a correlation coefficient

of exactly zero.

Now we get to amplitude.

So amplitude basically refers to the height of the sine wave.

And it's a little bit tricky because it's not the height at each time point.

It's actually the general height, the overall height of the sine wave.

So this one says two and this one says one.

And maybe you disagree because it looks like if you go from here to here, that's actually four units.

But it turns out that the right way to quantify the amplitude of a sine wave is half the distance between

the peak and the trough.

So that would be, in this case, going from zero to the peak.

So this has a value of two.

This has a value of one.

But I just want to make it clear it's not that you're going from zero because you can also add a DC

offset or a global shift to the sine wave.

So it would look something like this.

The amplitude of this signal is still two, even though it's not centered at zero.

So the distance from, you know, zero to the peak is just over one.

So, in fact, what you do is you would measure the trough to peak distance and then divide that by

to say, take half of that.

Now, you can see here that the amplitude is actually not going to be constant on each of these peaks.

So for a pure sine wave, every peak is at exactly the same y axis value.

Every trough is at exactly the same y axis value, of course, in practice and real data.

There are fluctuations in amplitude over time.

So there are temporal, non-state personalities and amplitude.

And in fact, that's one of the main features of rhythmic time series that you are generally going to

be interested in in this case, we can take to as an average.

OK, so that's an introduction to sine wave.

I'm now going to introduce you to the Gaussian.

This is the basic formula for the Gaussian you'll see on the next slide.

There's a few parameters that are missing.

So the basic formulation, and this is what I really recommend, committing to memory.

So E to the minus T squared over two squared T is time S is a width parameter or as to how wide the

shape of this thing is.

And I'm going to talk more about that in a minute.

But in general, a Gaussian looks like this normal curve or a bell curve.

It starts very close to zero, it ends very close to zero and it smoothly goes up and then it smoothly

goes down.

Here is a more complete mathematical description of a Gaussian, so we have a E to the minus and then

the quantity T minus M squared over two squared.

You can see this is more or less same as formula in the previous slide, but there are omitted amplitude.

So amplitude was implicitly set to one, which it often is, and M is implicitly that desirable in the

formula in the previous side.

And again, that's a pretty typical value.

So amplitude refers to the peak value.

So where the Gaussian reaches its maximum, that's going to be the parameter a t is time, of course,

and it's useful to specify time in seconds.

You know, it makes everything internally consistent and it's also useful for time series analysis.

M This parameter M is a center point of the Gaussian.

So in this particular diagram, the value of M would be one.

So basically M allows you to shift the peak of the Gaussian over different time points.

And is this with parameter and in later videos and the time frequency analysis and wavelet convolution.

I will talk more about how to interpret and specify this with parameter.

But I want to show you yet another formula for a Gaussian.

It still gives the same Gaussian, but it's in a slightly different form.

And the reason for the different form that I'll show you on the next slide is that the key way or I

should say the most intuitive way to describe the width of the shape of this Gaussian is a quantity

called the full with a half maximum.

So the full with the half maximum means you normalize the galaxy and have a value of one, a maximum

value of one.

And you want to know how much time is spent between 50 percent gain before the peak and 50 percent gain

after the peak.

So this distance, so this is the half maximum and then it's the full with and half maximum.

That is the key parameter that you want to interpret and report from a Gaussian.

However, that's kind of a little bit difficult to extract from this PROMETA.

So therefore an alternative way to express a Gaussian, which I recommend is using this formula.

So e to the and then in the numerator, it's minus four times the natural log of two times time squared

divided by H squared and now H is the full with that half maximum in seconds.

So that's pretty useful.

You can directly specify the full with that half maximum in seconds.

Let's say, you know, in this case it's maybe around two or three hundred milliseconds.

So here you would specify point three for three hundred milliseconds.

And the result of this formula is going to be this Gaussian.

Actually, you can see I'm also omitting A and M in here.

So that's a Gaussian.

Finally, we get to Euler's formula, sometimes called Euler's identity, and that says that sometimes

each of the IC equals M cosine K plus I sign K, so I is the imaginary operator.

It's the square root of minus one.

K is some real number and M is some non-negative number.

And the idea of Euler's formula is to describe a vector in a complex plane or in a polar plane.

Where M corresponds to the length or the distance away from the origin and corresponds to the angle

with respect to the positive real axis.

All right, let's see these three quantities in Matlab.

OK, so here we have the code and you can already see that it's incomplete.

There's a bunch of missing pieces of code here and here.

As I mentioned in the previous section of introduction to this course, what I encourage you to do is

download this code and try to complete as much of it yourself as you can, and then you can come back

here and watch me solve it.

All right.

So here we have some intuition about sine waves.

So here we define the parameters.

We have the frequency of the sine wave, the sampling rate of time, and then we generate a time vector.

It's going to go from minus one to plus one.

The amplitude of the sine wave is to the phase will be PI over three.

So now we create the sine wave here.

You just have to remember that formula.

So it was a which is ample sine.

And then in here it was two times pi times the frequency times time and then plus the phase onset.

So first, let's run this and then I'll run this just to make sure we don't already get any errors,

which we don't.

So that's a good sign.

Now we want to plot it.

So what do we want to plot?

I think the x axis is going to be time and the Y axis is going to be this sine wave.

All right.

So the rest of this code looks good.

So I'm going to run this entire cell by pressing control.

Enter and let's see.

OK, so initially this might look wrong, you might be expecting it to look like a sine wave and it

doesn't look like a sine wave.

Instead, it just looks like these alternating off diagonal lines.

But actually, the problem here is with the x axis, I'm sorry, actually with the Y axis limits.

So it specified here to go from minus one to plus point one.

However, the amplitude here is two.

So I think a solution here.

So first of all, one solution is you could just, you know, delete this like this and let Matlab auto

specify.

Another option would be to manually specify that we do want it to go from a little bit below the bottom

of the sine wave to a little bit above the bottom of the sine wave.

And then we just have to scale this up.

So I'm going to multiply this expression, these two numbers by example.

Let's see what that does.

OK, that looks a lot nicer.

So let's see what we have to do in the next cell.

This says, The sum of sound waves can appear like a complicated time series.

So this is already a little bit of a gentle introduction into simulating EEG data.

And one thing that we're going to do in simulating EEG data is create a multi sinusoidal or multispectral

time series.

So the way that we're going to do that here is by generating a vector of frequencies.

So there's five frequencies, a vector of amplitudes and a vector of phases.

And then we have a for loop here.

And essentially what we're doing is saying the sine wave is equal.

So this element of the sine wave is going to create a matrix that's going to be the number of components,

the number of sound waves by time matrix.

And each one is well, this is the familiar looking sine wave formula.

So this is going to be and hurts, so.

We'll have five sine waves and you can see that they're going to have these different frequencies,

amplitudes and phases.

OK, so I don't see any red underlines here.

OK, so here there's definitely an error here.

So I'm going to do is run some of this code, so that goes fine and run this loop and.

OK, so here we get an error.

So now we have to figure out where the error is.

So we get a little bit of a hint here from Matlab.

It's something with the multiplication.

However, there's multiple multiplications on this line.

So what I'm going to do is run these a few at a time and let's see what happens.

So first of all, I'm going to run everything in this sine function and that actually doesn't produce

an error.

So that's pretty helpful.

That leaves us with only one multiplication.

So clearly, the error is here.

Maybe there's something wrong with amplitude.

Actually, the problem here is that we are looping over the elements of the frequencies, all these

different sine waves.

And you can see here we access one element of frequency, one element of phase, so but here we're trying

to access all five elements of amplitude simultaneously.

So the solution is, say, only the fifth element.

And that looks good.

OK, let's see if this works here.

All right, that looks good.

So this matrix sine wave is five by 2000, so five sound waves and 12 time points and we're sending

over the first dimension and that gives us one time series.

And that looks like this.

And you can already see you can already get the idea that adding sine waves together gives a resulting

time series that looks a little bit more complicated than any individual sine component.

That's not an earth shattering the amazing insight, but it is a key idea underlying simulating EEG

data that we take a bunch of simple time series and we mix them together and we get something that's

a little bit more complicated and then we try to separate out the different independent sources, in

this case, a different independent sine wave using some kind of filtering or spectral analysis.

OK, now we're supposed to plot each sine wave separately.

So obviously there's something missing here.

And I think it has to look something like this.

So let's try time.

And then this is supposed to be for each sine wave separately.

So it's not going to be exactly this.

So instead, maybe what we want to do is say sine waves and the five sine wave.

Let's try that.

Huh?

OK, so we do get five different plots corresponding to five frequencies, that part's good, but the

plots look like they're empty, or maybe these are plots of white rabbits in a snowstorm.

So it turns out that the problem here is just a simple mistake.

This is a really easily made mistake.

And what I'm doing here is accessing not one sign away from this matrix, but one individual element

from this matrix.

So this actually just turns out to be a single number.

So what we want to do is the fifth row and all of the columns, that's the solution.

And now I think it's going to look better.

Yeah.

Now you can see all these individual sine waves.

And basically, if you sum up all of these at each time point, that's how you get to this time series.

All right.

That was for sine wave.

Now we get to the Gaussian.

So let's see what we're doing here.

So we specify a time range and the sampling rate here is hardcoded to be 1000 hertz, the time or peak

time is one.

So the peak is going to be at one second instead of being at the default value of zero.

And the amplitude is going to be 45 for whatever reason, with a full with that half maximum of point

nine.

So here we define the Gaussian.

I can already see there's something wrong going on here and here.

I'm comparing the empirical full with that half maximum and then doing some plotting.

Now, I'll talk more about this in a minute.

First, I want to make sure we can figure out what's going wrong here and fix this line so it looks

immediately like we are missing some parentheses.

So you can see this parentheses corresponds to this one and this is open.

So let me tell you the wrong way to do this.

The wrong way to do this is just to say, oh, OK, so we just need to put in some more parentheses.

Just adding more parentheses thoughtlessly like that is almost never going to work in this case.

I have no idea what this function is, but it's clearly not what we're looking for.

It goes up to 10 to the 13, which is slightly higher than 45.

OK, so let's look through this carefully.

So first of all, if you remember the formula or maybe you want to pause the video and go back to the

formula that I had in the slides, it was four times the natural log of two.

So already that needs to be fixed like this that we can get rid of this.

And now let's also look at this.

So this is four times log, two times time, and then it should be time squared.

So that part's kind of right.

But here it's time minus the peak time and then that is squared.

So in fact, what this is doing because of the order of operations for arithmetic, power takes precedence

over subtraction.

So what Matlab is actually doing here is squaring P time, which is still just one, and then subtracting

that from this product.

So that is the wrong thing.

This has to be all of this business squared.

So I'm going to put more parentheses around here.

And then that looks fine, and I think we need one parenthesis here, in fact, I think we don't even

need this parenthesis here, but that's OK.

I see.

Now, this is this is actually correct.

So now this is the end of the exponential.

So now let's try plotting this again.

OK, so this is getting better.

It looks more like a Gaussian here and it does have a peak time at one.

So that's good.

However.

So there's something going wrong with the full with half maximum.

We'll deal with that in a minute.

But the bigger problem here, the more urgent problem is that this peeks at one.

But here I specify that the amplitude should be 45.

So this one is a pretty simple fix.

You can see the amplitude appears nowhere in this line of code.

So we have to say Hample times now we run this again.

OK, so this didn't really change, but the y axis changed.

So this is looking better.

We still have a problem with the flow with that half maximum.

And let's see if we can figure out what the problem is.

So this one is a bit tricky.

It turns out the problem is not with this line.

The problem is with how we define the empirical fool with that half maximum.

So what I do here, let's go through this line by line.

I create a new variable called G when N for normalized, and that's just defined by max value normalizing

the Gaussian.

The reason why I want to normalize max value, normalize the Gaussian is so that finding the point that's

closest to the 50 percent of the amplitude, 50 percent of the peak is actually just the value.

That's closest to zero point five.

So that's here I say post five and pre five.

So that's basically the 50 percent mark after the peak and the 50 percent mark before the peak.

And so that you can see here.

So I'm searching for in the Gaussian normalized function from the beginning of time up to the midpoint.

And I search for the point that is closest to point five.

So that part is fine.

The problem is that what it's looking for as the midpoint is the time point that's closest to zero.

Now, zero is not the peak of the Gaussian.

The peak of the Gaussian is this variable time.

Maybe I should have given this a different name, like peak time or something.

OK, so now it's going to be searching for and I can show you this as well.

So time of midship P is zero.

But now if I run this and I go back to this time now, time of P is one and that is the peak of the

Gaussian.

So now let's try running this code again, OK?

And now this looks better so we can see the requested full full with that half maximum is nine hundred

milliseconds and that's what gets specified in the formula and what is actually measured in the data.

And the result is also point nine seconds.

So that's great.

Now the final thing we have here is some code for Euler's formula.

This one's not so bad.

So here is M and K, and here we're supposed to specify M e to the OK, so that's going to be M times

E to the one I times K, so that part's pretty simple.

And let's see, this plot code looks correct.

All right.

So here we get the polar plain and here's the magnitude.

And so the magnitude is specified as two point four.

And you can see it's believably two point four here and the radial axis.

And this does look plausibly like it would be three PI over four.

Now, you might be wondering why we even specified an easy IC, because in this poller plot, we don't

use that variable.

We just use directly the parameters that we specified.

So what I want to show you is that so this is a complex number.

You can see it has a real part and it has an imaginary part here.

I'm using the magnitude and the phase to plot a line in a polar plain.

And here what I'm going to do is plot the complex number directly and let me see you put in some of

this.

So now you can see this is a complex plane.

This is a polar plane.

But this point is actually the same as this point.

And that's just by plotting this Matlab is actually doing is extracting the real part and the imaginary

part.

And that's what's supposed to happen with this line.

But it's missing something here.

So what it's missing is to extract the real part from meets the arc and the imaginary part from M.

E to the IRC.

All right.

Now I'm going to run this whole cell from scratch and we get this result.

All right.

So that's the end of this video.

What I encourage you to do is spend some more time with this code.

In particular, try changing all these various parameters and see what the effects are on.

The resulting graphs, of course, not only for this, but also here, you can try changing the frequencies

here, you can change all the Gaussian parameters and so forth.