 n this video, we are going to simulate earpiece from two brain dipoles and then project those out onto the scalp mechanistically. This is not so much different from what you learned in the previous section of the course on simulating EEG data. However, the main differences are that we're going to simulate data that will look a little bit more realistic, slightly more plausible for earpiece. And secondly, we are also going to do a little bit of exploration about spatial source separation. So we're going to see how these different sources get mixed at the level of channels. And we'll see if we can separate these two sources, these two piece by picking different electrodes. OK, so let's get started. This code is copied and pasted from the previous section, so I won't talk about it too much. Basically, I'm just picking through dipoles. These titles are relatively close to each other and then making some plot so you can see where those dipoles are located and what they're topographies look like. So here are those two dipoles. You can see they're relatively close to each other, but they are oriented in such a way that they have overlapping spatial projections onto the EEG electrodes. So, for example, if you consider Electrode Twenty, which is located here and here, you can see that Electrode 20 is going to receive information from both dipoles. All right. So that's something we are going to explore when simulating the data here. I'm just adjusting some of the parameters. I've mentioned in the last section that the data structure that comes with this matte file, this matte file, empty EEG has I think it's 10 seconds of data over one trial. So I just want to change the parameters a little bit and then I initialize the channel data matrix. All right. So here is the main part of the code. I'm generating activity in two dipoles. So here is the data for taip one, the data for type two. And let's have a quick look and see what those dipoles are going to look like, what those activations will look like, and then I'll walk you through all the code from the beginning. So this is a Gaussian, so we're creating a Gaussian now. You might immediately wonder what is the purpose of creating the Gaussian inside this loop? And the purpose here is that the full with that half maximum is some random number. So that's going to change on each trial and then that's multiplied by this other vector. I have signal, so instantaneous frequency signal and that you might recognize as this formula for a frequency fluctuating signal. So I will talk about this more in a minute than here for Dipo two. We also generate another Gaussian again with a random four with a half maximum on each trial. But then this dipole activation for this dipole dipole to this is just the Gaussian. So these are going to be the two time courses that we generate. All right. So now let me take you back to the top here. I have the vector fragment. This is going to be a time vector of the instantaneous frequencies and it's going to range from two to seven. So this line generates uniformly distributed random numbers between zero and one. It's going to be ten of them. And we interpolate across them, multiply by five. That gives us frequencies between zero and five, and then we add two to give us frequencies between two and seven. And then here we generate the instantaneous frequency signal. So let's see what that happens to look like in this particular case. So plot, I say each time I by a signal. So here's what that looks like. And then later on it's going to get multiplied by Gaussian. So let's have a look at this. I'm going to create this Gaussian here and now I'm going to plot I have signal times and it's Darkstar because we want Element Y's multiplication times Gauss and that's going to look like this. And it's pretty interesting to consider that this actually looks a little bit like an ERP as it looks a little bit like a real event related potential, you could make it a bit more realistic by having the frequency slow down even more over time. But it's interesting to note that a Gaussian envelope times a frequency modulated sine wave share some interesting characteristics and morphological features with a biological ERP. OK, so here inside this loop over trials, I'm generating this matrix dip act for dipole activation. You can see it's generated as random numbers corresponding to the number of dipoles and then the number of time points per trials scaling this way down for the beginning. So we get very low levels of background noise. And then here again, this dipole, one dipole, too, and you can see that these dipole activities are actually totally noiseless. So this was a noisy signal and I'm completely replacing it by this pure noise, less signal. So if you want to also includes noise in the dipole in these two dipole activities, you could do something like this. Say this thing equals itself, which is already just noise, plus this signal. OK, so I'm not going to do that now, but just to show you how that would work, then we project all the data to the scalp. And now here I'm plotting EEG data from a few select channels using this function Plotts, an EEG which I introduce you to in the previous section of the course in particular, I'm going to be plotting channels 31, 18 and 10. And let's have a look at where those are. So thirty one is here. Eighteen covers this projection and 10 is this projection as well. But you can see it's a little bit negatives, this kind of on the other side of the dipole. And all of these three are going into separate figures. So we will be able to compare them directly. All right. So I'm going to run this whole cell by pressing control center. All right. So let's take a look. Let's start with figure two. Now, remember, one of these dipoles is a Gaussian modulated frequency sliding time series that looks like this. The other dipole is just a pure Gaussian, and that's what we see here. Now, if you look here, this doesn't actually look like a pure Gaussian. It has a little bit of a shoulder here. So that indicates that there's some mixing between these two dipoles. So this is that Channel 18, once you are 18 is right to 18 is all the way over here. This was dipole to where there's only a Gaussian. So even here where there's only there should only be a Gaussian present, you still see a little bit of a contribution from this first dipole so that you see here. But mostly this looks pretty good, is pretty decent separation now here at Channel Ten. This is kind of interesting. This looks a bit oops. I wanted to compare this one to almost a little bit the opposite of Channel 31. So, for example, here at around nine hundred milliseconds, there's a positive going peak here. At nine hundred milliseconds there's a negative peak. And that is because we are on the opposite side of the dipole over here at Channel Ten compared to over here. Now, I'd like to show you what's going to happen at Channel twenty, where we get a mixing of these two dipole projections. So I'll just rerun this. Actually, I should put this in a separate figure. Now here. This is in between the two dipole projections are where the two dipole projections overlap and you don't really see much of a Gaussian. You really just see this sinusoidal modulation. So that's pretty interesting to think about that. If you are at an electrode, if you're looking at data from a channel where there is overlapping projections, then basically which projection wins is dependent on which signal projects more strongly to that electrode. And that's dependent on the location. It's dependent on the amplitude of the source waveform, and it's also dependent on the orientation of the dipole. Finally, I would also like to point out that when you look at these single trials of the grey lines, you can see it's quite noisy. There's quite a bit of noise. Even though I said this dip act or this random noise variable to be zero point zero two, which is much, much smaller. So these values go up to one these time series called to one or minus one. And this one goes from zero to one. And the noises that point out, too, but there is so many dipoles, there's 20 to dipoles with noise and only two dipoles with pure signal. So the noise still ends up dominating the single trial data, even though it's amplitude is much, much smaller. Two orders of magnitude smaller than the signal. Good. So I encourage you to experiment more around with this code in particular. You can try changing the amplitude of these signals so you can change the amplitude of this Gaussian or the amplitude of this Gaussian. You can make one larger or you can make them smaller. And see how that affects both the projections onto the scalp as well as the mixing properties at Channel 20.