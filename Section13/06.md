 In this video, I'm going to use a spectral method to try to do source separation with generalized decomposition. This will be interesting to compare with the previous video where I use time windows to compute covariance matrices. So here I'm going to use frequency bands to compute covariance matrices instead of time windows. All right. So let's run this code again in order to recreate the simulated data. Now, here you can see how I'm going to create the S and R covariance matrices. I'm going to Narrabeen filter the data in a new field in this EEG structure. And it's called, uh, so it's called F data for filter data. And basically, I'm filtering the data broadly in the alphabet. So the center of the filter is 11 hertz and as a full with an F maximum of seven hertz. So it's a relatively broad filter. In fact, let's even look at this. So I'm going to put an extra optional input at the end here. And that's going to open up a figure that shows us what the spectrum of the filter looks like. So here's what the filter looks like. It picks at 11. The full with that half maximum is actually not exactly seven. We requested seven. But based on the properties of the data, it ended up being six and two thirds hertz. But you can see that the filter is going to pass through, you know, basically from five hertz up to 17 hertz. So broad alpha band filter. And this is consistent with what I know apriori about this data set that the interesting energy from the two components is both somewhere around the broad alphabet. All right. So let's see. I'll turn this off. And now I actually am collecting the data from a time window, but it's the same time window for the S and R covariance matrices. And furthermore, it's a fairly broad window. I basically just want to make sure that there's not going to be any filter edge effects that are leaking into the covariance matrices. Otherwise, computing these government agencies is really similar to what I showed in the previous video. On Time-Based can see competition, so it's still now it's we don't change the tide X variable because there's only two elements and it's the same time window for both the R and the S covariance matrices. It's also, again, should be s. So the only thing that differs here is that the R matrix comes from the broadband signal. So the non filtered version of the data, whereas the S covariance matrix is generated from the filtered data. So basically this one letter is the only thing that really differentiates grading the archiving matrix from the S covariance matrix. And again, I'm summing up all these single trial covariance matrices and then I divide by the number of trials. It turns out that this step is actually not necessary. You can try rerunning this code with and without this division here. I'm just kind of including it for completeness, to call it an average rather than a sum. All right. And then this is plot in code that you've seen before. So let's take a look at these data. So here is the Excavates matrix and the archivist's matrix. And of course, the first thing you notice is that the Excavates matrix is washed-out relative to the R covariance matrix. And this should really not be very surprising. Because they are covariance matrix is the entire spectrum from all the channels, and the covariance matrix is just one little sliver, it's one little narrow band section of the entire spectrum. So it actually does make sense that this is much lighter. It's more washed out compared to the R covariance matrix. Now, we can also divide this by maybe by four. Let's see. Just to give it a little bit so we can see it a little bit more to help us see the differences, maybe I'll divide by seven. So that looks all right. So, again, you see that a lot of the qualitative patterns are similar. But there are also some qualitative differences. So, for example, it looks like there's some strong covariance here in this corner and which you will see reflected here and you don't really see much special happening up here. So there's some there does seem to be something qualitatively different here. You see some blue stuff in here. You only see some orange stuff. OK, so now let me go back to this big goal. I is going to be to use generalized organic competition to try and find some separating vectors that go between or that separate discovery matrix from this covariance matrix. In fact, all of the code in this cell is exactly the same as the code in the previous note. Also that I'm creating the component time series data by multiplying the eigenvectors, not back to the filtered data, but to have raw broadband, non temporally filtered time series data. That's actually important because I want to compute the time frequency plot of the data which happens in this function plots in me. So in order to create the time frequency plot, you want to multiply the eigenvectors, the spatial filters by the broadband data. OK, so let's run. Actually, first I run this, we can have a look at the screen. Plot, as it's often called, is basically just the plot of the sorted eigenvalues. And so again, you see that there's a noise spectrum here and then there's some number of components that are popping out of the noise. And that's generally what you want to look for when you're looking at these three plots. So here it's also quite obvious. It's in simulated data. You can get these really brilliantly obvious results. You don't need to do any statistics. You don't need to worry about anything or permutation testing. You just look at the data and it's really clear that you get two components popping out of the noise spectrum and real data, which you will see in the project at the end of this section of the course. It's not always necessarily so clean anyway. Now, it's also interesting to compare these values here. You might remember from the previous video on Time-Based Journalize organic composition that these values were all larger than one. And in fact, these values that I was calling the noise spectrum, I said the null hypothesis value is around one. Now, the thing is that there's a lot more energy in the R covariance matrix than in the S covariance matrix. And if you watched some of the videos on for the background section of this course, this section of the course, or if you've taken my course on linear algebra or dimension reduction and saw separation, you'll remember that the key formula for generalized organic composition is basically as divided by our multiplied by some weight vectors and things like that. But it's basically a ratio of estar. So if R has a lot more energy than S, then you do expect that the denominator will be larger than the numerator, which means that you're going to get a result. That's less than one and that's what you see here. So in fact, this top component has a power ratio of zero point eight. Now that's absolutely nothing to worry about. What you're interested in these plots is not the absolute value itself, but instead the relative values across all the different components. All right. So that said, now I'm going to run the rest of this code and we can see what these components look like. And it's interesting to compare them qualitatively against the results from the previous video on time based source separation. So now in this case, the component one and component two are actually kind of swapped, quote unquote, in the sense that the ground truth, what I call, you know, this dipole dipole one actually maps better onto component two and dipole two maps better onto component one. But that mapping is really arbitrary. So you don't need to expect that there should be a match one to one like this. It can be any one of these components to any one of these simulated dipoles. Nonetheless, the important thing is you can see when you look at the frequency spectrum here, you can see that they differ. When you look at the topographies, you can see that they differ. And when you look at the time frequency plots, you also see that, again, they differ. So one is a little bit higher and a little bit later a higher frequency and a little bit later in time. And this one is a little bit earlier in time and a little bit lower in frequency. And that matches exactly how we created the ground truth data. So the conclusion from the previous video on time based or separation and this video on frequency base or separation is that it's often possible to get very accurate, meaningful source separation using multiple different approaches, so frequence different frequencies at the same time, in the same time window or ignoring frequencies altogether. So just looking at the broadband signal but picking different time windows. Now, of course, that doesn't mean that in real data you can always use any kind of approach. You want to generate the S and our covariance matrices. But it does often happen that there are multiple correct ways to set up the covariance matrices for the source separation.