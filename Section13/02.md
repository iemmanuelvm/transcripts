 In this video, we are going to simulate multi component EEG data by generating data in dipoles and then projecting those dipole activities out to 64 electrodes. This is very similar to what we did in the first section of this course on simulating EEG data. I went to have a quick video, partly as a reminder and partly basically to set us up for the next several videos, because there will be quite a few other videos in this section of the course in which we will actually call this file as if it were a function. So this is not a function. It's a script. There's no functions in here. There's no function name. But I'm going to use this script at like a function to simulate data for several other videos in this section of the course, all about doing multivariate components analyses. All right. So we start off loading this MDG data set, which also includes a lead field matrix. That's the mapping, the linear mapping between each dipole in different directions and the channels. And then I'm going to pick two of these dipoles sort of at random. I kind of poked around a bit. And so I found two dipoles that have a location and also a projection topography that I like. So and then we're doing some plotting here. So here you see all of the brain dipoles in yellow and then in red and black, you see the two dipoles that we are going to be simulating activity in. And when you project electrical fields from each of these dipoles onto the scalp and then measure that potential at 64 electrodes, that looks like this and this for these two different dipole locations. So I believe actually the red one corresponds to this one. So the reason why I picked these two dipoles is that the topographies overlap a little bit, but not entirely. And we are going to use this principle to see or this phenomenon to see if we can separate signals from these two sources. We'll see if we can do that with PCA. We'll see if we can do that with generalised organic composition. All right. So then I'm going to adjust some parameters. And that's because the the default parameters in this empty data set is it's basically set up for one trial of 10 seconds long. Instead, I'd like to have multi trial data and less than 10 seconds a little bit shorter. So therefore, I'm generating one hundred trials and just changing the parameters here. So they have one hundred trials. And here I'm setting up the time vector slightly differently from how I normally do it. Normally, I would specify initially specify the number of time points and then have the Times vector go, for example, from zero two and minus one divided by the sampling rate. So now I'm setting it up a little bit differently. I'm setting the times vector to go from minus the sampling rate to plus two times the sampling rate. And then when dividing by the sampling rate, that gives us a time series vector that goes from our time points vector that goes from minus one to plus two. Now, you could also compute analytically how many time points that would be. So it's going to be three sampling intervals possibly, plus another one, depending on whether this vector with the sampling rate would overlap with zero. I guess it always does. So, yeah. So this will be three sampling rates times plus one. But I'm doing it empirically here by just counting the number of time points in the time vector anyway. Then here I initialize the data to be zeros. Let me run this. So now we get down to this and this is where it actually creates all of the time series data. So it's interesting to try and, you know, get a bird's eye view of the code before inspecting it line by line to see if we can figure out generally how the data will look like, how the data are going to be created. So we're clearly creating this one trial at a time. So that suggests that there's going to be some trial unique variance. There's going to be some trial, unique activity. And then here we see some code for generating activity in Dipoles one and Dipole two. And you can see that this is some F signal. So instantaneous frequency signal times a Gaussian for both of these signals. And here's the Gaussian. You see the typical Gaussian formula. This one peaks at 800 milliseconds. This one peaks at nine hundred milliseconds. Here, the full with half maximum is hardcoded to be point eight. And here there is no division here, which means implicitly we are dividing by one. So the full with the maximum is one second. So that means that Gousse won and then Dipo won. So this is going to be some fluctuating sine wave, some non stationary sine wave that's going to be a little bit earlier and also a little bit broader compared to the signal and dipole, too, which is a little bit later, a little bit narrower. And also, if you look up here, you can see it's a little bit higher frequency. So this is the frequency modulation. You can see interpolating over random numbers between zero and one. Multiply that by five. So then I get random numbers between zero and five and then I add five. So that's going to give me random numbers between five and 10. And this bit is the same, except now I'm adding seven. So now this is going to vary from seven to 12 and this will vary from five to 10. All right. So now that you have a bit of a picture of what the code does, let's go through one single trial and see what some of these signals look like. So it's one, these two. And now you open up a new figure so I can type plot IEG Times. Let's first look at this Frech mahad variable. So this is the vector of instantaneous frequencies that the signal will contain over time. So in this particular trial, it varies between a little over five and a little over eight. So now let's see what the F signal looks like. So this is less easy to interpret visually as a sine wave and it is changing frequencies you can kind of see is a bit slower. This is a bit faster here and now you can see the actual dipole time series here is going to be this instantaneous frequency signal times the Gaussian. So Gauss won. So this is what the true signal looks like on trial one in Dipo one. And then here it's going to look really similar. In fact, I think I'll do hold on. And then so I have signal that variable is the same and then it's Gauss two instead of just one. So here you see the two signals and the two dipoles, so it's quite interesting to see that they overlap in time. They're also going to overlap in frequency and we can see that. Here, so let me do let me run this line and then I'll say plot and then. So this is for this particular trial. This is going to be the frequency time series, the instantaneous frequency of Dipo one. And then hold on. And now I run this one and plot this. So you see that the frequency structure overlaps quite a bit. Certainly over here, it's going to overlap quite a bit. And also, remember, this is just one trial and a different trial. These are going to be differently, different, randomly generated time series of frequencies. So in general, dipole to be a little bit faster than Dipo one. But on any given trial and certainly over time, that's really not necessarily going to be the case. OK, so the point is that these two signals, these two dipoles, they overlap in space, they overlap in time, and they also overlap in frequency. So then it's going to be quite interesting to see whether it's possible to separate these different sources, these two different dipole activities, using some multivariate components analyses. OK, so run this wholesale and now this kind of interesting I say, you know, plot these three channels, but then I say if zero so zero is interpreted here as false. So if false equals true, which it never does, then run this code. So in fact, this code is never going to get run. These three lines of code will never get run in. Matlab even gives us a warning that says this statement cannot be reached. Now, the reason why I have this set up here is because I want to be able to generate these plots pretty easily manually like this. However, in later videos, when I'm going to be calling this script with the goal of generating some simulated data, then I don't want to go through the time and the figures to generate these plots every single time. So therefore I have it set up like this. All right. So here you see a big healthy peak at around 10 hertz and it's not a super narrow peak at 10 hertz because the frequency is changing over time. That's what you saw in those previous plots. So this is from one channel. This is from a different channel. And this is from yet another channel. And in fact, here you can see that there is some differentiation. So there's a little peek over here and a separate peek over here. And if you look here in this time frequency plot, you see there's a little bit of this kind of rippling effect. I wonder how well you see this. So not so much here and a little bit you can see the rippling here, but you can see this kind of wiggling up and down. And that's because we have two different sources that are being mixed together. They have different frequency structure, but only slightly different, largely overlapping. So we get some mixing here. Now, we will see in the next several videos whether it's possible to separate these two sources using different methods.